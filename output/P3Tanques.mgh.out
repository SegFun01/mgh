MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[132.0, 90.0, 128.0, 100.0]

Matriz [Ho]
[132.  90. 128.]

Matriz [qi]
[100.]

Matriz [B]
[[1.]
 [1.]
 [1.]]

Matriz [C]
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
-------------------------------------------------------------------------------------------

Matriz [A]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

Matriz [A1]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   1.96  486572 0.01325  10.38  0.98   1226.86
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -1.55  384436 0.01381   6.75  0.61   1274.31
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   1.63  403619 0.01369   7.38  0.67   1264.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [A1]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [qfi]
[-96.21  76.01 -79.81]

Matriz [Hi]
[120.73]

Matriz [Qi]
[ 96.21 -76.01  79.81]

Matriz [dq]
[-0.   -0.18 -0.02]


-----Fin iteración:   1  Desbalance de caudales: 3.793013


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491  -2.17  538086 0.01302  12.47  1.20   1207.56
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   7.48 1856401 0.01071 122.05 14.25   1011.65
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -3.27  812560 0.01216  26.55  2.73   1134.22
-------------------------------------------------------------------------------------------
Matriz [A]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [A1]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [qfi]
[ 106.39 -367.06  160.66]

Matriz [Hi]
[168.47]

Matriz [Qi]
[-106.39  367.06 -160.66]

Matriz [dq]
[-0.2   0.44 -0.24]


-----Fin iteración:   2  Desbalance de caudales: 202.599399


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   0.35   86641 0.01844   0.46  0.03   1666.31
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.09  519116 0.01310  11.68  1.11   1214.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -0.40  100002 0.01790   0.59  0.04   1620.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [A1]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [qfi]
[ -17.13 -102.64   19.77]

Matriz [Hi]
[150.07]

Matriz [Qi]
[ 17.13 102.64 -19.77]

Matriz [dq]
[ 0.12 -0.26  0.14]


-----Fin iteración:   3  Desbalance de caudales: 123.523463


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   9.58 2378445 0.01034 193.47 23.39    980.58
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -0.23   57748 0.02013   0.22  0.01   1808.95
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -7.31 1814942 0.01074 117.04 13.62   1014.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [A1]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [qfi]
[-470.28   11.42  358.86]

Matriz [Hi]
[105.64]

Matriz [Qi]
[ 470.28  -11.42 -358.86]

Matriz [dq]
[ 0.45 -0.11 -0.34]


-----Fin iteración:   4  Desbalance de caudales: 453.144660


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   5.67 1406859 0.01115  73.02  8.18   1049.41
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.02  254229 0.01489   3.18  0.27   1366.00
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.65 1155333 0.01149  50.75  5.52   1078.25
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [A1]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [qfi]
[-278.17  -50.27  228.44]

Matriz [Hi]
[92.31]

Matriz [Qi]
[ 278.17   50.27 -228.44]

Matriz [dq]
[-0.19  0.06  0.13]


-----Fin iteración:   5  Desbalance de caudales: 192.105878


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.58 1135921 0.01152  49.19  5.34   1080.82
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.69  418996 0.01360   7.90  0.73   1256.59
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.23 1049162 0.01167  42.48  4.55   1093.00
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [A1]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [qfi]
[-224.6   -82.85  207.44]

Matriz [Hi]
[82.07]

Matriz [Qi]
[ 224.6    82.85 -207.44]

Matriz [dq]
[-0.05  0.03  0.02]


-----Fin iteración:   6  Desbalance de caudales: 53.570998


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.48 1111252 0.01156  47.23  5.11   1084.16
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.84  456132 0.01340   9.22  0.86   1239.54
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1061628 0.01165  43.42  4.66   1091.17
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [A1]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [qfi]
[-219.72  -90.19  209.91]

Matriz [Hi]
[79.85]

Matriz [Qi]
[ 219.72   90.19 -209.91]

Matriz [dq]
[-0.    0.01 -0.  ]


-----Fin iteración:   7  Desbalance de caudales: 4.877723


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109840 0.01157  47.12  5.09   1084.35
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  458956 0.01339   9.33  0.87   1238.32
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063041 0.01164  43.53  4.67   1090.97
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [A1]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [qfi]
[-219.44  -90.75  210.19]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.44   90.75 -210.19]

Matriz [dq]
[-0.  0. -0.]


-----Fin iteración:   8  Desbalance de caudales: 0.279121


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109731 0.01157  47.12  5.09   1084.36
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459156 0.01338   9.33  0.87   1238.24
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063131 0.01164  43.53  4.67   1090.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-2.16e-05  3.94e-05 -1.78e-05]


-----Fin iteración:   9  Desbalance de caudales: 0.021561


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109722 0.01157  47.11  5.09   1084.37
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459170 0.01338   9.33  0.87   1238.23
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063136 0.01164  43.53  4.67   1090.95
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-1.69e-06  2.77e-06 -1.08e-06]


-----Fin iteración:  10  Desbalance de caudales: 0.001691

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/P3Tanques.mgh
Titulo:      Problema de los 3 tanques
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     132.00    32.00 
  1   130.00      90.00   -40.00 
  2   120.00     128.00     8.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  3    70.00     100.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  3    1000   250  0.0491  0.0015   5.0    TA   - 
  1    1  3    1000   250  0.0491  0.0015   5.0    TA   - 
  2    2  3    1000   250  0.0491  0.0015   5.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     132.00    32.00  -219.42
  1   130.00      90.00   -40.00   -90.79
  2   120.00     128.00     8.00   210.21
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  3    70.00     100.00    1.00   100.00      79.79     9.79
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  3     4.47  219.42   47.11    5.09   52.21   0.05221 
  1    1  3     1.85   90.79    9.33    0.87   10.21   0.01021 
  2    2  3    -4.28  -210.21   43.53    4.67   48.21   0.04821 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Wed Sep  7 12:29:38 2022
crcs-2022
