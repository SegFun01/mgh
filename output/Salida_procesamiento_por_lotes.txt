MGH
Procesamiento de varias redes por lotes
---------------------------------------
 
Procesando archivo N° 1 : ./input/CaudalMax-kL.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 100.0, 0.0]

Matriz [Ho]
[110. 100.]

Matriz [qi]
[0.]

Matriz [B]
[[ 1.]
 [-1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   0.51  252878 0.01582   0.08  0.07     14.97
  1   2  1   200  500 0.0500  5.0  TA  0.1963   0.51  252878 0.01582   0.08  0.07     14.97
-------------------------------------------------------------------------------------------

Matriz [A]
[[1.5 0. ]
 [0.  1.5]]

Matriz [A1]
[[1.5 0. ]
 [0.  1.5]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   8.76 4348199 0.01246  19.48 19.54     13.20
  1   2  1   200  500 0.0500  5.0  TA  0.1963   8.76 4348199 0.01246  19.48 19.54     13.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[22.69  0.  ]
 [ 0.   22.69]]

Matriz [A1]
[[22.69  0.  ]
 [ 0.   22.69]]

Matriz [qfi]
[-1719.49  1719.49]

Matriz [Hi]
[105.]

Matriz [Qi]
[1719.49 1719.49]

Matriz [dq]
[1.62 1.62]


-----Fin iteración:   1  Desbalance de caudales: 1619.486607


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   4.94 2452693 0.01274   6.34  6.22     13.35
  1   2  1   200  500 0.0500  5.0  TA  0.1963   4.94 2452693 0.01274   6.34  6.22     13.35
-------------------------------------------------------------------------------------------
Matriz [A]
[[12.95  0.  ]
 [ 0.   12.95]]

Matriz [A1]
[[12.95  0.  ]
 [ 0.   12.95]]

Matriz [qfi]
[-969.91  969.91]

Matriz [Hi]
[105.]

Matriz [Qi]
[969.91 969.91]

Matriz [dq]
[-0.75 -0.75]


-----Fin iteración:   2  Desbalance de caudales: 749.573990


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.45 1714629 0.01299   3.16  3.04     13.48
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.45 1714629 0.01299   3.16  3.04     13.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[9.14 0.  ]
 [0.   9.14]]

Matriz [A1]
[[9.14 0.  ]
 [0.   9.14]]

Matriz [qfi]
[-678.05  678.05]

Matriz [Hi]
[105.]

Matriz [Qi]
[678.05 678.05]

Matriz [dq]
[-0.29 -0.29]


-----Fin iteración:   3  Desbalance de caudales: 291.866013


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.12 1548899 0.01308   2.59  2.48     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.12 1548899 0.01308   2.59  2.48     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.28 0.  ]
 [0.   8.28]]

Matriz [A1]
[[8.28 0.  ]
 [0.   8.28]]

Matriz [qfi]
[-612.51  612.51]

Matriz [Hi]
[105.]

Matriz [Qi]
[612.51 612.51]

Matriz [dq]
[-0.07 -0.07]


-----Fin iteración:   4  Desbalance de caudales: 65.537641


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537535 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537535 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.23 0.  ]
 [0.   8.23]]

Matriz [A1]
[[8.23 0.  ]
 [0.   8.23]]

Matriz [qfi]
[-608.02  608.02]

Matriz [Hi]
[105.]

Matriz [Qi]
[608.02 608.02]

Matriz [dq]
[-0. -0.]


-----Fin iteración:   5  Desbalance de caudales: 4.493701


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537305 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537305 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [A1]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [qfi]
[-607.92  607.92]

Matriz [Hi]
[105.]

Matriz [Qi]
[607.92 607.92]

Matriz [dq]
[-9.11e-05 -9.11e-05]


-----Fin iteración:   6  Desbalance de caudales: 0.091089


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537301 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537301 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [A1]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [qfi]
[-607.92  607.92]

Matriz [Hi]
[105.]

Matriz [Qi]
[607.92 607.92]

Matriz [dq]
[-1.53e-06 -1.53e-06]


-----Fin iteración:   7  Desbalance de caudales: 0.001526

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/CaudalMax-kL.mgh.json
Titulo:      Calculo de caudal maximo
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1   100.00     100.00     0.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2   100.00       0.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     200   500  0.1963  0.0500   5.0    TA   - 
  1    2  1     200   500  0.1963  0.0500   5.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -607.92
  1   100.00     100.00     0.00   607.92
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2   100.00       0.00    1.00     0.00     105.00     5.00
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     3.10  607.92    2.56    2.44    5.00   0.02500 
  1    2  1     3.10  607.92    2.56    2.44    5.00   0.02500 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:26 2022
crcs-2022
...
 
Procesando archivo N° 2 : ./input/CaudalMax.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 100.0, 0.0]

Matriz [Ho]
[110. 100.]

Matriz [qi]
[0.]

Matriz [B]
[[ 1.]
 [-1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   0.51  252878 0.01582   0.08  0.00      8.36
  1   2  1   200  500 0.0500  0.0  TA  0.1963   0.51  252878 0.01582   0.08  0.00      8.36
-------------------------------------------------------------------------------------------

Matriz [A]
[[0.84 0.  ]
 [0.   0.84]]

Matriz [A1]
[[0.84 0.  ]
 [0.   0.84]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963  15.48 7684491 0.01227  59.93  0.00      6.49
  1   2  1   200  500 0.0500  0.0  TA  0.1963  15.48 7684491 0.01227  59.93  0.00      6.49
-------------------------------------------------------------------------------------------
Matriz [A]
[[19.72  0.  ]
 [ 0.   19.72]]

Matriz [A1]
[[19.72  0.  ]
 [ 0.   19.72]]

Matriz [qfi]
[-3038.82  3038.82]

Matriz [Hi]
[105.]

Matriz [Qi]
[3038.82 3038.82]

Matriz [dq]
[2.94 2.94]


-----Fin iteración:   1  Desbalance de caudales: 2938.816506


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   8.38 4162785 0.01247  17.88  0.00      6.60
  1   2  1   200  500 0.0500  0.0  TA  0.1963   8.38 4162785 0.01247  17.88  0.00      6.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[10.86  0.  ]
 [ 0.   10.86]]

Matriz [A1]
[[10.86  0.  ]
 [ 0.   10.86]]

Matriz [qfi]
[-1646.16  1646.16]

Matriz [Hi]
[105.]

Matriz [Qi]
[1646.16 1646.16]

Matriz [dq]
[-1.39 -1.39]


-----Fin iteración:   2  Desbalance de caudales: 1392.651570


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   5.36 2663592 0.01269   7.45  0.00      6.71
  1   2  1   200  500 0.0500  0.0  TA  0.1963   5.36 2663592 0.01269   7.45  0.00      6.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[7.07 0.  ]
 [0.   7.07]]

Matriz [A1]
[[7.07 0.  ]
 [0.   7.07]]

Matriz [qfi]
[-1053.31  1053.31]

Matriz [Hi]
[105.]

Matriz [Qi]
[1053.31 1053.31]

Matriz [dq]
[-0.59 -0.59]


-----Fin iteración:   3  Desbalance de caudales: 592.852962


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.48 2225914 0.01281   5.25  0.00      6.77
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.48 2225914 0.01281   5.25  0.00      6.77
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.96 0.  ]
 [0.   5.96]]

Matriz [A1]
[[5.96 0.  ]
 [0.   5.96]]

Matriz [qfi]
[-880.23  880.23]

Matriz [Hi]
[105.]

Matriz [Qi]
[880.23 880.23]

Matriz [dq]
[-0.17 -0.17]


-----Fin iteración:   4  Desbalance de caudales: 173.078834


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.38 2173593 0.01282   5.01  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.38 2173593 0.01282   5.01  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.83 0.  ]
 [0.   5.83]]

Matriz [A1]
[[5.83 0.  ]
 [0.   5.83]]

Matriz [qfi]
[-859.54  859.54]

Matriz [Hi]
[105.]

Matriz [Qi]
[859.54 859.54]

Matriz [dq]
[-0.02 -0.02]


-----Fin iteración:   5  Desbalance de caudales: 20.690251


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171621 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171621 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.76  858.76]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.76 858.76]

Matriz [dq]
[-0. -0.]


-----Fin iteración:   6  Desbalance de caudales: 0.779811


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171568 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171568 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.74  858.74]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.74 858.74]

Matriz [dq]
[-2.08e-05 -2.08e-05]


-----Fin iteración:   7  Desbalance de caudales: 0.020780


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171567 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171567 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.74  858.74]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.74 858.74]

Matriz [dq]
[-5.45e-07 -5.45e-07]


-----Fin iteración:   8  Desbalance de caudales: 0.000545

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/CaudalMax.mgh.json
Titulo:      Calculo de caudal maximo
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1   100.00     100.00     0.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2   100.00       0.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     200   500  0.1963  0.0500   0.0    TA   - 
  1    2  1     200   500  0.1963  0.0500   0.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -858.74
  1   100.00     100.00     0.00   858.74
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2   100.00       0.00    1.00     0.00     105.00     5.00
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     4.37  858.74    5.00    0.00    5.00   0.02500 
  1    2  1     4.37  858.74    5.00    0.00    5.00   0.02500 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:26 2022
crcs-2022
...
 
Procesando archivo N° 3 : ./input/default-error-topol.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
--
MÉTODO DEL GRADIENTE HIDRÁULICO
--
Archivo de entrada: ./input/default-error-topol.mgh.json
Titulo:      Archivo de prueba para error en topologia nudo-tramo
Autor:       Ing. Carlos Camacho
Fecha:       28/01/2019
Versión:     V0.01
--
Error en la topología de nudos y tramos: nudos sin conexión
Revise los siguientes nudos:  [2]
--
...
 
Procesando archivo N° 4 : ./input/default.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110, 60, -40, 30, 30, 40]

Matriz [Ho]
[110.]

Matriz [qi]
[ 60. -40.  30.  30.  40.]

Matriz [B]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]

Matriz [C]
[[0.]
 [0.]
 [0.]
 [0.]
 [0.]
 [0.]
 [0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   500  250 0.0015  0.0  TA  0.0491   2.04  505756 0.01316   5.57  0.00    556.81
  1   1  2   400  150 0.0015 10.0  TA  0.0177   5.66  842926 0.01217  52.97 16.32   6928.99
  2   3  2   200  100 0.0015  0.0  TA  0.0079  12.73 1264389 0.01158 191.34  0.00  19133.53
  3   4  3   400  150 0.0015  0.0  TA  0.0177   5.66  842926 0.01217  52.97  0.00   5296.86
  4   1  4   200  100 0.0015  0.0  TA  0.0079  12.73 1264389 0.01158 191.34  0.00  19133.53
  5   5  4   600  200 0.0015  0.0  TA  0.0314   3.18  632194 0.01270  19.67  0.00   1967.29
  6   0  5   300  250 0.0015  0.0  TA  0.0491   2.04  505756 0.01316   3.34  0.00    334.08
-------------------------------------------------------------------------------------------

Matriz [A]
[[  55.68    0.      0.      0.      0.      0.      0.  ]
 [   0.    692.9     0.      0.      0.      0.      0.  ]
 [   0.      0.   1913.35    0.      0.      0.      0.  ]
 [   0.      0.      0.    529.69    0.      0.      0.  ]
 [   0.      0.      0.      0.   1913.35    0.      0.  ]
 [   0.      0.      0.      0.      0.    196.73    0.  ]
 [   0.      0.      0.      0.      0.      0.     33.41]]

Matriz [A1]
[[  55.68    0.      0.      0.      0.      0.      0.  ]
 [   0.    692.9     0.      0.      0.      0.      0.  ]
 [   0.      0.   1913.35    0.      0.      0.      0.  ]
 [   0.      0.      0.    529.69    0.      0.      0.  ]
 [   0.      0.      0.      0.   1913.35    0.      0.  ]
 [   0.      0.      0.      0.      0.    196.73    0.  ]
 [   0.      0.      0.      0.      0.      0.     33.41]]

----Inician las iteraciones----

...
 
Procesando archivo N° 5 : ./input/EjemploBomba.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 10.0, 10.0, 15.0, 15.0, 10.0, 10.0, 15.0, 15.0]

Matriz [Ho]
[100.]

Matriz [qi]
[15.  15.  22.5 22.5 15.  15.  22.5 22.5]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  0.  1.  0.  0.  0.  0.  0.]
 [ 0.  0. -1.  1.  0.  0.  0.  0.]
 [ 0.  0.  0.  0. -1.  1.  0.  0.]
 [ 0.  0.  0.  0. -1.  0.  1.  0.]
 [ 0.  0.  0.  0.  0.  0. -1.  1.]
 [ 0.  0.  0.  0.  0. -1.  0.  1.]
 [-1.  1.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  0.  1.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  1.  0.  0.  0.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   1.41  421463 0.01544   0.53  0.00     52.52
  1   1  3    75  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  13.19  0.00   1319.07
  2   3  4   100  150 0.0500  4.0  TA  0.0177   5.66  842926 0.01616  17.59  6.53   2411.61
  3   5  6   100  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  17.59  0.00   1758.76
  4   5  7    75  100 0.0500  0.0  TA  0.0079  12.73 1264389 0.01719 106.53  0.00  10653.05
  5   7  8   100  100 0.0500  4.0  TA  0.0079  12.73 1264389 0.01719 142.04 33.05  17509.15
  6   6  8    75  100 0.0500  0.0  TA  0.0079  12.73 1264389 0.01719 106.53  0.00  10653.05
  7   1  2   100  200 0.0500  0.0  TA  0.0314   3.18  632194 0.01570   4.05  0.00    405.27
  8   2  4    75  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  13.19  0.00   1319.07
  9   2  5   100  150 0.0500  2.0  BO  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
-------------------------------------------------------------------------------------------

Matriz [A]
[[   5.25    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    131.91    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    241.16    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.    175.88    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1065.31    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.   1750.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.   1065.31    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     40.53    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    131.91    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -441.48]]

Matriz [A1]
[[   5.25    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    131.91    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    241.16    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.    175.88    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1065.31    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.   1750.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.   1065.31    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     40.53    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    131.91    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.    208.52]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.79  415123 0.01685   3.33  0.00   1374.75
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.51  225465 0.01777   1.38  0.47   2586.20
  3   5  6   100  150 0.0500  0.0  TA  0.0177   0.93  138788 0.01879   0.55  0.00   2044.78
  4   5  7    75  100 0.0500  0.0  TA  0.0079   5.54  550451 0.01769  20.78  0.00  10965.13
  5   7  8   100  100 0.0500  4.0  TA  0.0079   2.68  265964 0.01849   6.76  1.46  18583.66
  6   6  8    75  100 0.0500  0.0  TA  0.0079   0.19   18524 0.02748   0.04  0.00  17027.52
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.73  542120 0.01586   3.01  0.00    409.63
  8   2  4    75  150 0.0500  0.0  TA  0.0177  -0.24   35806 0.02350   0.03  0.00   1917.83
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     67.7     0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     69.18    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     33.67    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    477.37    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    390.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.     24.95    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     35.13    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.     -8.15    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    67.7    0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    69.18   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    33.67   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   477.37   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.   390.91   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.    24.95   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    35.13   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.    -8.15   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.95  96.05  99.15 110.36 150.63 162.42 164.4  265.83]

Matriz [Qi]
[150.    49.25  26.75  16.47  43.53  21.03   1.47  85.75  -4.25  75.  ]

Matriz [dq]
[ 0.05 -0.05 -0.07 -0.08 -0.06 -0.08 -0.1  -0.01 -0.1  -0.02]


-----Fin iteración:   1  Desbalance de caudales: 98.534964


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.42  360137 0.01703   2.54  0.00   1389.68
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.14  170478 0.01832   0.82  0.27   2646.55
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.80  267989 0.01747   1.92  0.00   1900.84
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.59  356650 0.01812   8.93  0.00  11227.90
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.73   72163 0.02135   0.57  0.11  20947.00
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.14  212325 0.01883   3.29  0.00  11671.14
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.94  583360 0.01578   3.47  0.00    407.49
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.13   19180 0.02688   0.01  0.00   2193.95
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     59.37    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     53.53    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     60.43    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    316.71    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    119.55    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    195.99    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.6     0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      4.99    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    59.37   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    53.53   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    60.43   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   316.71   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.   119.55   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   195.99   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.6    0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     4.99   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.39  96.41  95.46 157.5  155.92 151.35 155.11]

Matriz [Qi]
[150.    42.72  20.22  31.79  28.21   5.71  16.79  92.28   2.28  75.  ]

Matriz [dq]
[ 3.55e-15 -6.52e-03 -6.52e-03  1.53e-02 -1.53e-02 -1.53e-02  1.53e-02  6.52e-03  6.52e-03 -7.49e-16]


-----Fin iteración:   2  Desbalance de caudales: 15.327639


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356391 0.01704   2.49  0.00   1390.84
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166733 0.01837   0.78  0.26   2651.79
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.98  294781 0.01732   2.30  0.00   1884.37
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.19  316462 0.01826   7.09  0.00  11316.28
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.32   31975 0.02453   0.13  0.02  23569.91
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.54  252513 0.01857   4.59  0.00  11504.98
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586169 0.01578   3.50  0.00    407.36
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.15   22926 0.02582   0.02  0.00   2107.18
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.81    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.45    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     65.9     0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    283.23    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     59.61    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    229.77    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.77    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.73    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.81   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.45   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    65.9    0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   283.23   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    59.61   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   229.77   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.77   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.73   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.16 150.55 150.63]

Matriz [Qi]
[150.    42.28  19.78  34.97  25.03   2.53  19.97  92.72   2.72  75.  ]

Matriz [dq]
[-1.72e-15 -4.44e-04 -4.44e-04  3.18e-03 -3.18e-03 -3.18e-03  3.18e-03  4.44e-04  4.44e-04  6.38e-16]


-----Fin iteración:   3  Desbalance de caudales: 3.178454


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356222 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166563 0.01837   0.78  0.25   2652.03
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.99  297068 0.01731   2.34  0.00   1883.08
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  313032 0.01827   6.94  0.00  11324.72
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28544 0.02508   0.11  0.02  24026.71
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  255943 0.01855   4.71  0.00  11492.85
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586296 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23095 0.02578   0.02  0.00   2103.74
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.36    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.37    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     54.24    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.64    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.76    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.36   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.37   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    54.24   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.64   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.76   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.42]

Matriz [Qi]
[150.    42.26  19.76  35.24  24.76   2.26  20.24  92.74   2.74  75.  ]

Matriz [dq]
[ 2.72e-15 -2.01e-05 -2.01e-05  2.71e-04 -2.71e-04 -2.71e-04  2.71e-04  2.01e-05  2.01e-05  4.72e-16]


-----Fin iteración:   4  Desbalance de caudales: 0.271324


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356215 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166556 0.01837   0.78  0.25   2652.04
  3   5  6   100  150 0.0500  0.0  TA  0.0177   2.00  297172 0.01731   2.34  0.00   1883.02
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  312875 0.01828   6.93  0.00  11325.11
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28388 0.02511   0.10  0.02  24049.44
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  256100 0.01854   4.71  0.00  11492.31
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586302 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23102 0.02578   0.02  0.00   2103.60
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.39    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.24    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     54.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.77    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.77    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.39   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.24   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    54.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.77   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.77   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.41]

Matriz [Qi]
[150.    42.26  19.76  35.25  24.75   2.25  20.25  92.74   2.74  75.  ]

Matriz [dq]
[-1.78e-15 -8.63e-07 -8.63e-07  1.24e-05 -1.24e-05 -1.24e-05  1.24e-05  8.63e-07  8.63e-07 -1.08e-15]


-----Fin iteración:   5  Desbalance de caudales: 0.012357


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356214 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166556 0.01837   0.78  0.25   2652.04
  3   5  6   100  150 0.0500  0.0  TA  0.0177   2.00  297176 0.01731   2.34  0.00   1883.02
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  312869 0.01828   6.93  0.00  11325.12
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28381 0.02511   0.10  0.02  24050.39
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  256106 0.01854   4.72  0.00  11492.28
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586302 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23102 0.02578   0.02  0.00   2103.59
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.39    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.24    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     53.99    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.78    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.77    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.39   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.24   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    53.99   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.78   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.77   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.41]

Matriz [Qi]
[150.    42.26  19.76  35.26  24.74   2.24  20.26  92.74   2.74  75.  ]

Matriz [dq]
[ 4.61e-15 -3.71e-08 -3.71e-08  5.15e-07 -5.15e-07 -5.15e-07  5.15e-07  3.71e-08  3.71e-08  2.22e-16]


-----Fin iteración:   6  Desbalance de caudales: 0.000515

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploBomba.mgh.json
Titulo:      Ejemplo con equipo de bombeo
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.5

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    80.00      10.00     1.00 
  2    80.00      10.00     1.00 
  3    80.00      15.00     1.00 
  4    80.00      15.00     1.00 
  5   150.00      10.00     1.00 
  6   150.00      10.00     1.00 
  7   150.00      15.00     1.00 
  8   150.00      15.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   300  0.0707  0.0500   0.0    TA   - 
  1    1  3      75   150  0.0177  0.0500   0.0    TA   - 
  2    3  4     100   150  0.0177  0.0500   4.0    TA   - 
  3    5  6     100   150  0.0177  0.0500   0.0    TA   - 
  4    5  7      75   100  0.0079  0.0500   0.0    TA   - 
  5    7  8     100   100  0.0079  0.0500   4.0    TA   - 
  6    6  8      75   100  0.0079  0.0500   0.0    TA   - 
  7    1  2     100   200  0.0314  0.0500   0.0    TA   - 
  8    2  4      75   150  0.0177  0.0500   0.0    TA   - 
  9    2  5     100   150  0.0177  0.0500   2.0    BO   -3125.0 187.5 77.5 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -150.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    80.00      10.00    1.00    15.00      98.86    18.86
  2    80.00      10.00    1.00    15.00      95.36    15.36
  3    80.00      15.00    1.00    22.50      96.38    16.38
  4    80.00      15.00    1.00    22.50      95.34    15.34
  5   150.00      10.00    1.00    15.00     157.47     7.47
  6   150.00      10.00    1.00    15.00     155.13     5.13
  7   150.00      15.00    1.00    22.50     150.53     0.53
  8   150.00      15.00    1.00    22.50     150.41     0.41
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     2.12  150.00    1.14    0.00    1.14   0.01138 
  1    1  3     2.39   42.26    2.48    0.00    2.48   0.03312 
  2    3  4     1.12   19.76    0.78    0.25    1.04   0.01035 
  3    5  6     2.00   35.26    2.34    0.00    2.34   0.02340 
  4    5  7     3.15   24.74    6.93    0.00    6.93   0.09246 
  5    7  8     0.29    2.24    0.10    0.02    0.12   0.00121 
  6    6  8     2.58   20.26    4.72    0.00    4.72   0.06287 
  7    1  2     2.95   92.74    3.50    0.00    3.50   0.03504 
  8    2  4     0.16    2.74    0.02    0.00    0.02   0.00021 
  9    2  5     4.24   75.00   10.04    1.84   11.87   0.11873 HBO=73.98
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 6 : ./input/EjemploVRP.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0]

Matriz [Ho]
[100.]

Matriz [qi]
[30. 20. 30. 30. 20. 14.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.]
 [ 0.  0. -1.  0.  0.  1.]
 [-1.  0.  0.  1.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.]
 [ 0.  0.  0. -1.  1.  0.]
 [ 0.  0.  0.  0.  1. -1.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   4.05  1.03    508.56
  1   1  2    80  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   3.24  1.03    427.50
  2   3  6   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  3   1  4   200  200 0.0500  2.0  VR  0.0314   3.18  632194 0.01570   8.11  1.03    913.83
  4   4  3   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  5   4  5   100  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
  6   6  5    80  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  14.07  3.26   1733.43
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

Matriz [A1]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.76  150908 0.01812   0.33  0.06    688.05
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.71  340566 0.01649   1.54  0.30    635.59
  5   4  5   100  150 0.0500  2.0  TA  0.0177   0.57   85385 0.02013   0.22  0.03   2517.08
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.56   83200 0.02021   0.17  0.03   2086.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.    16.42   0.     0.     0.     0.  ]
 [  0.     0.     0.   313.74   0.     0.     0.  ]
 [  0.     0.     0.     0.    34.24   0.     0.  ]
 [  0.     0.     0.     0.     0.    25.5    0.  ]
 [  0.     0.     0.     0.     0.     0.    20.59]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   16.42  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   34.24  0.    0.  ]
 [ 0.    0.    0.    0.    0.   25.5   0.  ]
 [ 0.    0.    0.    0.    0.    0.   20.59]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[90.44 93.   81.93 82.4  99.02 85.11]

Matriz [Qi]
[144.    20.    23.87  94.    53.87  10.13   9.87]

Matriz [dq]
[ 0.04 -0.08 -0.08 -0.01 -0.05 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 89.870431


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.40   79635 0.01998   0.10  0.02    748.25
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.36  269293 0.01689   0.99  0.19    648.30
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.21  180415 0.01820   0.91  0.15   2307.08
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.08   11830 0.03022   0.01  0.00   2956.88
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     9.43   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    27.62   0.     0.  ]
 [  0.     0.     0.     0.     0.    49.38   0.  ]
 [  0.     0.     0.     0.     0.     0.    -4.15]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    9.43  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   27.62  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -4.15]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.07 60.14 59.31 59.05]

Matriz [Qi]
[144.   20.   12.6  94.   42.6  21.4  -1.4]

Matriz [dq]
[-3.05e-16  1.73e-17 -1.13e-02 -8.33e-17 -1.13e-02  1.13e-02 -1.13e-02]


-----Fin iteración:   2  Desbalance de caudales: 11.273820


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   70261 0.02042   0.08  0.01    762.35
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259919 0.01695   0.92  0.17    650.38
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  192914 0.01807   1.03  0.17   2292.20
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.16   24329 0.02548   0.02  0.00   2544.83
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.47   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.74   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.46   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.34]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.47  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.74  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.46  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.34]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.11  94.    41.11  22.89  -2.89]

Matriz [dq]
[-8.88e-16  6.94e-18 -1.48e-03 -1.26e-15 -1.48e-03  1.48e-03 -1.48e-03]


-----Fin iteración:   3  Desbalance de caudales: 1.482857


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   69705 0.02045   0.08  0.01    763.28
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259363 0.01695   0.92  0.17    650.51
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  193655 0.01806   1.04  0.17   2291.36
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.17   25070 0.02532   0.02  0.00   2530.34
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.42   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.69   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.64   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.53]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.42  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.69  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.64  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.53]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.03  94.    41.03  22.97  -2.97]

Matriz [dq]
[ 2.55e-15  7.29e-16 -8.79e-05  2.05e-15 -8.79e-05  8.79e-05 -8.79e-05]


-----Fin iteración:   4  Desbalance de caudales: 0.087867


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   69679 0.02045   0.08  0.01    763.32
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259338 0.01695   0.92  0.17    650.51
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  193689 0.01806   1.04  0.17   2291.32
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.17   25104 0.02531   0.02  0.00   2529.69
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.41   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.69   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.65   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.53]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.41  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.69  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.65  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.53]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.02  94.    41.02  22.98  -2.98]

Matriz [dq]
[-1.36e-15 -1.42e-15 -4.05e-06 -1.39e-15 -4.05e-06  4.05e-06 -4.05e-06]


-----Fin iteración:   5  Desbalance de caudales: 0.004053

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploVRP.mgh.json
Titulo:      Ejemplo con valvula de control
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    70.00      20.00     1.50 
  2    70.00      20.00     1.00 
  3    40.00      30.00     1.00 
  4    40.00      30.00     1.00 
  5    40.00      20.00     1.00 
  6    40.00      10.00     1.40 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   200  0.0314  0.0500   2.0    TA   - 
  1    1  2      80   200  0.0314  0.0500   2.0    TA   - 
  2    3  6     125   200  0.0314  0.0500   2.0    TA   - 
  3    1  4     200   200  0.0314  0.0500   2.0    VR   10 
  4    4  3     125   200  0.0314  0.0500   2.0    TA   - 
  5    4  5     100   150  0.0177  0.0500   2.0    TA   - 
  6    6  5      80   150  0.0177  0.0500   2.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -144.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    70.00      20.00    1.50    30.00      89.63    19.63
  2    70.00      20.00    1.00    20.00      89.44    19.44
  3    40.00      30.00    1.00    30.00      59.85    19.85
  4    40.00      30.00    1.00    30.00      60.95    20.95
  5    40.00      20.00    1.00    20.00      59.74    19.74
  6    40.00      10.00    1.40    14.00      59.76    19.76
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     4.58  144.00    8.22    2.14   10.37   0.10367 
  1    1  2     0.64   20.00    0.15    0.04    0.19   0.00244 
  2    3  6     0.35   11.02    0.08    0.01    0.09   0.00074 
  3    1  4     2.99   94.00    7.19    0.91    8.10   0.04052 HVR=-20.58
  4    4  3     1.31   41.02    0.92    0.17    1.09   0.00876 
  5    4  5     1.30   22.98    1.04    0.17    1.21   0.01210 
  6    6  5    -0.17   -2.98    0.02    0.00    0.02   0.00028 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 7 : ./input/EjemploVSP.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0]

Matriz [Ho]
[100.]

Matriz [qi]
[20. 20. 30. 30. 20. 10.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.]
 [ 0.  0. -1.  0.  0.  1.]
 [-1.  0.  0.  1.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.]
 [ 0.  0.  0. -1.  1.  0.]
 [ 0.  0.  0.  0.  1. -1.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   4.05  1.03    508.56
  1   1  2    80  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   3.24  1.03    427.50
  2   3  6   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  3   1  4   200  200 0.0500  2.0  VS  0.0314   3.18  632194 0.01570   8.11  1.03    913.83
  4   4  3   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  5   4  5   100  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
  6   6  5    80  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  14.07  3.26   1733.43
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.   987.07   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

Matriz [A1]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.66  131742 0.01847   0.26  0.04    699.30
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.62  321400 0.01658   1.38  0.27    638.56
  5   4  5   100  150 0.0500  2.0  TA  0.0177   0.52   77222 0.02045   0.19  0.03   2552.09
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.61   91363 0.01993   0.20  0.04   2060.87
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   14.57  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   32.46  0.    0.  ]
 [ 0.    0.    0.    0.    0.   23.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   22.34]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   14.57  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   32.46  0.    0.  ]
 [ 0.    0.    0.    0.    0.   23.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   22.34]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.86 94.43 -5.12 -5.02 12.01 -1.56]

Matriz [Qi]
[130.    20.    20.84  90.    50.84   9.16  10.84]

Matriz [dq]
[ 0.03 -0.08 -0.08 -0.01 -0.05 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 90.838800


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.32   64197 0.02075   0.07  0.01    773.03
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.28  253855 0.01699   0.88  0.17    651.79
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.12  167282 0.01836   0.79  0.13   2324.58
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.01    1303 0.06006   0.00  0.00   5554.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    7.85  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.17  0.    0.  ]
 [ 0.    0.    0.    0.    0.   46.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.86]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    7.85  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.17  0.    0.  ]
 [ 0.    0.    0.    0.    0.   46.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.86]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.11 84.06 83.35 83.12]

Matriz [Qi]
[130.    20.    10.15  90.    40.15  19.85   0.15]

Matriz [dq]
[ 1.67e-16  7.49e-16 -1.07e-02  9.71e-16 -1.07e-02  1.07e-02 -1.07e-02]


-----Fin iteración:   2  Desbalance de caudales: 10.684201


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55798 0.02129   0.05  0.01    790.49
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.24  245456 0.01706   0.83  0.16    653.83
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  178481 0.01823   0.89  0.15   2309.53
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07    9896 0.03164   0.00  0.00   3080.65
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.98  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.39  0.    0.  ]
 [ 0.    0.    0.    0.    0.   48.9   0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.62]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.98  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.39  0.    0.  ]
 [ 0.    0.    0.    0.    0.   48.9   0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.62]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.03 83.02]

Matriz [Qi]
[130.    20.     8.83  90.    38.83  21.17  -1.17]

Matriz [dq]
[-1.28e-14  4.16e-17 -1.33e-03 -1.35e-14 -1.33e-03  1.33e-03 -1.33e-03]


-----Fin iteración:   3  Desbalance de caudales: 1.328595


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55146 0.02134   0.05  0.01    792.01
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.23  244805 0.01706   0.83  0.15    653.99
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  179349 0.01822   0.90  0.15   2308.42
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07   10764 0.03096   0.00  0.00   3021.12
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.12  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.86]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.12  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.86]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.02 83.02]

Matriz [Qi]
[130.    20.     8.72  90.    38.72  21.28  -1.28]

Matriz [dq]
[ 1.29e-14  7.32e-16 -1.03e-04  1.23e-14 -1.03e-04  1.03e-04 -1.03e-04]


-----Fin iteración:   4  Desbalance de caudales: 0.102989


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55114 0.02134   0.05  0.01    792.08
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.23  244773 0.01706   0.83  0.15    654.00
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  179392 0.01821   0.90  0.15   2308.37
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07   10807 0.03093   0.00  0.00   3018.37
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.87]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.87]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.02 83.02]

Matriz [Qi]
[130.    20.     8.72  90.    38.72  21.28  -1.28]

Matriz [dq]
[ 1.33e-15 -2.14e-15 -5.07e-06  2.01e-15 -5.07e-06  5.07e-06 -5.07e-06]


-----Fin iteración:   5  Desbalance de caudales: 0.005070

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploVSP.mgh.json
Titulo:      Ejemplo con valvula de control
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    70.00      20.00     1.00 
  2    70.00      20.00     1.00 
  3    40.00      30.00     1.00 
  4    40.00      30.00     1.00 
  5    40.00      20.00     1.00 
  6    40.00      10.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   200  0.0314  0.0500   2.0    TA   - 
  1    1  2      80   200  0.0314  0.0500   2.0    TA   - 
  2    3  6     125   200  0.0314  0.0500   2.0    TA   - 
  3    1  4     200   200  0.0314  0.0500   2.0    VS   30 
  4    4  3     125   200  0.0314  0.0500   2.0    TA   - 
  5    4  5     100   150  0.0177  0.0500   2.0    TA   - 
  6    6  5      80   150  0.0177  0.0500   2.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -130.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    70.00      20.00    1.00    20.00      91.51    21.51
  2    70.00      20.00    1.00    20.00      91.32    21.32
  3    40.00      30.00    1.00    30.00      83.08    43.08
  4    40.00      30.00    1.00    30.00      84.06    44.06
  5    40.00      20.00    1.00    20.00      83.02    43.02
  6    40.00      10.00    1.00    10.00      83.02    43.02
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     4.14  130.00    6.74    1.75    8.49   0.08486 
  1    1  2     0.64   20.00    0.15    0.04    0.19   0.00244 
  2    3  6     0.28    8.72    0.05    0.01    0.06   0.00048 
  3    1  4     2.86   90.00    6.61    0.84    7.45   0.03725 HVS=0.00
  4    4  3     1.23   38.72    0.83    0.15    0.98   0.00784 
  5    4  5     1.20   21.28    0.90    0.15    1.05   0.01046 
  6    6  5    -0.07   -1.28    0.00    0.00    0.00   0.00006 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 8 : ./input/Naciente.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[160.0, 100.0, 10.0, -100.0]

Matriz [Ho]
[160. 100.]

Matriz [qi]
[  10. -100.]

Matriz [B]
[[ 1.  0.]
 [-1.  0.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]
 [ 1.  0.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[190.33   0.     0.  ]
 [  0.   185.16   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   185.16   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.29  852370 0.01212  28.45  4.69   1823.41
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.97  789151 0.01228  24.70  3.22   1791.69
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[245.85   0.     0.  ]
 [  0.   223.65   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[245.85   0.     0.  ]
 [  0.   223.65   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-34.83 124.83]

Matriz [Hi]
[127.71 178.52]

Matriz [Qi]
[134.83 124.83 100.  ]

Matriz [dq]
[ 3.48e-02  2.48e-02 -2.78e-17]


-----Fin iteración:   1  Desbalance de caudales: 34.827191


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.26  845203 0.01214  28.01  4.62   1825.57
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.94  781983 0.01230  24.29  3.16   1794.08
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[244.07   0.     0.  ]
 [  0.   221.92   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[244.07   0.     0.  ]
 [  0.   221.92   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.69 123.69]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.69 123.69 100.  ]

Matriz [dq]
[-1.13e-03 -1.13e-03  5.55e-17]


-----Fin iteración:   2  Desbalance de caudales: 1.133711


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.25  844661 0.01214  27.98  4.61   1825.74
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.93  781442 0.01230  24.26  3.16   1794.26
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.93   0.     0.  ]
 [  0.   221.79   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[243.93   0.     0.  ]
 [  0.   221.79   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.61 123.61]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.61 123.61 100.  ]

Matriz [dq]
[-8.56e-05 -8.56e-05  2.78e-17]


-----Fin iteración:   3  Desbalance de caudales: 0.085648


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.25  844622 0.01214  27.98  4.61   1825.75
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.93  781403 0.01230  24.26  3.16   1794.28
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.92   0.     0.  ]
 [  0.   221.78   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[243.92   0.     0.  ]
 [  0.   221.78   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.6 123.6]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.6 123.6 100. ]

Matriz [dq]
[-6.15e-06 -6.15e-06 -1.39e-17]


-----Fin iteración:   4  Desbalance de caudales: 0.006155

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Naciente.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   150.00     160.00    10.00 
  1    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    90.00      10.00     1.00 
  3   160.00    -100.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  1     500   200  0.0314  0.0015   4.0    TA   - 
  2    3  0     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   150.00     160.00    10.00   -33.60
  1    90.00     100.00    10.00   123.60
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    90.00      10.00    1.00    10.00     127.41    37.41
  3   160.00    -100.00    1.00  -100.00     178.52    18.52
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     4.25  133.60   27.98    4.61   32.59   0.06518 
  1    2  1     3.93  123.60   24.26    3.16   27.41   0.05482 
  2    3  0     3.18  100.00   16.45    2.07   18.52   0.03703 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 9 : ./input/P3Tanques.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[132.0, 90.0, 128.0, 100.0]

Matriz [Ho]
[132.  90. 128.]

Matriz [qi]
[100.]

Matriz [B]
[[1.]
 [1.]
 [1.]]

Matriz [C]
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
-------------------------------------------------------------------------------------------

Matriz [A]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

Matriz [A1]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   1.96  486572 0.01325  10.38  0.98   1226.86
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -1.55  384436 0.01381   6.75  0.61   1274.31
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   1.63  403619 0.01369   7.38  0.67   1264.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [A1]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [qfi]
[-96.21  76.01 -79.81]

Matriz [Hi]
[120.73]

Matriz [Qi]
[ 96.21 -76.01  79.81]

Matriz [dq]
[-0.   -0.18 -0.02]


-----Fin iteración:   1  Desbalance de caudales: 3.793013


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491  -2.17  538086 0.01302  12.47  1.20   1207.56
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   7.48 1856401 0.01071 122.05 14.25   1011.65
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -3.27  812560 0.01216  26.55  2.73   1134.22
-------------------------------------------------------------------------------------------
Matriz [A]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [A1]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [qfi]
[ 106.39 -367.06  160.66]

Matriz [Hi]
[168.47]

Matriz [Qi]
[-106.39  367.06 -160.66]

Matriz [dq]
[-0.2   0.44 -0.24]


-----Fin iteración:   2  Desbalance de caudales: 202.599399


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   0.35   86641 0.01844   0.46  0.03   1666.31
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.09  519116 0.01310  11.68  1.11   1214.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -0.40  100002 0.01790   0.59  0.04   1620.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [A1]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [qfi]
[ -17.13 -102.64   19.77]

Matriz [Hi]
[150.07]

Matriz [Qi]
[ 17.13 102.64 -19.77]

Matriz [dq]
[ 0.12 -0.26  0.14]


-----Fin iteración:   3  Desbalance de caudales: 123.523463


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   9.58 2378445 0.01034 193.47 23.39    980.58
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -0.23   57748 0.02013   0.22  0.01   1808.95
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -7.31 1814942 0.01074 117.04 13.62   1014.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [A1]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [qfi]
[-470.28   11.42  358.86]

Matriz [Hi]
[105.64]

Matriz [Qi]
[ 470.28  -11.42 -358.86]

Matriz [dq]
[ 0.45 -0.11 -0.34]


-----Fin iteración:   4  Desbalance de caudales: 453.144660


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   5.67 1406859 0.01115  73.02  8.18   1049.41
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.02  254229 0.01489   3.18  0.27   1366.00
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.65 1155333 0.01149  50.75  5.52   1078.25
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [A1]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [qfi]
[-278.17  -50.27  228.44]

Matriz [Hi]
[92.31]

Matriz [Qi]
[ 278.17   50.27 -228.44]

Matriz [dq]
[-0.19  0.06  0.13]


-----Fin iteración:   5  Desbalance de caudales: 192.105878


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.58 1135921 0.01152  49.19  5.34   1080.82
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.69  418996 0.01360   7.90  0.73   1256.59
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.23 1049162 0.01167  42.48  4.55   1093.00
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [A1]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [qfi]
[-224.6   -82.85  207.44]

Matriz [Hi]
[82.07]

Matriz [Qi]
[ 224.6    82.85 -207.44]

Matriz [dq]
[-0.05  0.03  0.02]


-----Fin iteración:   6  Desbalance de caudales: 53.570998


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.48 1111252 0.01156  47.23  5.11   1084.16
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.84  456132 0.01340   9.22  0.86   1239.54
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1061628 0.01165  43.42  4.66   1091.17
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [A1]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [qfi]
[-219.72  -90.19  209.91]

Matriz [Hi]
[79.85]

Matriz [Qi]
[ 219.72   90.19 -209.91]

Matriz [dq]
[-0.    0.01 -0.  ]


-----Fin iteración:   7  Desbalance de caudales: 4.877723


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109840 0.01157  47.12  5.09   1084.35
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  458956 0.01339   9.33  0.87   1238.32
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063041 0.01164  43.53  4.67   1090.97
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [A1]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [qfi]
[-219.44  -90.75  210.19]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.44   90.75 -210.19]

Matriz [dq]
[-0.  0. -0.]


-----Fin iteración:   8  Desbalance de caudales: 0.279121


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109731 0.01157  47.12  5.09   1084.36
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459156 0.01338   9.33  0.87   1238.24
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063131 0.01164  43.53  4.67   1090.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-2.16e-05  3.94e-05 -1.78e-05]


-----Fin iteración:   9  Desbalance de caudales: 0.021561


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109722 0.01157  47.11  5.09   1084.37
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459170 0.01338   9.33  0.87   1238.23
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063136 0.01164  43.53  4.67   1090.95
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-1.69e-06  2.77e-06 -1.08e-06]


-----Fin iteración:  10  Desbalance de caudales: 0.001691

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/P3Tanques.mgh.json
Titulo:      Problema de los 3 tanques
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     132.00    32.00 
  1   130.00      90.00   -40.00 
  2   120.00     128.00     8.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  3    70.00     100.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  3    1000   250  0.0491  0.0015   5.0    TA   - 
  1    1  3    1000   250  0.0491  0.0015   5.0    TA   - 
  2    2  3    1000   250  0.0491  0.0015   5.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     132.00    32.00  -219.42
  1   130.00      90.00   -40.00   -90.79
  2   120.00     128.00     8.00   210.21
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  3    70.00     100.00    1.00   100.00      79.79     9.79
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  3     4.47  219.42   47.11    5.09   52.21   0.05221 
  1    1  3     1.85   90.79    9.33    0.87   10.21   0.01021 
  2    2  3    -4.28  -210.21   43.53    4.67   48.21   0.04821 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 10 : ./input/pruebaJSON.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

...
 
Procesando archivo N° 11 : ./input/Qmax-VR.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 55.0, 10.0, 20.0]

Matriz [Ho]
[110.  55.]

Matriz [qi]
[10. 20.]

Matriz [B]
[[ 1.  0.]
 [-1.  1.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.18  632194 0.01274  16.45  0.00   1645.05
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.64  722344 0.01246  21.00  3.37   1866.77
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.32  659125 0.01265  17.76  0.00   1633.48
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.68  532686 0.01312  12.03  1.47   1900.64
-------------------------------------------------------------------------------------------
Matriz [A]
[[213.3    0.     0.  ]
 [  0.   378.07   0.  ]
 [  0.     0.   160.15]]

Matriz [A1]
[[213.3    0.     0.  ]
 [  0.   170.31   0.  ]
 [  0.     0.   160.15]]

Matriz [qfi]
[-114.26   84.26]

Matriz [Hi]
[85.54 67.69]

Matriz [Qi]
[114.26 104.26  84.26]

Matriz [dq]
[ 0.01  0.   -0.02]


-----Fin iteración:   1  Desbalance de caudales: 14.259853


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.98  592809 0.01288  14.62  2.27   1921.39
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.67  529590 0.01314  11.90  0.00   1695.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.03  403151 0.01378   7.24  0.84   1985.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[180.17   0.     0.  ]
 [  0.   541.     0.  ]
 [  0.     0.   126.64]]

Matriz [A1]
[[180.17   0.     0.  ]
 [  0.   142.06   0.  ]
 [  0.     0.   126.64]]

Matriz [qfi]
[-93.77  63.77]

Matriz [Hi]
[94.37 61.93]

Matriz [Qi]
[93.77 83.77 63.77]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:   2  Desbalance de caudales: 20.489800


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.44  485137 0.01334  10.14  1.52   1980.10
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.12  421917 0.01367   7.86  0.00   1764.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.49  295478 0.01458   4.11  0.45   2089.31
-------------------------------------------------------------------------------------------
Matriz [A]
[[151.95   0.     0.  ]
 [  0.   721.82   0.  ]
 [  0.     0.    97.65]]

Matriz [A1]
[[151.95   0.     0.  ]
 [  0.   117.78   0.  ]
 [  0.     0.    97.65]]

Matriz [qfi]
[-76.74  46.74]

Matriz [Hi]
[99.24 58.76]

Matriz [Qi]
[76.74 66.74 46.74]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:   3  Desbalance de caudales: 17.031520


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.04  404281 0.01377   7.27  1.06   2036.57
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.72  341061 0.01420   5.34  0.00   1833.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.08  214622 0.01549   2.30  0.24   2206.08
-------------------------------------------------------------------------------------------
Matriz [A]
[[130.24   0.     0.  ]
 [  0.   924.86   0.  ]
 [  0.     0.    74.89]]

Matriz [A1]
[[130.24   0.     0.  ]
 [  0.    98.93   0.  ]
 [  0.     0.    74.89]]

Matriz [qfi]
[-63.95  33.95]

Matriz [Hi]
[102.23  57.07]

Matriz [Qi]
[63.95 53.95 33.95]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   4  Desbalance de caudales: 12.789758


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.73  344338 0.01418   5.43  0.77   2088.81
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.42  281119 0.01472   3.76  0.00   1900.22
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.78  154680 0.01651   1.28  0.12   2337.68
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 113.77    0.      0.  ]
 [   0.   1147.36    0.  ]
 [   0.      0.     57.2 ]]

Matriz [A1]
[[113.77   0.     0.  ]
 [  0.    84.5    0.  ]
 [  0.     0.    57.2 ]]

Matriz [qfi]
[-54.47  24.47]

Matriz [Hi]
[104.14  56.12]

Matriz [Qi]
[54.47 44.47 24.47]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   5  Desbalance de caudales: 9.481598


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.51  299594 0.01455   4.22  0.58   2136.14
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.19  236374 0.01521   2.74  0.00   1963.09
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.55  109936 0.01768   0.69  0.06   2489.40
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 101.23    0.      0.  ]
 [   0.   1385.04    0.  ]
 [   0.      0.     43.29]]

Matriz [A1]
[[101.23   0.     0.  ]
 [  0.    73.4    0.  ]
 [  0.     0.    43.29]]

Matriz [qfi]
[-47.39  17.39]

Matriz [Hi]
[105.41  55.59]

Matriz [Qi]
[47.39 37.39 17.39]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   6  Desbalance de caudales: 7.077653


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.34  265711 0.01487   3.39  0.46   2178.52
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.02  202492 0.01566   2.07  0.00   2021.95
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.38   76053 0.01910   0.36  0.03   2671.95
-------------------------------------------------------------------------------------------
Matriz [A]
[[  91.56    0.      0.  ]
 [   0.   1633.63    0.  ]
 [   0.      0.     32.14]]

Matriz [A1]
[[91.56  0.    0.  ]
 [ 0.   64.76  0.  ]
 [ 0.    0.   32.14]]

Matriz [qfi]
[-42.03  12.03]

Matriz [Hi]
[106.29  55.29]

Matriz [Qi]
[42.03 32.03 12.03]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   7  Desbalance de caudales: 5.359539


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.21  239546 0.01517   2.81  0.37   2216.35
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.89  176326 0.01609   1.62  0.00   2076.94
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.25   49887 0.02093   0.17  0.01   2908.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[  83.98    0.      0.  ]
 [   0.   1890.11    0.  ]
 [   0.      0.     22.95]]

Matriz [A1]
[[83.98  0.    0.  ]
 [ 0.   57.93  0.  ]
 [ 0.    0.   22.95]]

Matriz [qfi]
[-37.89   7.89]

Matriz [Hi]
[106.91  55.12]

Matriz [Qi]
[37.89 27.89  7.89]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   8  Desbalance de caudales: 4.138853


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.10  218827 0.01543   2.39  0.31   2250.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.78  155607 0.01649   1.29  0.00   2128.60
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.15   29168 0.02366   0.07  0.00   3261.03
-------------------------------------------------------------------------------------------
Matriz [A]
[[  77.89    0.      0.  ]
 [   0.   2153.79    0.  ]
 [   0.      0.     15.05]]

Matriz [A1]
[[77.89  0.    0.  ]
 [ 0.   52.39  0.  ]
 [ 0.    0.   15.05]]

Matriz [qfi]
[-34.61   4.61]

Matriz [Hi]
[107.37  55.03]

Matriz [Qi]
[34.61 24.61  4.61]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   9  Desbalance de caudales: 3.277283


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.02  201890 0.01567   2.06  0.26   2281.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.70  138670 0.01687   1.05  0.00   2177.97
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.06   12231 0.02931   0.01  0.00   3990.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[  72.85    0.      0.  ]
 [   0.   2427.44    0.  ]
 [   0.      0.      7.72]]

Matriz [A1]
[[72.85  0.    0.  ]
 [ 0.   47.77  0.  ]
 [ 0.    0.    7.72]]

Matriz [qfi]
[-31.93   1.93]

Matriz [Hi]
[107.72  54.99]

Matriz [Qi]
[31.93 21.93  1.93]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  10  Desbalance de caudales: 2.679108


-----Iteración número:  11 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.94  187441 0.01590   1.80  0.23   2310.58
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.63  124222 0.01725   0.86  0.00   2226.73
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.01    2217 0.04785   0.00  0.00   6383.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 6.85e+01  0.00e+00  0.00e+00]
 [ 0.00e+00  2.72e+03  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.24e+00]]

Matriz [A1]
[[68.51  0.    0.  ]
 [ 0.   43.75  0.  ]
 [ 0.    0.   -2.24]]

Matriz [qfi]
[-29.65  -0.35]

Matriz [Hi]
[108.01  54.98]

Matriz [Qi]
[29.65 19.65 -0.35]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  11  Desbalance de caudales: 2.285421


-----Iteración número:  12 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.88  173987 0.01613   1.58  0.20   2340.57
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.56  110768 0.01765   0.70  0.00   2279.31
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.08   15671 0.02751   0.02  0.00   3758.88
-------------------------------------------------------------------------------------------
Matriz [A]
[[  64.42    0.      0.  ]
 [   0.   3059.74    0.  ]
 [   0.      0.     -9.32]]

Matriz [A1]
[[64.42  0.    0.  ]
 [ 0.   39.94  0.  ]
 [ 0.    0.   -9.32]]

Matriz [qfi]
[-27.52  -2.48]

Matriz [Hi]
[108.26  55.01]

Matriz [Qi]
[27.52 17.52 -2.48]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  12  Desbalance de caudales: 2.128129


-----Iteración número:  13 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.81  160478 0.01639   1.36  0.17   2373.89
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.49   97259 0.01813   0.55  0.00   2341.24
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.15   29180 0.02366   0.07  0.00   3260.74
-------------------------------------------------------------------------------------------
Matriz [A]
[[  60.26    0.      0.  ]
 [   0.   3495.73    0.  ]
 [   0.      0.    -15.05]]

Matriz [A1]
[[ 60.26   0.     0.  ]
 [  0.    36.02   0.  ]
 [  0.     0.   -15.05]]

Matriz [qfi]
[-25.38  -4.62]

Matriz [Hi]
[108.5   55.06]

Matriz [Qi]
[25.38 15.38 -4.62]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  13  Desbalance de caudales: 2.136848


-----Iteración número:  14 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.73  145742 0.01670   1.15  0.14   2414.66
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.42   82523 0.01877   0.41  0.00   2423.11
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.22   43916 0.02153   0.13  0.01   2986.72
-------------------------------------------------------------------------------------------
Matriz [A]
[[  55.67    0.      0.  ]
 [   0.   4133.63    0.  ]
 [   0.      0.    -20.75]]

Matriz [A1]
[[ 55.67   0.     0.  ]
 [  0.    31.63   0.  ]
 [  0.     0.   -20.75]]

Matriz [qfi]
[-23.05  -6.95]

Matriz [Hi]
[108.75  55.14]

Matriz [Qi]
[23.05 13.05 -6.95]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  14  Desbalance de caudales: 2.330991


-----Iteración número:  15 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.64  127449 0.01716   0.90  0.10   2473.43
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.32   64229 0.01980   0.26  0.00   2556.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.31   62210 0.01994   0.25  0.02   2780.74
-------------------------------------------------------------------------------------------
Matriz [A]
[[  49.86    0.      0.  ]
 [   0.   5331.91    0.  ]
 [   0.      0.    -27.36]]

Matriz [A1]
[[ 49.86   0.     0.  ]
 [  0.    25.97   0.  ]
 [  0.     0.   -27.36]]

Matriz [qfi]
[-20.16  -9.84]

Matriz [Hi]
[109.04  55.26]

Matriz [Qi]
[20.16 10.16 -9.84]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  15  Desbalance de caudales: 2.893624


-----Iteración número:  16 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.50   98410 0.01809   0.57  0.06   2593.74
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.18   35190 0.02265   0.09  0.00   2923.96
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.46   91248 0.01838   0.49  0.04   2579.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[  40.38    0.      0.  ]
 [   0.   9790.55    0.  ]
 [   0.      0.    -37.23]]

Matriz [A1]
[[ 40.38   0.     0.  ]
 [  0.    16.28   0.  ]
 [  0.     0.   -37.23]]

Matriz [qfi]
[-15.57 -14.43]

Matriz [Hi]
[109.45  55.52]

Matriz [Qi]
[ 15.57   5.57 -14.43]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  16  Desbalance de caudales: 4.593325


-----Iteración número:  17 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.05    9628 0.03121   0.01  0.00   4287.17
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -0.37   72847 0.01927   0.33  0.00   2488.12
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.00  199286 0.01571   2.02  0.21   2234.75
-------------------------------------------------------------------------------------------
Matriz [A]
[[   -6.53     0.       0.  ]
 [    0.   -4852.65     0.  ]
 [    0.       0.     -70.45]]

Matriz [A1]
[[ -6.53   0.     0.  ]
 [  0.   -28.67   0.  ]
 [  0.     0.   -70.45]]

Matriz [qfi]
[  1.52 -31.52]

Matriz [Hi]
[110.75  56.81]

Matriz [Qi]
[ -1.52 -11.52 -31.52]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  17  Desbalance de caudales: 17.089311


-----Iteración número:  18 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.43   84540 0.01867   0.43  0.05   2669.02
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.11   21321 0.02550   0.04  0.00   3292.01
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.53  105118 0.01785   0.64  0.06   2510.51
-------------------------------------------------------------------------------------------
Matriz [A]
[[   35.69     0.       0.  ]
 [    0.   16368.69     0.  ]
 [    0.       0.     -41.74]]

Matriz [A1]
[[ 35.69   0.     0.  ]
 [  0.    11.1    0.  ]
 [  0.     0.   -41.74]]

Matriz [qfi]
[-13.37 -16.63]

Matriz [Hi]
[110.18  55.12]

Matriz [Qi]
[ 13.37   3.37 -16.63]

Matriz [dq]
[0.01 0.01 0.01]


-----Fin iteración:  18  Desbalance de caudales: 14.895401


-----Iteración número:  19 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -3.91  775852 0.01231  23.94  3.89   1847.79
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -4.22  839071 0.01215  27.64  0.00   1569.23
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -4.86  965510 0.01188  35.78  4.82   1740.50
-------------------------------------------------------------------------------------------
Matriz [A]
[[-226.77    0.      0.  ]
 [   0.   -588.13    0.  ]
 [   0.      0.   -265.82]]

Matriz [A1]
[[-226.77    0.      0.  ]
 [   0.   -208.27    0.  ]
 [   0.      0.   -265.82]]

Matriz [qfi]
[ 122.72 -152.72]

Matriz [Hi]
[119.24  67.06]

Matriz [Qi]
[-122.72 -132.72 -152.72]

Matriz [dq]
[-0.14 -0.14 -0.14]


-----Fin iteración:  19  Desbalance de caudales: 136.096087


-----Iteración número:  20 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -1.83  363240 0.01404   5.99  0.85   2071.14
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -2.15  426459 0.01364   8.02  0.00   1761.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -2.78  552898 0.01304  12.87  1.58   1889.77
-------------------------------------------------------------------------------------------
Matriz [A]
[[-119.      0.      0.  ]
 [   0.   -901.      0.  ]
 [   0.      0.   -165.27]]

Matriz [A1]
[[-119.      0.      0.  ]
 [   0.   -118.83    0.  ]
 [   0.      0.   -165.27]]

Matriz [qfi]
[ 57.46 -87.46]

Matriz [Hi]
[111.77  60.9 ]

Matriz [Qi]
[-57.46 -67.46 -87.46]

Matriz [dq]
[0.07 0.07 0.07]


-----Fin iteración:  20  Desbalance de caudales: 65.266600


-----Iteración número:  21 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.76  150962 0.01659   1.22  0.15   2399.62
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -1.08  214182 0.01549   2.30  0.00   2000.30
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.72  340620 0.01421   5.32  0.60   2040.79
-------------------------------------------------------------------------------------------
Matriz [A]
[[  -57.3      0.       0.  ]
 [    0.   -1691.37     0.  ]
 [    0.       0.    -109.96]]

Matriz [A1]
[[ -57.3     0.      0.  ]
 [   0.    -67.77    0.  ]
 [   0.      0.   -109.96]]

Matriz [qfi]
[ 23.88 -53.88]

Matriz [Hi]
[111.15  58.36]

Matriz [Qi]
[-23.88 -33.88 -53.88]

Matriz [dq]
[0.03 0.03 0.03]


-----Fin iteración:  21  Desbalance de caudales: 33.577928


-----Iteración número:  22 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.11   21917 0.02533   0.04  0.00   3528.25
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -0.43   85137 0.01865   0.44  0.00   2407.25
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.07  211576 0.01553   2.25  0.23   2211.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[  -12.23     0.       0.  ]
 [    0.   -4172.41     0.  ]
 [    0.       0.     -74.01]]

Matriz [A1]
[[-12.23   0.     0.  ]
 [  0.   -32.42   0.  ]
 [  0.     0.   -74.01]]

Matriz [qfi]
[  3.47 -33.47]

Matriz [Hi]
[110.97  56.44]

Matriz [Qi]
[ -3.47 -13.47 -33.47]

Matriz [dq]
[0.02 0.02 0.02]


-----Fin iteración:  22  Desbalance de caudales: 20.412200


-----Iteración número:  23 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.39   76875 0.01905   0.36  0.04   2717.97
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.07   13655 0.02849   0.02  0.00   3678.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.57  112784 0.01759   0.72  0.07   2477.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[   33.05     0.       0.  ]
 [    0.   25624.56     0.  ]
 [    0.       0.     -44.2 ]]

Matriz [A1]
[[ 33.05   0.     0.  ]
 [  0.     7.95   0.  ]
 [  0.     0.   -44.2 ]]

Matriz [qfi]
[-12.16 -17.84]

Matriz [Hi]
[110.34  55.16]

Matriz [Qi]
[ 12.16   2.16 -17.84]

Matriz [dq]
[0.02 0.02 0.02]


-----Fin iteración:  23  Desbalance de caudales: 15.626843


-----Iteración número:  24 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   8.03 1595713 0.01099  90.42 16.45   1677.47
  1   2  3   500  200 0.0015  0.0  VR  0.0314   7.72 1532494 0.01106  83.90  0.00   1427.83
  2   3  1   500  200 0.0015  4.0  TA  0.0314   7.08 1406055 0.01120  71.55 10.22   1653.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[423.41   0.     0.  ]
 [  0.   346.12   0.  ]
 [  0.     0.   367.65]]

Matriz [A1]
[[423.41   0.     0.  ]
 [  0.   346.12   0.  ]
 [  0.     0.   367.65]]

Matriz [qfi]
[-252.41  222.41]

Matriz [Hi]
[93.72 34.55]

Matriz [Qi]
[252.41 242.41 222.41]

Matriz [dq]
[0.24 0.24 0.24]


-----Fin iteración:  24  Desbalance de caudales: 240.248628


-----Iteración número:  25 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.99  991018 0.01183  37.54  6.35   1785.75
  1   2  3   500  200 0.0015  0.0  VR  0.0314   4.67  927798 0.01196  33.25  0.00   1543.80
  2   3  1   500  200 0.0015  4.0  TA  0.0314   4.03  801359 0.01225  25.40  3.32   1787.69
-------------------------------------------------------------------------------------------
Matriz [A]
[[279.93   0.     0.  ]
 [  0.   311.75   0.  ]
 [  0.     0.   226.6 ]]

Matriz [A1]
[[279.93   0.     0.  ]
 [  0.   226.57   0.  ]
 [  0.     0.   226.6 ]]

Matriz [qfi]
[-156.76  126.76]

Matriz [Hi]
[84.13 66.44]

Matriz [Qi]
[156.76 146.76 126.76]

Matriz [dq]
[-0.1 -0.1 -0.1]


-----Fin iteración:  25  Desbalance de caudales: 95.650243


-----Iteración número:  26 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.61  717835 0.01247  20.76  3.33   1868.45
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.30  654616 0.01267  17.53  0.00   1635.37
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.66  528177 0.01314  11.84  1.44   1903.14
-------------------------------------------------------------------------------------------
Matriz [A]
[[212.16   0.     0.  ]
 [  0.   425.68   0.  ]
 [  0.     0.   159.  ]]

Matriz [A1]
[[212.16   0.     0.  ]
 [  0.   169.34   0.  ]
 [  0.     0.   159.  ]]

Matriz [qfi]
[-113.55   83.55]

Matriz [Hi]
[90.31 64.14]

Matriz [Qi]
[113.55 103.55  83.55]

Matriz [dq]
[-0.04 -0.04 -0.04]


-----Fin iteración:  26  Desbalance de caudales: 43.211742


-----Iteración número:  27 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.84  563137 0.01300  13.31  2.05   1936.10
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.52  499918 0.01327  10.71  0.00   1712.88
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.88  373479 0.01397   6.30  0.72   2010.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[172.46   0.     0.  ]
 [  0.   589.92   0.  ]
 [  0.     0.   118.77]]

Matriz [A1]
[[172.46   0.     0.  ]
 [  0.   135.45   0.  ]
 [  0.     0.   118.77]]

Matriz [qfi]
[-89.08  59.08]

Matriz [Hi]
[96.29 60.5 ]

Matriz [Qi]
[89.08 79.08 59.08]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  27  Desbalance de caudales: 24.470064


-----Iteración número:  28 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.31  459217 0.01347   9.17  1.36   1996.79
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.99  395998 0.01383   7.00  0.00   1784.96
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.36  269559 0.01483   3.48  0.38   2121.73
-------------------------------------------------------------------------------------------
Matriz [A]
[[145.04   0.     0.  ]
 [  0.   779.22   0.  ]
 [  0.     0.    90.47]]

Matriz [A1]
[[145.04   0.     0.  ]
 [  0.   111.81   0.  ]
 [  0.     0.    90.47]]

Matriz [qfi]
[-72.64  42.64]

Matriz [Hi]
[100.31  58.11]

Matriz [Qi]
[72.64 62.64 42.64]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  28  Desbalance de caudales: 16.437926


-----Iteración número:  29 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.94  384566 0.01390   6.64  0.96   2052.58
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.62  321346 0.01436   4.79  0.00   1853.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.98  194908 0.01578   1.94  0.20   2243.47
-------------------------------------------------------------------------------------------
Matriz [A]
[[124.86   0.     0.  ]
 [  0.   989.26   0.  ]
 [  0.     0.    69.17]]

Matriz [A1]
[[124.86   0.     0.  ]
 [  0.    94.23   0.  ]
 [  0.     0.    69.17]]

Matriz [qfi]
[-60.83  30.83]

Matriz [Hi]
[102.89  56.72]

Matriz [Qi]
[60.83 50.83 30.83]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  29  Desbalance de caudales: 11.808308


-----Iteración número:  30 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.66  329603 0.01429   5.02  0.70   2103.47
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.34  266384 0.01487   3.41  0.00   1919.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.70  139945 0.01684   1.07  0.10   2380.55
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 109.67    0.      0.  ]
 [   0.   1217.      0.  ]
 [   0.      0.     52.7 ]]

Matriz [A1]
[[109.67   0.     0.  ]
 [  0.    80.88   0.  ]
 [  0.     0.    52.7 ]]

Matriz [qfi]
[-52.14  22.14]

Matriz [Hi]
[104.58  55.93]

Matriz [Qi]
[52.14 42.14 22.14]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  30  Desbalance de caudales: 8.693977


-----Iteración número:  31 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.45  288487 0.01465   3.94  0.54   2149.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.13  225268 0.01535   2.52  0.00   1981.12
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.50   98829 0.01807   0.57  0.05   2540.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[  98.08    0.      0.  ]
 [   0.   1458.4     0.  ]
 [   0.      0.     39.71]]

Matriz [A1]
[[98.08  0.    0.  ]
 [ 0.   70.59  0.  ]
 [ 0.    0.   39.71]]

Matriz [qfi]
[-45.63  15.63]

Matriz [Hi]
[105.71  55.48]

Matriz [Qi]
[45.63 35.63 15.63]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  31  Desbalance de caudales: 6.503680


-----Iteración número:  32 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.29  257195 0.01497   3.20  0.43   2190.29
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.98  193975 0.01579   1.92  0.00   2038.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.34   67536 0.01959   0.29  0.02   2735.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[  89.11    0.      0.  ]
 [   0.   1709.59    0.  ]
 [   0.      0.     29.22]]

Matriz [A1]
[[89.11  0.    0.  ]
 [ 0.   62.56  0.  ]
 [ 0.    0.   29.22]]

Matriz [qfi]
[-40.68  10.68]

Matriz [Hi]
[106.5   55.23]

Matriz [Qi]
[40.68 30.68 10.68]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  32  Desbalance de caudales: 4.949814


-----Iteración número:  33 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.17  232864 0.01525   2.67  0.35   2226.88
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.85  169644 0.01621   1.51  0.00   2092.70
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.22   43205 0.02161   0.13  0.01   2996.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[  82.03    0.      0.  ]
 [   0.   1968.17    0.  ]
 [   0.      0.     20.48]]

Matriz [A1]
[[82.03  0.    0.  ]
 [ 0.   56.16  0.  ]
 [ 0.    0.   20.48]]

Matriz [qfi]
[-36.83   6.83]

Matriz [Hi]
[107.06  55.09]

Matriz [Qi]
[36.83 26.83  6.83]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  33  Desbalance de caudales: 3.848670


-----Iteración número:  34 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.07  213429 0.01550   2.28  0.29   2259.86
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.76  150210 0.01660   1.21  0.00   2143.54
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.12   23771 0.02484   0.05  0.00   3413.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[  76.29    0.      0.  ]
 [   0.   2234.34    0.  ]
 [   0.      0.     12.83]]

Matriz [A1]
[[76.29  0.    0.  ]
 [ 0.   50.93  0.  ]
 [ 0.    0.   12.83]]

Matriz [qfi]
[-33.76   3.76]

Matriz [Hi]
[107.48  55.01]

Matriz [Qi]
[33.76 23.76  3.76]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  34  Desbalance de caudales: 3.074161


-----Iteración número:  35 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.99  197361 0.01574   1.98  0.25   2290.19
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.68  134142 0.01698   0.99  0.00   2192.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.04    7703 0.03314   0.01  0.00   4484.93
-------------------------------------------------------------------------------------------
Matriz [A]
[[  71.5     0.      0.  ]
 [   0.   2512.24    0.  ]
 [   0.      0.      5.46]]

Matriz [A1]
[[71.5   0.    0.  ]
 [ 0.   46.52  0.  ]
 [ 0.    0.    5.46]]

Matriz [qfi]
[-31.22   1.22]

Matriz [Hi]
[107.81  54.98]

Matriz [Qi]
[31.22 21.22  1.22]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  35  Desbalance de caudales: 2.541616


-----Iteración número:  36 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.92  183426 0.01596   1.74  0.22   2319.23
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.61  120206 0.01736   0.81  0.00   2241.62
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.03    6233 0.03514   0.00  0.00   4742.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[  67.29    0.      0.  ]
 [   0.   2813.09    0.  ]
 [   0.      0.     -4.68]]

Matriz [A1]
[[67.29  0.    0.  ]
 [ 0.   42.62  0.  ]
 [ 0.    0.   -4.68]]

Matriz [qfi]
[-29.01  -0.99]

Matriz [Hi]
[108.08  54.98]

Matriz [Qi]
[29.01 19.01 -0.99]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  36  Desbalance de caudales: 2.204279


-----Iteración número:  37 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.86  170047 0.01620   1.51  0.19   2349.93
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.54  106828 0.01779   0.66  0.00   2296.30
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.10   19611 0.02602   0.03  0.00   3566.46
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.21    0.      0.  ]
 [   0.   3175.54    0.  ]
 [   0.      0.    -11.06]]

Matriz [A1]
[[ 63.21   0.     0.  ]
 [  0.    38.8    0.  ]
 [  0.     0.   -11.06]]

Matriz [qfi]
[-26.9  -3.1]

Matriz [Hi]
[108.33  55.02]

Matriz [Qi]
[26.9 16.9 -3.1]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  37  Desbalance de caudales: 2.116152


-----Iteración número:  38 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.79  156327 0.01647   1.30  0.16   2384.86
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.47   93108 0.01830   0.51  0.00   2362.57
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.17   33331 0.02293   0.08  0.01   3167.43
-------------------------------------------------------------------------------------------
Matriz [A]
[[  58.97    0.      0.  ]
 [   0.   3655.04    0.  ]
 [   0.      0.    -16.7 ]]

Matriz [A1]
[[ 58.97   0.     0.  ]
 [  0.    34.8    0.  ]
 [  0.     0.   -16.7 ]]

Matriz [qfi]
[-24.73  -5.27]

Matriz [Hi]
[108.57  55.08]

Matriz [Qi]
[24.73 14.73 -5.27]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  38  Desbalance de caudales: 2.170269


-----Iteración número:  39 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.71  140877 0.01682   1.08  0.13   2429.31
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.39   77657 0.01901   0.37  0.00   2454.47
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.25   48782 0.02103   0.16  0.01   2922.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[  54.13    0.      0.  ]
 [   0.   4397.28    0.  ]
 [   0.      0.    -22.55]]

Matriz [A1]
[[ 54.13   0.     0.  ]
 [  0.    30.15   0.  ]
 [  0.     0.   -22.55]]

Matriz [qfi]
[-22.28  -7.72]

Matriz [Hi]
[108.83  55.17]

Matriz [Qi]
[22.28 12.28 -7.72]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  39  Desbalance de caudales: 2.443946


-----Iteración número:  40 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.61  120628 0.01735   0.82  0.09   2498.23
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.29   57408 0.02029   0.22  0.00   2619.65
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.35   69030 0.01950   0.30  0.02   2723.54
-------------------------------------------------------------------------------------------
Matriz [A]
[[  47.67    0.      0.  ]
 [   0.   5973.96    0.  ]
 [   0.      0.    -29.74]]

Matriz [A1]
[[ 47.67   0.     0.  ]
 [  0.    23.79   0.  ]
 [  0.     0.   -29.74]]

Matriz [qfi]
[-19.08 -10.92]

Matriz [Hi]
[109.14  55.32]

Matriz [Qi]
[ 19.08   9.08 -10.92]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  40  Desbalance de caudales: 3.202932

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Qmax-VR.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1    50.00      55.00     5.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    50.00      10.00     1.00 
  3    50.00      20.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  3     500   200  0.0314  0.0015   0.0    VR   5 
  2    3  1     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00   -19.08
  1    50.00      55.00     5.00   -10.92
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    50.00      10.00    1.00    10.00     109.14    59.14
  3    50.00      20.00    1.00    20.00      55.32     5.32
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     0.61   19.08    0.82    0.09    0.91   0.00182 
  1    2  3     0.29    9.08    0.22    0.00    0.22   0.00043 HVR=-54.03
  2    3  1    -0.35  -10.92    0.30    0.02    0.32   0.00065 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:27 2022
crcs-2022
...
 
Procesando archivo N° 12 : ./input/Qmax-VS.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 55.0, 10.0, 20.0]

Matriz [Ho]
[110.  55.]

Matriz [qi]
[10. 20.]

Matriz [B]
[[ 1.  0.]
 [-1.  1.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.18  632194 0.01274  16.45  0.00   1645.05
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 190.33    0.      0.  ]
 [   0.   1146.76    0.  ]
 [   0.      0.    185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.74  147361 0.01667   1.17  0.14   2409.92
  1   2  3   500  200 0.0015  0.0  VS  0.0314   0.42   84142 0.01869   0.43  0.00   2413.21
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.21   42297 0.02172   0.13  0.01   3010.37
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 56.17   0.     0.  ]
 [  0.    32.12   0.  ]
 [  0.     0.   -20.14]]

Matriz [A1]
[[ 56.17   0.     0.  ]
 [  0.    32.12   0.  ]
 [  0.     0.   -20.14]]

Matriz [qfi]
[-23.31  -6.69]

Matriz [Hi]
[120.16  34.01]

Matriz [Qi]
[23.31 13.31 -6.69]

Matriz [dq]
[-0.08 -0.09 -0.11]


-----Fin iteración:   1  Desbalance de caudales: 86.690530


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  13.15 2611537 0.01025 225.83 44.06   1581.58
  1   2  3   500  200 0.0015  0.0  VS  0.0314  12.83 2548318 0.01028 215.74  0.00   1327.78
  2   3  1   500  200 0.0015  4.0  TA  0.0314  12.19 2421879 0.01036 196.22 30.32   1543.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[653.34   0.     0.  ]
 [  0.   865.09   0.  ]
 [  0.     0.   591.34]]

Matriz [A1]
[[653.34   0.     0.  ]
 [  0.   535.21   0.  ]
 [  0.     0.   591.34]]

Matriz [qfi]
[-413.09  383.09]

Matriz [Hi]
[64.9  39.43]

Matriz [Qi]
[413.09 403.09 383.09]

Matriz [dq]
[0.39 0.39 0.39]


-----Fin iteración:   2  Desbalance de caudales: 389.781376


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   6.08 1208309 0.01147  54.08  9.43   1738.75
  1   2  3   500  200 0.0015  0.0  VS  0.0314   5.77 1145089 0.01156  48.98  0.00   1493.00
  2   3  1   500  200 0.0015  4.0  TA  0.0314   5.13 1018650 0.01178  39.49  5.36   1727.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[332.33   0.     0.  ]
 [  0.   270.43   0.  ]
 [  0.     0.   278.34]]

Matriz [A1]
[[332.33   0.     0.  ]
 [  0.   270.43   0.  ]
 [  0.     0.   278.34]]

Matriz [qfi]
[-191.13  161.13]

Matriz [Hi]
[130.14  19.03]

Matriz [Qi]
[191.13 181.13 161.13]

Matriz [dq]
[-0.22 -0.22 -0.22]


-----Fin iteración:   3  Desbalance de caudales: 221.961567


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.24  841129 0.01215  27.77  4.57   1826.81
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.92  777910 0.01231  24.06  0.00   1588.89
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.28  651471 0.01268  17.38  2.19   1843.27
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.06   0.     0.  ]
 [  0.   333.2    0.  ]
 [  0.     0.   189.95]]

Matriz [A1]
[[243.06   0.     0.  ]
 [  0.   195.51   0.  ]
 [  0.     0.   189.95]]

Matriz [qfi]
[-133.05  103.05]

Matriz [Hi]
[85.09 67.52]

Matriz [Qi]
[133.05 123.05 103.05]

Matriz [dq]
[-0.06 -0.06 -0.06]


-----Fin iteración:   4  Desbalance de caudales: 58.080106


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.28  650456 0.01268  17.33  2.73   1895.35
  1   2  3   500  200 0.0015  0.0  VS  0.0314   2.96  587237 0.01290  14.37  0.00   1665.87
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.32  460798 0.01346   9.23  1.10   1944.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[195.01   0.     0.  ]
 [  0.   207.1    0.  ]
 [  0.     0.   141.7 ]]

Matriz [A1]
[[195.01   0.     0.  ]
 [  0.   154.74   0.  ]
 [  0.     0.   141.7 ]]

Matriz [qfi]
[-102.89   72.89]

Matriz [Hi]
[92.32 63.12]

Matriz [Qi]
[102.89  92.89  72.89]

Matriz [dq]
[-0.03 -0.03 -0.03]


-----Fin iteración:   5  Desbalance de caudales: 30.160537


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.45  684994 0.01257  19.05  3.03   1881.13
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.13  621775 0.01278  15.96  0.00   1649.70
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.49  495336 0.01329  10.53  1.27   1922.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[203.82   0.     0.  ]
 [  0.   265.7    0.  ]
 [  0.     0.   150.61]]

Matriz [A1]
[[203.82   0.     0.  ]
 [  0.   162.25   0.  ]
 [  0.     0.   150.61]]

Matriz [qfi]
[-108.35   78.35]

Matriz [Hi]
[87.8  66.88]

Matriz [Qi]
[108.35  98.35  78.35]

Matriz [dq]
[0.01 0.01 0.01]


-----Fin iteración:   6  Desbalance de caudales: 5.463183


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.29  654303 0.01267  17.52  2.77   1893.72
  1   2  3   500  200 0.0015  0.0  VS  0.0314   2.98  591083 0.01289  14.55  0.00   1664.01
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.34  464644 0.01344   9.37  1.12   1941.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[195.99   0.     0.  ]
 [  0.   234.5    0.  ]
 [  0.     0.   142.7 ]]

Matriz [A1]
[[195.99   0.     0.  ]
 [  0.   155.58   0.  ]
 [  0.     0.   142.7 ]]

Matriz [qfi]
[-103.5   73.5]

Matriz [Hi]
[89.89 65.34]

Matriz [Qi]
[103.5  93.5  73.5]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   7  Desbalance de caudales: 4.854767


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.37  669025 0.01262  18.25  2.89   1887.59
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.05  605806 0.01283  15.22  0.00   1657.03
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.41  479367 0.01337   9.92  1.19   1932.07
-------------------------------------------------------------------------------------------
Matriz [A]
[[199.76   0.     0.  ]
 [  0.   250.68   0.  ]
 [  0.     0.   146.5 ]]

Matriz [A1]
[[199.76   0.     0.  ]
 [  0.   158.79   0.  ]
 [  0.     0.   146.5 ]]

Matriz [qfi]
[-105.83   75.83]

Matriz [Hi]
[88.8  66.15]

Matriz [Qi]
[105.83  95.83  75.83]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:   8  Desbalance de caudales: 2.328854


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.33  661081 0.01265  17.85  2.82   1890.87
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.01  597861 0.01286  14.85  0.00   1660.77
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.37  471422 0.01340   9.62  1.15   1937.14
-------------------------------------------------------------------------------------------
Matriz [A]
[[197.73   0.     0.  ]
 [  0.   242.32   0.  ]
 [  0.     0.   144.45]]

Matriz [A1]
[[197.73   0.     0.  ]
 [  0.   157.06   0.  ]
 [  0.     0.   144.45]]

Matriz [qfi]
[-104.57   74.57]

Matriz [Hi]
[89.36 65.74]

Matriz [Qi]
[104.57  94.57  74.57]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   9  Desbalance de caudales: 1.256694


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.35  665106 0.01263  18.05  2.86   1889.20
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.03  601887 0.01285  15.04  0.00   1658.87
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  475448 0.01338   9.77  1.17   1934.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.76   0.     0.  ]
 [  0.   246.65   0.  ]
 [  0.     0.   145.49]]

Matriz [A1]
[[198.76   0.     0.  ]
 [  0.   157.93   0.  ]
 [  0.     0.   145.49]]

Matriz [qfi]
[-105.21   75.21]

Matriz [Hi]
[89.07 65.96]

Matriz [Qi]
[105.21  95.21  75.21]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:  10  Desbalance de caudales: 0.636728


-----Iteración número:  11 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663002 0.01264  17.95  2.84   1890.07
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  599782 0.01286  14.94  0.00   1659.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.38  473343 0.01339   9.69  1.16   1935.91
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.22   0.     0.  ]
 [  0.   244.41   0.  ]
 [  0.     0.   144.95]]

Matriz [A1]
[[198.22   0.     0.  ]
 [  0.   157.48   0.  ]
 [  0.     0.   144.95]]

Matriz [qfi]
[-104.87   74.87]

Matriz [Hi]
[89.22 65.84]

Matriz [Qi]
[104.87  94.87  74.87]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  11  Desbalance de caudales: 0.332856


-----Iteración número:  12 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  664084 0.01264  18.00  2.85   1889.62
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.03  600864 0.01285  14.99  0.00   1659.35
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474426 0.01339   9.74  1.16   1935.21
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.49   0.     0.  ]
 [  0.   245.57   0.  ]
 [  0.     0.   145.23]]

Matriz [A1]
[[198.49   0.     0.  ]
 [  0.   157.71   0.  ]
 [  0.     0.   145.23]]

Matriz [qfi]
[-105.04   75.04]

Matriz [Hi]
[89.14 65.9 ]

Matriz [Qi]
[105.04  95.04  75.04]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:  12  Desbalance de caudales: 0.171158


-----Iteración número:  13 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663523 0.01264  17.97  2.84   1889.86
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600303 0.01285  14.96  0.00   1659.61
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  473864 0.01339   9.71  1.16   1935.57
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.35   0.     0.  ]
 [  0.   244.97   0.  ]
 [  0.     0.   145.08]]

Matriz [A1]
[[198.35   0.     0.  ]
 [  0.   157.59   0.  ]
 [  0.     0.   145.08]]

Matriz [qfi]
[-104.96   74.96]

Matriz [Hi]
[89.18 65.87]

Matriz [Qi]
[104.96  94.96  74.96]

Matriz [dq]
[-8.88e-05 -8.88e-05 -8.88e-05]


-----Fin iteración:  13  Desbalance de caudales: 0.088758


-----Iteración número:  14 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663812 0.01264  17.99  2.85   1889.74
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600593 0.01285  14.98  0.00   1659.48
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474154 0.01339   9.72  1.16   1935.39
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.42   0.     0.  ]
 [  0.   245.28   0.  ]
 [  0.     0.   145.16]]

Matriz [A1]
[[198.42   0.     0.  ]
 [  0.   157.65   0.  ]
 [  0.     0.   145.16]]

Matriz [qfi]
[-105.   75.]

Matriz [Hi]
[89.16 65.89]

Matriz [Qi]
[105.  95.  75.]

Matriz [dq]
[4.58e-05 4.58e-05 4.58e-05]


-----Fin iteración:  14  Desbalance de caudales: 0.045826


-----Iteración número:  15 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663663 0.01264  17.98  2.85   1889.80
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600443 0.01285  14.97  0.00   1659.55
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474004 0.01339   9.72  1.16   1935.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.39   0.     0.  ]
 [  0.   245.12   0.  ]
 [  0.     0.   145.12]]

Matriz [A1]
[[198.39   0.     0.  ]
 [  0.   157.62   0.  ]
 [  0.     0.   145.12]]

Matriz [qfi]
[-104.98   74.98]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.98  94.98  74.98]

Matriz [dq]
[-2.37e-05 -2.37e-05 -2.37e-05]


-----Fin iteración:  15  Desbalance de caudales: 0.023714


-----Iteración número:  16 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663740 0.01264  17.98  2.85   1889.77
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600521 0.01285  14.97  0.00   1659.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474082 0.01339   9.72  1.16   1935.43
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.41   0.     0.  ]
 [  0.   245.2    0.  ]
 [  0.     0.   145.14]]

Matriz [A1]
[[198.41   0.     0.  ]
 [  0.   157.64   0.  ]
 [  0.     0.   145.14]]

Matriz [qfi]
[-104.99   74.99]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.99  94.99  74.99]

Matriz [dq]
[1.23e-05 1.23e-05 1.23e-05]


-----Fin iteración:  16  Desbalance de caudales: 0.012257


-----Iteración número:  17 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663700 0.01264  17.98  2.85   1889.78
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600480 0.01285  14.97  0.00   1659.53
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474042 0.01339   9.72  1.16   1935.46
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.4    0.     0.  ]
 [  0.   245.16   0.  ]
 [  0.     0.   145.13]]

Matriz [A1]
[[198.4    0.     0.  ]
 [  0.   157.63   0.  ]
 [  0.     0.   145.13]]

Matriz [qfi]
[-104.98   74.98]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.98  94.98  74.98]

Matriz [dq]
[-6.34e-06 -6.34e-06 -6.34e-06]


-----Fin iteración:  17  Desbalance de caudales: 0.006339

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Qmax-VS.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1    50.00      55.00     5.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    50.00      10.00     1.00 
  3    50.00      20.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  3     500   200  0.0314  0.0015   0.0    VS   40 
  2    3  1     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -104.98
  1    50.00      55.00     5.00    74.98
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    50.00      10.00    1.00    10.00      89.17    39.17
  3    50.00      20.00    1.00    20.00      65.88    15.88
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     3.34  104.98   17.98    2.85   20.83   0.04166 
  1    2  3     3.02   94.98   14.97    0.00   14.97   0.02994 HVS=-8.31
  2    3  1     2.39   74.98    9.72    1.16   10.88   0.02176 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:28 2022
crcs-2022
...
 
Procesando archivo N° 13 : ./input/Red-mixta.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[120.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 8.0, 7.0]

Matriz [Ho]
[120.]

Matriz [qi]
[10. 10. 10. 10. 10. 10.  8.  7.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.  0.]
 [ 0. -1.  1.  0.  0.  0.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  1.  0.  0.  0.]
 [ 0.  0.  0.  0. -1.  1.  0.  0.]
 [ 0.  0.  0.  0.  0. -1.  0.  1.]
 [ 0.  0.  0.  0.  0. -1.  1.  0.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   3.18  632194 0.01274   6.58  1.55    812.95
  1   1  2   500  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  66.35  4.90   7124.26
  2   1  4   300  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  39.81  4.90   4470.41
  3   2  3   300  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 286.88 24.79  31167.22
  4   4  3   500  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 478.14 24.79  50292.83
  5   2  5   200  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  26.54  4.90   3143.49
  6   5  6   250  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  33.17  4.90   3806.95
  7   6  8   150  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 143.44 24.79  16823.01
  8   6  7   150   75 0.0015 10.0  TA  0.0044  22.64 1685852 0.01126 588.22 261.14  84936.36
-------------------------------------------------------------------------------------------

Matriz [A]
[[  81.29    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    712.43    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    447.04    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   3116.72    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   5029.28    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    314.35    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    380.69    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.   1682.3     0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.   8493.64]]

Matriz [A1]
[[  81.29    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    712.43    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    447.04    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   3116.72    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   5029.28    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    314.35    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    380.69    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.   1682.3     0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.   8493.64]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.21  329329 0.01432  11.89  0.75   8281.79
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.47  218573 0.01546   3.39  0.33   5534.61
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.76   74982 0.01919   1.67  0.09  50041.89
  4   4  3   500  100 0.0015  3.0  TA  0.0079   2.03  201421 0.01574  16.50  0.63  67500.64
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    323.57    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    143.51    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -296.76    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1075.31    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    323.57    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    143.51    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -296.76    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1075.31    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.94 131.51 480.15 137.46 140.94 159.97 873.44 304.65]

Matriz [Qi]
[75.   39.07 25.93 -5.93 15.93 35.   25.    7.    8.  ]

Matriz [dq]
[-0.02 -0.06 -0.07 -0.11 -0.08 -0.06 -0.07 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 105.930309


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.36  351152 0.01416  13.37  0.85   8191.98
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.32  196750 0.01577   2.80  0.27   5636.96
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.43   42248 0.02175   0.60  0.03  56387.26
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.70  168686 0.01628  11.97  0.44  69746.77
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    341.27    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    131.57    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -188.41    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    930.52    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    341.27    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    131.57    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -188.41    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    930.52    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.92 100.7  112.26  96.43  93.47  86.11  92.23]

Matriz [Qi]
[75.   41.66 23.34 -3.34 13.34 35.   25.    7.    8.  ]

Matriz [dq]
[-4.30e-16  2.59e-03 -2.59e-03  2.59e-03 -2.59e-03 -5.55e-17 -9.02e-17 -5.20e-18 -1.39e-17]


-----Fin iteración:   2  Desbalance de caudales: 2.588970


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353369 0.01414  13.52  0.86   8183.26
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.31  194533 0.01580   2.75  0.26   5648.18
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38922 0.02215   0.52  0.02  57395.94
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.67  165360 0.01635  11.55  0.42  70006.77
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.06    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.35    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -176.68    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    915.57    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.06    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.35    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -176.68    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    915.57    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.4   86.03  92.15]

Matriz [Qi]
[75.   41.92 23.08 -3.08 13.08 35.   25.    7.    8.  ]

Matriz [dq]
[ 1.94e-16  2.63e-04 -2.63e-04  2.63e-04 -2.63e-04 -2.22e-16 -6.59e-17 -7.89e-17 -1.73e-18]


-----Fin iteración:   3  Desbalance de caudales: 0.263048


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353567 0.01414  13.53  0.86   8182.48
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.30  194335 0.01581   2.74  0.26   5649.19
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38625 0.02219   0.51  0.02  57491.60
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.66  165063 0.01635  11.51  0.42  70030.32
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.22    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.24    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.63    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.23    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.22    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.24    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.63    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.23    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.39  86.03  92.15]

Matriz [Qi]
[75.   41.95 23.05 -3.05 13.05 35.   25.    7.    8.  ]

Matriz [dq]
[ 3.47e-16  2.35e-05 -2.35e-05  2.35e-05 -2.35e-05  2.50e-16  2.36e-16  1.12e-16  1.56e-17]


-----Fin iteración:   4  Desbalance de caudales: 0.023493


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353584 0.01414  13.54  0.86   8182.42
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.30  194317 0.01581   2.74  0.26   5649.28
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38598 0.02220   0.51  0.02  57500.09
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.66  165037 0.01635  11.51  0.42  70032.40
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.23    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.23    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.53    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.11    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.23    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.23    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.53    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.11    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.39  86.03  92.15]

Matriz [Qi]
[75.   41.95 23.05 -3.05 13.05 35.   25.    7.    8.  ]

Matriz [dq]
[-2.08e-16  2.07e-06 -2.07e-06  2.07e-06 -2.07e-06 -1.39e-16 -4.16e-17 -2.95e-17 -1.39e-17]


-----Fin iteración:   5  Desbalance de caudales: 0.002074

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Red-mixta.mgh.json
Titulo:      Red de pruebas mixta (cerrada y abierta)
Autor:       Carlos Camacho Soto
Fecha:       6 set 2022
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   110.00     120.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    90.00      10.00     1.00 
  2    85.00      10.00     1.00 
  3    85.00      10.00     1.00 
  4    85.00      10.00     1.00 
  5    80.00      10.00     1.00 
  6    75.00      10.00     1.00 
  7    75.00       8.00     1.00 
  8    70.00       7.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     200   200  0.0314  0.0015   3.0    TA   - 
  1    1  2     500   150  0.0177  0.0015   3.0    TA   - 
  2    1  4     300   150  0.0177  0.0015   3.0    TA   - 
  3    2  3     300   100  0.0079  0.0015   3.0    TA   - 
  4    4  3     500   100  0.0079  0.0015   3.0    TA   - 
  5    2  5     200   150  0.0177  0.0015   3.0    TA   - 
  6    5  6     250   150  0.0177  0.0015   3.0    TA   - 
  7    6  8     150   100  0.0079  0.0015   3.0    TA   - 
  8    6  7     150    75  0.0044  0.0015  10.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   110.00     120.00    10.00   -75.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    90.00      10.00    1.00    10.00     115.24    25.24
  2    85.00      10.00    1.00    10.00     100.84    15.84
  3    85.00      10.00    1.00    10.00     100.31    15.31
  4    85.00      10.00    1.00    10.00     112.24    27.24
  5    80.00      10.00    1.00    10.00      96.35    16.35
  6    75.00      10.00    1.00    10.00      93.39    18.39
  7    75.00       8.00    1.00     8.00      86.03    11.03
  8    70.00       7.00    1.00     7.00      92.15    22.15
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     2.39   75.00    3.89    0.87    4.76   0.02381 
  1    1  2     2.37   41.95   13.54    0.86   14.40   0.02880 
  2    1  4     1.30   23.05    2.74    0.26    3.00   0.01001 
  3    2  3    -0.39   -3.05    0.51    0.02    0.54   0.00179 
  4    4  3     1.66   13.05   11.51    0.42   11.93   0.02386 
  5    2  5     1.98   35.00    3.90    0.60    4.50   0.02248 
  6    5  6     1.41   25.00    2.65    0.31    2.95   0.01181 
  7    6  8     0.89    7.00    1.13    0.12    1.25   0.00831 
  8    6  7     1.81    8.00    5.70    1.67    7.37   0.04912 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Sun Sep 11 15:12:28 2022
crcs-2022
...
 
MGH
Procesamiento de varias redes por lotes
---------------------------------------
 
Procesando archivo N° 1 : ./input/CaudalMax-kL.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 100.0, 0.0]

Matriz [Ho]
[110. 100.]

Matriz [qi]
[0.]

Matriz [B]
[[ 1.]
 [-1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   0.51  252878 0.01582   0.08  0.07     14.97
  1   2  1   200  500 0.0500  5.0  TA  0.1963   0.51  252878 0.01582   0.08  0.07     14.97
-------------------------------------------------------------------------------------------

Matriz [A]
[[1.5 0. ]
 [0.  1.5]]

Matriz [A1]
[[1.5 0. ]
 [0.  1.5]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   8.76 4348199 0.01246  19.48 19.54     13.20
  1   2  1   200  500 0.0500  5.0  TA  0.1963   8.76 4348199 0.01246  19.48 19.54     13.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[22.69  0.  ]
 [ 0.   22.69]]

Matriz [A1]
[[22.69  0.  ]
 [ 0.   22.69]]

Matriz [qfi]
[-1719.49  1719.49]

Matriz [Hi]
[105.]

Matriz [Qi]
[1719.49 1719.49]

Matriz [dq]
[1.62 1.62]


-----Fin iteración:   1  Desbalance de caudales: 1619.486607


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   4.94 2452693 0.01274   6.34  6.22     13.35
  1   2  1   200  500 0.0500  5.0  TA  0.1963   4.94 2452693 0.01274   6.34  6.22     13.35
-------------------------------------------------------------------------------------------
Matriz [A]
[[12.95  0.  ]
 [ 0.   12.95]]

Matriz [A1]
[[12.95  0.  ]
 [ 0.   12.95]]

Matriz [qfi]
[-969.91  969.91]

Matriz [Hi]
[105.]

Matriz [Qi]
[969.91 969.91]

Matriz [dq]
[-0.75 -0.75]


-----Fin iteración:   2  Desbalance de caudales: 749.573990


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.45 1714629 0.01299   3.16  3.04     13.48
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.45 1714629 0.01299   3.16  3.04     13.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[9.14 0.  ]
 [0.   9.14]]

Matriz [A1]
[[9.14 0.  ]
 [0.   9.14]]

Matriz [qfi]
[-678.05  678.05]

Matriz [Hi]
[105.]

Matriz [Qi]
[678.05 678.05]

Matriz [dq]
[-0.29 -0.29]


-----Fin iteración:   3  Desbalance de caudales: 291.866013


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.12 1548899 0.01308   2.59  2.48     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.12 1548899 0.01308   2.59  2.48     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.28 0.  ]
 [0.   8.28]]

Matriz [A1]
[[8.28 0.  ]
 [0.   8.28]]

Matriz [qfi]
[-612.51  612.51]

Matriz [Hi]
[105.]

Matriz [Qi]
[612.51 612.51]

Matriz [dq]
[-0.07 -0.07]


-----Fin iteración:   4  Desbalance de caudales: 65.537641


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537535 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537535 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.23 0.  ]
 [0.   8.23]]

Matriz [A1]
[[8.23 0.  ]
 [0.   8.23]]

Matriz [qfi]
[-608.02  608.02]

Matriz [Hi]
[105.]

Matriz [Qi]
[608.02 608.02]

Matriz [dq]
[-0. -0.]


-----Fin iteración:   5  Desbalance de caudales: 4.493701


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537305 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537305 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [A1]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [qfi]
[-607.92  607.92]

Matriz [Hi]
[105.]

Matriz [Qi]
[607.92 607.92]

Matriz [dq]
[-9.11e-05 -9.11e-05]


-----Fin iteración:   6  Desbalance de caudales: 0.091089


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  5.0  TA  0.1963   3.10 1537301 0.01308   2.56  2.44     13.53
  1   2  1   200  500 0.0500  5.0  TA  0.1963   3.10 1537301 0.01308   2.56  2.44     13.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [A1]
[[8.22 0.  ]
 [0.   8.22]]

Matriz [qfi]
[-607.92  607.92]

Matriz [Hi]
[105.]

Matriz [Qi]
[607.92 607.92]

Matriz [dq]
[-1.53e-06 -1.53e-06]


-----Fin iteración:   7  Desbalance de caudales: 0.001526

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/CaudalMax-kL.mgh.json
Titulo:      Calculo de caudal maximo
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1   100.00     100.00     0.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2   100.00       0.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     200   500  0.1963  0.0500   5.0    TA   - 
  1    2  1     200   500  0.1963  0.0500   5.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -607.92
  1   100.00     100.00     0.00   607.92
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2   100.00       0.00    1.00     0.00     105.00     5.00
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     3.10  607.92    2.56    2.44    5.00   0.02500 
  1    2  1     3.10  607.92    2.56    2.44    5.00   0.02500 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:00 2022
crcs-2022
...
 
Procesando archivo N° 2 : ./input/CaudalMax.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 100.0, 0.0]

Matriz [Ho]
[110. 100.]

Matriz [qi]
[0.]

Matriz [B]
[[ 1.]
 [-1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   0.51  252878 0.01582   0.08  0.00      8.36
  1   2  1   200  500 0.0500  0.0  TA  0.1963   0.51  252878 0.01582   0.08  0.00      8.36
-------------------------------------------------------------------------------------------

Matriz [A]
[[0.84 0.  ]
 [0.   0.84]]

Matriz [A1]
[[0.84 0.  ]
 [0.   0.84]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963  15.48 7684491 0.01227  59.93  0.00      6.49
  1   2  1   200  500 0.0500  0.0  TA  0.1963  15.48 7684491 0.01227  59.93  0.00      6.49
-------------------------------------------------------------------------------------------
Matriz [A]
[[19.72  0.  ]
 [ 0.   19.72]]

Matriz [A1]
[[19.72  0.  ]
 [ 0.   19.72]]

Matriz [qfi]
[-3038.82  3038.82]

Matriz [Hi]
[105.]

Matriz [Qi]
[3038.82 3038.82]

Matriz [dq]
[2.94 2.94]


-----Fin iteración:   1  Desbalance de caudales: 2938.816506


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   8.38 4162785 0.01247  17.88  0.00      6.60
  1   2  1   200  500 0.0500  0.0  TA  0.1963   8.38 4162785 0.01247  17.88  0.00      6.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[10.86  0.  ]
 [ 0.   10.86]]

Matriz [A1]
[[10.86  0.  ]
 [ 0.   10.86]]

Matriz [qfi]
[-1646.16  1646.16]

Matriz [Hi]
[105.]

Matriz [Qi]
[1646.16 1646.16]

Matriz [dq]
[-1.39 -1.39]


-----Fin iteración:   2  Desbalance de caudales: 1392.651570


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   5.36 2663592 0.01269   7.45  0.00      6.71
  1   2  1   200  500 0.0500  0.0  TA  0.1963   5.36 2663592 0.01269   7.45  0.00      6.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[7.07 0.  ]
 [0.   7.07]]

Matriz [A1]
[[7.07 0.  ]
 [0.   7.07]]

Matriz [qfi]
[-1053.31  1053.31]

Matriz [Hi]
[105.]

Matriz [Qi]
[1053.31 1053.31]

Matriz [dq]
[-0.59 -0.59]


-----Fin iteración:   3  Desbalance de caudales: 592.852962


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.48 2225914 0.01281   5.25  0.00      6.77
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.48 2225914 0.01281   5.25  0.00      6.77
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.96 0.  ]
 [0.   5.96]]

Matriz [A1]
[[5.96 0.  ]
 [0.   5.96]]

Matriz [qfi]
[-880.23  880.23]

Matriz [Hi]
[105.]

Matriz [Qi]
[880.23 880.23]

Matriz [dq]
[-0.17 -0.17]


-----Fin iteración:   4  Desbalance de caudales: 173.078834


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.38 2173593 0.01282   5.01  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.38 2173593 0.01282   5.01  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.83 0.  ]
 [0.   5.83]]

Matriz [A1]
[[5.83 0.  ]
 [0.   5.83]]

Matriz [qfi]
[-859.54  859.54]

Matriz [Hi]
[105.]

Matriz [Qi]
[859.54 859.54]

Matriz [dq]
[-0.02 -0.02]


-----Fin iteración:   5  Desbalance de caudales: 20.690251


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171621 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171621 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.76  858.76]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.76 858.76]

Matriz [dq]
[-0. -0.]


-----Fin iteración:   6  Desbalance de caudales: 0.779811


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171568 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171568 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.74  858.74]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.74 858.74]

Matriz [dq]
[-2.08e-05 -2.08e-05]


-----Fin iteración:   7  Desbalance de caudales: 0.020780


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   200  500 0.0500  0.0  TA  0.1963   4.37 2171567 0.01282   5.00  0.00      6.78
  1   2  1   200  500 0.0500  0.0  TA  0.1963   4.37 2171567 0.01282   5.00  0.00      6.78
-------------------------------------------------------------------------------------------
Matriz [A]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [A1]
[[5.82 0.  ]
 [0.   5.82]]

Matriz [qfi]
[-858.74  858.74]

Matriz [Hi]
[105.]

Matriz [Qi]
[858.74 858.74]

Matriz [dq]
[-5.45e-07 -5.45e-07]


-----Fin iteración:   8  Desbalance de caudales: 0.000545

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/CaudalMax.mgh.json
Titulo:      Calculo de caudal maximo
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1   100.00     100.00     0.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2   100.00       0.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     200   500  0.1963  0.0500   0.0    TA   - 
  1    2  1     200   500  0.1963  0.0500   0.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -858.74
  1   100.00     100.00     0.00   858.74
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2   100.00       0.00    1.00     0.00     105.00     5.00
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     4.37  858.74    5.00    0.00    5.00   0.02500 
  1    2  1     4.37  858.74    5.00    0.00    5.00   0.02500 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:00 2022
crcs-2022
...
 
Procesando archivo N° 3 : ./input/default-error-topol.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
--
MÉTODO DEL GRADIENTE HIDRÁULICO
--
Archivo de entrada: ./input/default-error-topol.mgh.json
Titulo:      Archivo de prueba para error en topologia nudo-tramo
Autor:       Ing. Carlos Camacho
Fecha:       28/01/2019
Versión:     V0.01
--
Error en la topología de nudos y tramos: nudos sin conexión
Revise los siguientes nudos:  [2]
--
...
 
Procesando archivo N° 4 : ./input/default.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110, 60, -40, 30, 30, 40]

Matriz [Ho]
[110.]

Matriz [qi]
[ 60. -40.  30.  30.  40.]

Matriz [B]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]

Matriz [C]
[[0.]
 [0.]
 [0.]
 [0.]
 [0.]
 [0.]
 [0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   500  250 0.0015  0.0  TA  0.0491   2.04  505756 0.01316   5.57  0.00    556.81
  1   1  2   400  150 0.0015 10.0  TA  0.0177   5.66  842926 0.01217  52.97 16.32   6928.99
  2   3  2   200  100 0.0015  0.0  TA  0.0079  12.73 1264389 0.01158 191.34  0.00  19133.53
  3   4  3   400  150 0.0015  0.0  TA  0.0177   5.66  842926 0.01217  52.97  0.00   5296.86
  4   1  4   200  100 0.0015  0.0  TA  0.0079  12.73 1264389 0.01158 191.34  0.00  19133.53
  5   5  4   600  200 0.0015  0.0  TA  0.0314   3.18  632194 0.01270  19.67  0.00   1967.29
  6   0  5   300  250 0.0015  0.0  TA  0.0491   2.04  505756 0.01316   3.34  0.00    334.08
-------------------------------------------------------------------------------------------

Matriz [A]
[[  55.68    0.      0.      0.      0.      0.      0.  ]
 [   0.    692.9     0.      0.      0.      0.      0.  ]
 [   0.      0.   1913.35    0.      0.      0.      0.  ]
 [   0.      0.      0.    529.69    0.      0.      0.  ]
 [   0.      0.      0.      0.   1913.35    0.      0.  ]
 [   0.      0.      0.      0.      0.    196.73    0.  ]
 [   0.      0.      0.      0.      0.      0.     33.41]]

Matriz [A1]
[[  55.68    0.      0.      0.      0.      0.      0.  ]
 [   0.    692.9     0.      0.      0.      0.      0.  ]
 [   0.      0.   1913.35    0.      0.      0.      0.  ]
 [   0.      0.      0.    529.69    0.      0.      0.  ]
 [   0.      0.      0.      0.   1913.35    0.      0.  ]
 [   0.      0.      0.      0.      0.    196.73    0.  ]
 [   0.      0.      0.      0.      0.      0.     33.41]]

----Inician las iteraciones----

...
 
Procesando archivo N° 5 : ./input/EjemploBomba.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 10.0, 10.0, 15.0, 15.0, 10.0, 10.0, 15.0, 15.0]

Matriz [Ho]
[100.]

Matriz [qi]
[15.  15.  22.5 22.5 15.  15.  22.5 22.5]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  0.  1.  0.  0.  0.  0.  0.]
 [ 0.  0. -1.  1.  0.  0.  0.  0.]
 [ 0.  0.  0.  0. -1.  1.  0.  0.]
 [ 0.  0.  0.  0. -1.  0.  1.  0.]
 [ 0.  0.  0.  0.  0.  0. -1.  1.]
 [ 0.  0.  0.  0.  0. -1.  0.  1.]
 [-1.  1.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  0.  1.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  1.  0.  0.  0.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   1.41  421463 0.01544   0.53  0.00     52.52
  1   1  3    75  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  13.19  0.00   1319.07
  2   3  4   100  150 0.0500  4.0  TA  0.0177   5.66  842926 0.01616  17.59  6.53   2411.61
  3   5  6   100  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  17.59  0.00   1758.76
  4   5  7    75  100 0.0500  0.0  TA  0.0079  12.73 1264389 0.01719 106.53  0.00  10653.05
  5   7  8   100  100 0.0500  4.0  TA  0.0079  12.73 1264389 0.01719 142.04 33.05  17509.15
  6   6  8    75  100 0.0500  0.0  TA  0.0079  12.73 1264389 0.01719 106.53  0.00  10653.05
  7   1  2   100  200 0.0500  0.0  TA  0.0314   3.18  632194 0.01570   4.05  0.00    405.27
  8   2  4    75  150 0.0500  0.0  TA  0.0177   5.66  842926 0.01616  13.19  0.00   1319.07
  9   2  5   100  150 0.0500  2.0  BO  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
-------------------------------------------------------------------------------------------

Matriz [A]
[[   5.25    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    131.91    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    241.16    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.    175.88    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1065.31    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.   1750.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.   1065.31    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     40.53    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    131.91    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -441.48]]

Matriz [A1]
[[   5.25    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    131.91    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    241.16    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.    175.88    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1065.31    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.   1750.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.   1065.31    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     40.53    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    131.91    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.    208.52]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.79  415123 0.01685   3.33  0.00   1374.75
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.51  225465 0.01777   1.38  0.47   2586.20
  3   5  6   100  150 0.0500  0.0  TA  0.0177   0.93  138788 0.01879   0.55  0.00   2044.78
  4   5  7    75  100 0.0500  0.0  TA  0.0079   5.54  550451 0.01769  20.78  0.00  10965.13
  5   7  8   100  100 0.0500  4.0  TA  0.0079   2.68  265964 0.01849   6.76  1.46  18583.66
  6   6  8    75  100 0.0500  0.0  TA  0.0079   0.19   18524 0.02748   0.04  0.00  17027.52
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.73  542120 0.01586   3.01  0.00    409.63
  8   2  4    75  150 0.0500  0.0  TA  0.0177  -0.24   35806 0.02350   0.03  0.00   1917.83
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     67.7     0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     69.18    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     33.67    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    477.37    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    390.91    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.     24.95    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     35.13    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.     -8.15    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    67.7    0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    69.18   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    33.67   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   477.37   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.   390.91   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.    24.95   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    35.13   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.    -8.15   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.95  96.05  99.15 110.36 150.63 162.42 164.4  265.83]

Matriz [Qi]
[150.    49.25  26.75  16.47  43.53  21.03   1.47  85.75  -4.25  75.  ]

Matriz [dq]
[ 0.05 -0.05 -0.07 -0.08 -0.06 -0.08 -0.1  -0.01 -0.1  -0.02]


-----Fin iteración:   1  Desbalance de caudales: 98.534964


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.42  360137 0.01703   2.54  0.00   1389.68
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.14  170478 0.01832   0.82  0.27   2646.55
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.80  267989 0.01747   1.92  0.00   1900.84
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.59  356650 0.01812   8.93  0.00  11227.90
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.73   72163 0.02135   0.57  0.11  20947.00
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.14  212325 0.01883   3.29  0.00  11671.14
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.94  583360 0.01578   3.47  0.00    407.49
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.13   19180 0.02688   0.01  0.00   2193.95
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     59.37    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     53.53    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     60.43    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    316.71    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    119.55    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    195.99    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.6     0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      4.99    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    59.37   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    53.53   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    60.43   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   316.71   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.   119.55   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   195.99   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.6    0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     4.99   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.39  96.41  95.46 157.5  155.92 151.35 155.11]

Matriz [Qi]
[150.    42.72  20.22  31.79  28.21   5.71  16.79  92.28   2.28  75.  ]

Matriz [dq]
[ 3.55e-15 -6.52e-03 -6.52e-03  1.53e-02 -1.53e-02 -1.53e-02  1.53e-02  6.52e-03  6.52e-03 -7.49e-16]


-----Fin iteración:   2  Desbalance de caudales: 15.327639


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356391 0.01704   2.49  0.00   1390.84
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166733 0.01837   0.78  0.26   2651.79
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.98  294781 0.01732   2.30  0.00   1884.37
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.19  316462 0.01826   7.09  0.00  11316.28
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.32   31975 0.02453   0.13  0.02  23569.91
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.54  252513 0.01857   4.59  0.00  11504.98
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586169 0.01578   3.50  0.00    407.36
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.15   22926 0.02582   0.02  0.00   2107.18
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.81    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.45    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     65.9     0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    283.23    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     59.61    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    229.77    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.77    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.73    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.81   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.45   0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    65.9    0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   283.23   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    59.61   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   229.77   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.77   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.73   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.16 150.55 150.63]

Matriz [Qi]
[150.    42.28  19.78  34.97  25.03   2.53  19.97  92.72   2.72  75.  ]

Matriz [dq]
[-1.72e-15 -4.44e-04 -4.44e-04  3.18e-03 -3.18e-03 -3.18e-03  3.18e-03  4.44e-04  4.44e-04  6.38e-16]


-----Fin iteración:   3  Desbalance de caudales: 3.178454


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356222 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166563 0.01837   0.78  0.25   2652.03
  3   5  6   100  150 0.0500  0.0  TA  0.0177   1.99  297068 0.01731   2.34  0.00   1883.08
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  313032 0.01827   6.94  0.00  11324.72
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28544 0.02508   0.11  0.02  24026.71
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  255943 0.01855   4.71  0.00  11492.85
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586296 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23095 0.02578   0.02  0.00   2103.74
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.36    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.37    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     54.24    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.64    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.76    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.36   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.37   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    54.24   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.64   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.76   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.42]

Matriz [Qi]
[150.    42.26  19.76  35.24  24.76   2.26  20.24  92.74   2.74  75.  ]

Matriz [dq]
[ 2.72e-15 -2.01e-05 -2.01e-05  2.71e-04 -2.71e-04 -2.71e-04  2.71e-04  2.01e-05  2.01e-05  4.72e-16]


-----Fin iteración:   4  Desbalance de caudales: 0.271324


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356215 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166556 0.01837   0.78  0.25   2652.04
  3   5  6   100  150 0.0500  0.0  TA  0.0177   2.00  297172 0.01731   2.34  0.00   1883.02
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  312875 0.01828   6.93  0.00  11325.11
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28388 0.02511   0.10  0.02  24049.44
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  256100 0.01854   4.71  0.00  11492.31
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586302 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23102 0.02578   0.02  0.00   2103.60
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.39    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.24    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     54.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.77    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.77    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.39   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.24   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    54.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.77   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.77   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.41]

Matriz [Qi]
[150.    42.26  19.76  35.25  24.75   2.25  20.25  92.74   2.74  75.  ]

Matriz [dq]
[-1.78e-15 -8.63e-07 -8.63e-07  1.24e-05 -1.24e-05 -1.24e-05  1.24e-05  8.63e-07  8.63e-07 -1.08e-15]


-----Fin iteración:   5  Desbalance de caudales: 0.012357


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  300 0.0500  0.0  TA  0.0707   2.12  632194 0.01488   1.14  0.00     50.59
  1   1  3    75  150 0.0500  0.0  TA  0.0177   2.39  356214 0.01704   2.48  0.00   1390.89
  2   3  4   100  150 0.0500  4.0  TA  0.0177   1.12  166556 0.01837   0.78  0.25   2652.04
  3   5  6   100  150 0.0500  0.0  TA  0.0177   2.00  297176 0.01731   2.34  0.00   1883.02
  4   5  7    75  100 0.0500  0.0  TA  0.0079   3.15  312869 0.01828   6.93  0.00  11325.12
  5   7  8   100  100 0.0500  4.0  TA  0.0079   0.29   28381 0.02511   0.10  0.02  24050.39
  6   6  8    75  100 0.0500  0.0  TA  0.0079   2.58  256106 0.01854   4.72  0.00  11492.28
  7   1  2   100  200 0.0500  0.0  TA  0.0314   2.95  586302 0.01578   3.50  0.00    407.35
  8   2  4    75  150 0.0500  0.0  TA  0.0177   0.16   23102 0.02578   0.02  0.00   2103.59
  9   2  5   100  150 0.0500  2.0  BO  0.0177   4.24  632194 0.01640  10.04  1.84   2110.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[   7.59    0.      0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.     58.78    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.     52.4     0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.     66.39    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    280.24    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.     53.99    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    232.78    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.     37.78    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      5.77    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.      0.   -828.15]]

Matriz [A1]
[[  7.59   0.     0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.    58.78   0.     0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.    52.4    0.     0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.    66.39   0.     0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.   280.24   0.     0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.    53.99   0.     0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.   232.78   0.     0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.    37.78   0.     0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     5.77   0.  ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.   158.31]]

Matriz [qfi]
[-150.]

Matriz [Hi]
[ 98.86  95.36  96.38  95.34 157.47 155.13 150.53 150.41]

Matriz [Qi]
[150.    42.26  19.76  35.26  24.74   2.24  20.26  92.74   2.74  75.  ]

Matriz [dq]
[ 4.61e-15 -3.71e-08 -3.71e-08  5.15e-07 -5.15e-07 -5.15e-07  5.15e-07  3.71e-08  3.71e-08  2.22e-16]


-----Fin iteración:   6  Desbalance de caudales: 0.000515

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploBomba.mgh.json
Titulo:      Ejemplo con equipo de bombeo
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.5

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    80.00      10.00     1.00 
  2    80.00      10.00     1.00 
  3    80.00      15.00     1.00 
  4    80.00      15.00     1.00 
  5   150.00      10.00     1.00 
  6   150.00      10.00     1.00 
  7   150.00      15.00     1.00 
  8   150.00      15.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   300  0.0707  0.0500   0.0    TA   - 
  1    1  3      75   150  0.0177  0.0500   0.0    TA   - 
  2    3  4     100   150  0.0177  0.0500   4.0    TA   - 
  3    5  6     100   150  0.0177  0.0500   0.0    TA   - 
  4    5  7      75   100  0.0079  0.0500   0.0    TA   - 
  5    7  8     100   100  0.0079  0.0500   4.0    TA   - 
  6    6  8      75   100  0.0079  0.0500   0.0    TA   - 
  7    1  2     100   200  0.0314  0.0500   0.0    TA   - 
  8    2  4      75   150  0.0177  0.0500   0.0    TA   - 
  9    2  5     100   150  0.0177  0.0500   2.0    BO   -3125.0 187.5 77.5 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -150.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    80.00      10.00    1.00    15.00      98.86    18.86
  2    80.00      10.00    1.00    15.00      95.36    15.36
  3    80.00      15.00    1.00    22.50      96.38    16.38
  4    80.00      15.00    1.00    22.50      95.34    15.34
  5   150.00      10.00    1.00    15.00     157.47     7.47
  6   150.00      10.00    1.00    15.00     155.13     5.13
  7   150.00      15.00    1.00    22.50     150.53     0.53
  8   150.00      15.00    1.00    22.50     150.41     0.41
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     2.12  150.00    1.14    0.00    1.14   0.01138 
  1    1  3     2.39   42.26    2.48    0.00    2.48   0.03312 
  2    3  4     1.12   19.76    0.78    0.25    1.04   0.01035 
  3    5  6     2.00   35.26    2.34    0.00    2.34   0.02340 
  4    5  7     3.15   24.74    6.93    0.00    6.93   0.09246 
  5    7  8     0.29    2.24    0.10    0.02    0.12   0.00121 
  6    6  8     2.58   20.26    4.72    0.00    4.72   0.06287 
  7    1  2     2.95   92.74    3.50    0.00    3.50   0.03504 
  8    2  4     0.16    2.74    0.02    0.00    0.02   0.00021 
  9    2  5     4.24   75.00   10.04    1.84   11.87   0.11873 HBO=73.98
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 6 : ./input/EjemploVRP.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0]

Matriz [Ho]
[100.]

Matriz [qi]
[30. 20. 30. 30. 20. 14.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.]
 [ 0.  0. -1.  0.  0.  1.]
 [-1.  0.  0.  1.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.]
 [ 0.  0.  0. -1.  1.  0.]
 [ 0.  0.  0.  0.  1. -1.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   4.05  1.03    508.56
  1   1  2    80  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   3.24  1.03    427.50
  2   3  6   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  3   1  4   200  200 0.0500  2.0  VR  0.0314   3.18  632194 0.01570   8.11  1.03    913.83
  4   4  3   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  5   4  5   100  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
  6   6  5    80  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  14.07  3.26   1733.43
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

Matriz [A1]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.76  150908 0.01812   0.33  0.06    688.05
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.71  340566 0.01649   1.54  0.30    635.59
  5   4  5   100  150 0.0500  2.0  TA  0.0177   0.57   85385 0.02013   0.22  0.03   2517.08
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.56   83200 0.02021   0.17  0.03   2086.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.    16.42   0.     0.     0.     0.  ]
 [  0.     0.     0.   313.74   0.     0.     0.  ]
 [  0.     0.     0.     0.    34.24   0.     0.  ]
 [  0.     0.     0.     0.     0.    25.5    0.  ]
 [  0.     0.     0.     0.     0.     0.    20.59]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   16.42  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   34.24  0.    0.  ]
 [ 0.    0.    0.    0.    0.   25.5   0.  ]
 [ 0.    0.    0.    0.    0.    0.   20.59]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[90.44 93.   81.93 82.4  99.02 85.11]

Matriz [Qi]
[144.    20.    23.87  94.    53.87  10.13   9.87]

Matriz [dq]
[ 0.04 -0.08 -0.08 -0.01 -0.05 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 89.870431


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.40   79635 0.01998   0.10  0.02    748.25
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.36  269293 0.01689   0.99  0.19    648.30
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.21  180415 0.01820   0.91  0.15   2307.08
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.08   11830 0.03022   0.01  0.00   2956.88
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     9.43   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    27.62   0.     0.  ]
 [  0.     0.     0.     0.     0.    49.38   0.  ]
 [  0.     0.     0.     0.     0.     0.    -4.15]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    9.43  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   27.62  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -4.15]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.07 60.14 59.31 59.05]

Matriz [Qi]
[144.   20.   12.6  94.   42.6  21.4  -1.4]

Matriz [dq]
[-3.05e-16  1.73e-17 -1.13e-02 -8.33e-17 -1.13e-02  1.13e-02 -1.13e-02]


-----Fin iteración:   2  Desbalance de caudales: 11.273820


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   70261 0.02042   0.08  0.01    762.35
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259919 0.01695   0.92  0.17    650.38
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  192914 0.01807   1.03  0.17   2292.20
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.16   24329 0.02548   0.02  0.00   2544.83
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.47   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.74   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.46   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.34]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.47  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.74  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.46  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.34]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.11  94.    41.11  22.89  -2.89]

Matriz [dq]
[-8.88e-16  6.94e-18 -1.48e-03 -1.26e-15 -1.48e-03  1.48e-03 -1.48e-03]


-----Fin iteración:   3  Desbalance de caudales: 1.482857


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   69705 0.02045   0.08  0.01    763.28
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259363 0.01695   0.92  0.17    650.51
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  193655 0.01806   1.04  0.17   2291.36
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.17   25070 0.02532   0.02  0.00   2530.34
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.42   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.69   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.64   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.53]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.42  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.69  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.64  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.53]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.03  94.    41.03  22.97  -2.97]

Matriz [dq]
[ 2.55e-15  7.29e-16 -8.79e-05  2.05e-15 -8.79e-05  8.79e-05 -8.79e-05]


-----Fin iteración:   4  Desbalance de caudales: 0.087867


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.58  910360 0.01536   8.22  2.14    499.93
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.35   69679 0.02045   0.08  0.01    763.32
  3   1  4   200  200 0.0500  2.0  VR  0.0314   2.99  594263 0.01576   7.19  0.91    917.22
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.31  259338 0.01695   0.92  0.17    650.51
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.30  193689 0.01806   1.04  0.17   2291.32
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.17   25104 0.02531   0.02  0.00   2529.69
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 71.99   0.     0.     0.     0.     0.     0.  ]
 [  0.     9.74   0.     0.     0.     0.     0.  ]
 [  0.     0.     8.41   0.     0.     0.     0.  ]
 [  0.     0.     0.   305.17   0.     0.     0.  ]
 [  0.     0.     0.     0.    26.69   0.     0.  ]
 [  0.     0.     0.     0.     0.    52.65   0.  ]
 [  0.     0.     0.     0.     0.     0.    -7.53]]

Matriz [A1]
[[71.99  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    8.41  0.    0.    0.    0.  ]
 [ 0.    0.    0.   86.22  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.69  0.    0.  ]
 [ 0.    0.    0.    0.    0.   52.65  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -7.53]]

Matriz [qfi]
[-144.]

Matriz [Hi]
[89.63 89.44 59.85 60.95 59.74 59.76]

Matriz [Qi]
[144.    20.    11.02  94.    41.02  22.98  -2.98]

Matriz [dq]
[-1.36e-15 -1.42e-15 -4.05e-06 -1.39e-15 -4.05e-06  4.05e-06 -4.05e-06]


-----Fin iteración:   5  Desbalance de caudales: 0.004053

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploVRP.mgh.json
Titulo:      Ejemplo con valvula de control
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    70.00      20.00     1.50 
  2    70.00      20.00     1.00 
  3    40.00      30.00     1.00 
  4    40.00      30.00     1.00 
  5    40.00      20.00     1.00 
  6    40.00      10.00     1.40 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   200  0.0314  0.0500   2.0    TA   - 
  1    1  2      80   200  0.0314  0.0500   2.0    TA   - 
  2    3  6     125   200  0.0314  0.0500   2.0    TA   - 
  3    1  4     200   200  0.0314  0.0500   2.0    VR   10 
  4    4  3     125   200  0.0314  0.0500   2.0    TA   - 
  5    4  5     100   150  0.0177  0.0500   2.0    TA   - 
  6    6  5      80   150  0.0177  0.0500   2.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -144.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    70.00      20.00    1.50    30.00      89.63    19.63
  2    70.00      20.00    1.00    20.00      89.44    19.44
  3    40.00      30.00    1.00    30.00      59.85    19.85
  4    40.00      30.00    1.00    30.00      60.95    20.95
  5    40.00      20.00    1.00    20.00      59.74    19.74
  6    40.00      10.00    1.40    14.00      59.76    19.76
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     4.58  144.00    8.22    2.14   10.37   0.10367 
  1    1  2     0.64   20.00    0.15    0.04    0.19   0.00244 
  2    3  6     0.35   11.02    0.08    0.01    0.09   0.00074 
  3    1  4     2.99   94.00    7.19    0.91    8.10   0.04052 HVR=-20.58
  4    4  3     1.31   41.02    0.92    0.17    1.09   0.00876 
  5    4  5     1.30   22.98    1.04    0.17    1.21   0.01210 
  6    6  5    -0.17   -2.98    0.02    0.00    0.02   0.00028 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 7 : ./input/EjemploVSP.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[100.0, 20.0, 20.0, 30.0, 30.0, 20.0, 10.0]

Matriz [Ho]
[100.]

Matriz [qi]
[20. 20. 30. 30. 20. 10.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.]
 [ 0.  0. -1.  0.  0.  1.]
 [-1.  0.  0.  1.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.]
 [ 0.  0.  0. -1.  1.  0.]
 [ 0.  0.  0.  0.  1. -1.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   4.05  1.03    508.56
  1   1  2    80  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   3.24  1.03    427.50
  2   3  6   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  3   1  4   200  200 0.0500  2.0  VS  0.0314   3.18  632194 0.01570   8.11  1.03    913.83
  4   4  3   125  200 0.0500  2.0  TA  0.0314   3.18  632194 0.01570   5.07  1.03    609.87
  5   4  5   100  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  17.59  3.26   2085.18
  6   6  5    80  150 0.0500  2.0  TA  0.0177   5.66  842926 0.01616  14.07  3.26   1733.43
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.   987.07   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

Matriz [A1]
[[ 50.86   0.     0.     0.     0.     0.     0.  ]
 [  0.    42.75   0.     0.     0.     0.     0.  ]
 [  0.     0.    60.99   0.     0.     0.     0.  ]
 [  0.     0.     0.    91.38   0.     0.     0.  ]
 [  0.     0.     0.     0.    60.99   0.     0.  ]
 [  0.     0.     0.     0.     0.   208.52   0.  ]
 [  0.     0.     0.     0.     0.     0.   173.34]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.66  131742 0.01847   0.26  0.04    699.30
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.62  321400 0.01658   1.38  0.27    638.56
  5   4  5   100  150 0.0500  2.0  TA  0.0177   0.52   77222 0.02045   0.19  0.03   2552.09
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.61   91363 0.01993   0.20  0.04   2060.87
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   14.57  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   32.46  0.    0.  ]
 [ 0.    0.    0.    0.    0.   23.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   22.34]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.   14.57  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   32.46  0.    0.  ]
 [ 0.    0.    0.    0.    0.   23.38  0.  ]
 [ 0.    0.    0.    0.    0.    0.   22.34]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.86 94.43 -5.12 -5.02 12.01 -1.56]

Matriz [Qi]
[130.    20.    20.84  90.    50.84   9.16  10.84]

Matriz [dq]
[ 0.03 -0.08 -0.08 -0.01 -0.05 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 90.838800


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.32   64197 0.02075   0.07  0.01    773.03
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.28  253855 0.01699   0.88  0.17    651.79
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.12  167282 0.01836   0.79  0.13   2324.58
  6   6  5    80  150 0.0500  2.0  TA  0.0177   0.01    1303 0.06006   0.00  0.00   5554.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    7.85  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.17  0.    0.  ]
 [ 0.    0.    0.    0.    0.   46.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.86]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    7.85  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   26.17  0.    0.  ]
 [ 0.    0.    0.    0.    0.   46.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.    0.86]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.11 84.06 83.35 83.12]

Matriz [Qi]
[130.    20.    10.15  90.    40.15  19.85   0.15]

Matriz [dq]
[ 1.67e-16  7.49e-16 -1.07e-02  9.71e-16 -1.07e-02  1.07e-02 -1.07e-02]


-----Fin iteración:   2  Desbalance de caudales: 10.684201


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55798 0.02129   0.05  0.01    790.49
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.24  245456 0.01706   0.83  0.16    653.83
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  178481 0.01823   0.89  0.15   2309.53
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07    9896 0.03164   0.00  0.00   3080.65
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.98  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.39  0.    0.  ]
 [ 0.    0.    0.    0.    0.   48.9   0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.62]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.98  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.39  0.    0.  ]
 [ 0.    0.    0.    0.    0.   48.9   0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.62]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.03 83.02]

Matriz [Qi]
[130.    20.     8.83  90.    38.83  21.17  -1.17]

Matriz [dq]
[-1.28e-14  4.16e-17 -1.33e-03 -1.35e-14 -1.33e-03  1.33e-03 -1.33e-03]


-----Fin iteración:   3  Desbalance de caudales: 1.328595


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55146 0.02134   0.05  0.01    792.01
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.23  244805 0.01706   0.83  0.15    653.99
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  179349 0.01822   0.90  0.15   2308.42
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07   10764 0.03096   0.00  0.00   3021.12
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.12  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.86]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.12  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.86]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.02 83.02]

Matriz [Qi]
[130.    20.     8.72  90.    38.72  21.28  -1.28]

Matriz [dq]
[ 1.29e-14  7.32e-16 -1.03e-04  1.23e-14 -1.03e-04  1.03e-04 -1.03e-04]


-----Fin iteración:   4  Desbalance de caudales: 0.102989


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   100  200 0.0500  2.0  TA  0.0314   4.14  821853 0.01545   6.74  1.75    502.13
  1   1  2    80  200 0.0500  2.0  TA  0.0314   0.64  126439 0.01858   0.15  0.04    487.01
  2   3  6   125  200 0.0500  2.0  TA  0.0314   0.28   55114 0.02134   0.05  0.01    792.08
  3   1  4   200  200 0.0500  2.0  VS  0.0314   2.86  568975 0.01581   6.61  0.84    919.70
  4   4  3   125  200 0.0500  2.0  TA  0.0314   1.23  244773 0.01706   0.83  0.15    654.00
  5   4  5   100  150 0.0500  2.0  TA  0.0177   1.20  179392 0.01821   0.90  0.15   2308.37
  6   6  5    80  150 0.0500  2.0  TA  0.0177  -0.07   10807 0.03093   0.00  0.00   3018.37
-------------------------------------------------------------------------------------------
Matriz [A]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.87]]

Matriz [A1]
[[65.28  0.    0.    0.    0.    0.    0.  ]
 [ 0.    9.74  0.    0.    0.    0.    0.  ]
 [ 0.    0.    6.91  0.    0.    0.    0.  ]
 [ 0.    0.    0.   82.77  0.    0.    0.  ]
 [ 0.    0.    0.    0.   25.32  0.    0.  ]
 [ 0.    0.    0.    0.    0.   49.13  0.  ]
 [ 0.    0.    0.    0.    0.    0.   -3.87]]

Matriz [qfi]
[-130.]

Matriz [Hi]
[91.51 91.32 83.08 84.06 83.02 83.02]

Matriz [Qi]
[130.    20.     8.72  90.    38.72  21.28  -1.28]

Matriz [dq]
[ 1.33e-15 -2.14e-15 -5.07e-06  2.01e-15 -5.07e-06  5.07e-06 -5.07e-06]


-----Fin iteración:   5  Desbalance de caudales: 0.005070

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/EjemploVSP.mgh.json
Titulo:      Ejemplo con valvula de control
Autor:       Carlos Camacho
Fecha:       02/02/2019
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    70.00      20.00     1.00 
  2    70.00      20.00     1.00 
  3    40.00      30.00     1.00 
  4    40.00      30.00     1.00 
  5    40.00      20.00     1.00 
  6    40.00      10.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     100   200  0.0314  0.0500   2.0    TA   - 
  1    1  2      80   200  0.0314  0.0500   2.0    TA   - 
  2    3  6     125   200  0.0314  0.0500   2.0    TA   - 
  3    1  4     200   200  0.0314  0.0500   2.0    VS   30 
  4    4  3     125   200  0.0314  0.0500   2.0    TA   - 
  5    4  5     100   150  0.0177  0.0500   2.0    TA   - 
  6    6  5      80   150  0.0177  0.0500   2.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0    90.00     100.00    10.00  -130.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    70.00      20.00    1.00    20.00      91.51    21.51
  2    70.00      20.00    1.00    20.00      91.32    21.32
  3    40.00      30.00    1.00    30.00      83.08    43.08
  4    40.00      30.00    1.00    30.00      84.06    44.06
  5    40.00      20.00    1.00    20.00      83.02    43.02
  6    40.00      10.00    1.00    10.00      83.02    43.02
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     4.14  130.00    6.74    1.75    8.49   0.08486 
  1    1  2     0.64   20.00    0.15    0.04    0.19   0.00244 
  2    3  6     0.28    8.72    0.05    0.01    0.06   0.00048 
  3    1  4     2.86   90.00    6.61    0.84    7.45   0.03725 HVS=0.00
  4    4  3     1.23   38.72    0.83    0.15    0.98   0.00784 
  5    4  5     1.20   21.28    0.90    0.15    1.05   0.01046 
  6    6  5    -0.07   -1.28    0.00    0.00    0.00   0.00006 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 8 : ./input/Naciente.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[160.0, 100.0, 10.0, -100.0]

Matriz [Ho]
[160. 100.]

Matriz [qi]
[  10. -100.]

Matriz [B]
[[ 1.  0.]
 [-1.  0.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  1.]
 [ 1.  0.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[190.33   0.     0.  ]
 [  0.   185.16   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   185.16   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.29  852370 0.01212  28.45  4.69   1823.41
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.97  789151 0.01228  24.70  3.22   1791.69
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[245.85   0.     0.  ]
 [  0.   223.65   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[245.85   0.     0.  ]
 [  0.   223.65   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-34.83 124.83]

Matriz [Hi]
[127.71 178.52]

Matriz [Qi]
[134.83 124.83 100.  ]

Matriz [dq]
[ 3.48e-02  2.48e-02 -2.78e-17]


-----Fin iteración:   1  Desbalance de caudales: 34.827191


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.26  845203 0.01214  28.01  4.62   1825.57
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.94  781983 0.01230  24.29  3.16   1794.08
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[244.07   0.     0.  ]
 [  0.   221.92   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[244.07   0.     0.  ]
 [  0.   221.92   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.69 123.69]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.69 123.69 100.  ]

Matriz [dq]
[-1.13e-03 -1.13e-03  5.55e-17]


-----Fin iteración:   2  Desbalance de caudales: 1.133711


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.25  844661 0.01214  27.98  4.61   1825.74
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.93  781442 0.01230  24.26  3.16   1794.26
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.93   0.     0.  ]
 [  0.   221.79   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[243.93   0.     0.  ]
 [  0.   221.79   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.61 123.61]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.61 123.61 100.  ]

Matriz [dq]
[-8.56e-05 -8.56e-05  2.78e-17]


-----Fin iteración:   3  Desbalance de caudales: 0.085648


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.25  844622 0.01214  27.98  4.61   1825.75
  1   2  1   500  200 0.0015  4.0  TA  0.0314   3.93  781403 0.01230  24.26  3.16   1794.28
  2   3  0   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.92   0.     0.  ]
 [  0.   221.78   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[243.92   0.     0.  ]
 [  0.   221.78   0.  ]
 [  0.     0.   185.16]]

Matriz [qfi]
[-33.6 123.6]

Matriz [Hi]
[127.41 178.52]

Matriz [Qi]
[133.6 123.6 100. ]

Matriz [dq]
[-6.15e-06 -6.15e-06 -1.39e-17]


-----Fin iteración:   4  Desbalance de caudales: 0.006155

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Naciente.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   150.00     160.00    10.00 
  1    90.00     100.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    90.00      10.00     1.00 
  3   160.00    -100.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  1     500   200  0.0314  0.0015   4.0    TA   - 
  2    3  0     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   150.00     160.00    10.00   -33.60
  1    90.00     100.00    10.00   123.60
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    90.00      10.00    1.00    10.00     127.41    37.41
  3   160.00    -100.00    1.00  -100.00     178.52    18.52
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     4.25  133.60   27.98    4.61   32.59   0.06518 
  1    2  1     3.93  123.60   24.26    3.16   27.41   0.05482 
  2    3  0     3.18  100.00   16.45    2.07   18.52   0.03703 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 9 : ./input/P3Tanques.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[132.0, 90.0, 128.0, 100.0]

Matriz [Ho]
[132.  90. 128.]

Matriz [qi]
[100.]

Matriz [B]
[[1.]
 [1.]
 [1.]]

Matriz [C]
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   2.04  505756 0.01316  11.14  1.06   1219.38
-------------------------------------------------------------------------------------------

Matriz [A]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

Matriz [A1]
[[121.94   0.     0.  ]
 [  0.   121.94   0.  ]
 [  0.     0.   121.94]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   1.96  486572 0.01325  10.38  0.98   1226.86
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -1.55  384436 0.01381   6.75  0.61   1274.31
  2   2  3  1000  250 0.0015  5.0  TA  0.0491   1.63  403619 0.01369   7.38  0.67   1264.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [A1]
[[118.03   0.     0.  ]
 [  0.   -96.86   0.  ]
 [  0.     0.   100.89]]

Matriz [qfi]
[-96.21  76.01 -79.81]

Matriz [Hi]
[120.73]

Matriz [Qi]
[ 96.21 -76.01  79.81]

Matriz [dq]
[-0.   -0.18 -0.02]


-----Fin iteración:   1  Desbalance de caudales: 3.793013


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491  -2.17  538086 0.01302  12.47  1.20   1207.56
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   7.48 1856401 0.01071 122.05 14.25   1011.65
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -3.27  812560 0.01216  26.55  2.73   1134.22
-------------------------------------------------------------------------------------------
Matriz [A]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [A1]
[[-128.48    0.      0.  ]
 [   0.    371.33    0.  ]
 [   0.      0.   -182.23]]

Matriz [qfi]
[ 106.39 -367.06  160.66]

Matriz [Hi]
[168.47]

Matriz [Qi]
[-106.39  367.06 -160.66]

Matriz [dq]
[-0.2   0.44 -0.24]


-----Fin iteración:   2  Desbalance de caudales: 202.599399


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   0.35   86641 0.01844   0.46  0.03   1666.31
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   2.09  519116 0.01310  11.68  1.11   1214.38
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -0.40  100002 0.01790   0.59  0.04   1620.23
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [A1]
[[ 28.55   0.     0.  ]
 [  0.   124.65   0.  ]
 [  0.     0.   -32.04]]

Matriz [qfi]
[ -17.13 -102.64   19.77]

Matriz [Hi]
[150.07]

Matriz [Qi]
[ 17.13 102.64 -19.77]

Matriz [dq]
[ 0.12 -0.26  0.14]


-----Fin iteración:   3  Desbalance de caudales: 123.523463


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   9.58 2378445 0.01034 193.47 23.39    980.58
  1   1  3  1000  250 0.0015  5.0  TA  0.0491  -0.23   57748 0.02013   0.22  0.01   1808.95
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -7.31 1814942 0.01074 117.04 13.62   1014.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [A1]
[[ 461.14    0.      0.  ]
 [   0.    -20.65    0.  ]
 [   0.      0.   -364.1 ]]

Matriz [qfi]
[-470.28   11.42  358.86]

Matriz [Hi]
[105.64]

Matriz [Qi]
[ 470.28  -11.42 -358.86]

Matriz [dq]
[ 0.45 -0.11 -0.34]


-----Fin iteración:   4  Desbalance de caudales: 453.144660


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   5.67 1406859 0.01115  73.02  8.18   1049.41
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.02  254229 0.01489   3.18  0.27   1366.00
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.65 1155333 0.01149  50.75  5.52   1078.25
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [A1]
[[ 291.91    0.      0.  ]
 [   0.     68.66    0.  ]
 [   0.      0.   -246.31]]

Matriz [qfi]
[-278.17  -50.27  228.44]

Matriz [Hi]
[92.31]

Matriz [Qi]
[ 278.17   50.27 -228.44]

Matriz [dq]
[-0.19  0.06  0.13]


-----Fin iteración:   5  Desbalance de caudales: 192.105878


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.58 1135921 0.01152  49.19  5.34   1080.82
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.69  418996 0.01360   7.90  0.73   1256.59
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.23 1049162 0.01167  42.48  4.55   1093.00
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [A1]
[[ 242.75    0.      0.  ]
 [   0.    104.1     0.  ]
 [   0.      0.   -226.74]]

Matriz [qfi]
[-224.6   -82.85  207.44]

Matriz [Hi]
[82.07]

Matriz [Qi]
[ 224.6    82.85 -207.44]

Matriz [dq]
[-0.05  0.03  0.02]


-----Fin iteración:   6  Desbalance de caudales: 53.570998


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.48 1111252 0.01156  47.23  5.11   1084.16
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.84  456132 0.01340   9.22  0.86   1239.54
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1061628 0.01165  43.42  4.66   1091.17
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [A1]
[[ 238.21    0.      0.  ]
 [   0.    111.79    0.  ]
 [   0.      0.   -229.05]]

Matriz [qfi]
[-219.72  -90.19  209.91]

Matriz [Hi]
[79.85]

Matriz [Qi]
[ 219.72   90.19 -209.91]

Matriz [dq]
[-0.    0.01 -0.  ]


-----Fin iteración:   7  Desbalance de caudales: 4.877723


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109840 0.01157  47.12  5.09   1084.35
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  458956 0.01339   9.33  0.87   1238.32
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063041 0.01164  43.53  4.67   1090.97
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [A1]
[[ 237.95    0.      0.  ]
 [   0.    112.37    0.  ]
 [   0.      0.   -229.31]]

Matriz [qfi]
[-219.44  -90.75  210.19]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.44   90.75 -210.19]

Matriz [dq]
[-0.  0. -0.]


-----Fin iteración:   8  Desbalance de caudales: 0.279121


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109731 0.01157  47.12  5.09   1084.36
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459156 0.01338   9.33  0.87   1238.24
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063131 0.01164  43.53  4.67   1090.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.41    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-2.16e-05  3.94e-05 -1.78e-05]


-----Fin iteración:   9  Desbalance de caudales: 0.021561


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  3  1000  250 0.0015  5.0  TA  0.0491   4.47 1109722 0.01157  47.11  5.09   1084.37
  1   1  3  1000  250 0.0015  5.0  TA  0.0491   1.85  459170 0.01338   9.33  0.87   1238.23
  2   2  3  1000  250 0.0015  5.0  TA  0.0491  -4.28 1063136 0.01164  43.53  4.67   1090.95
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [A1]
[[ 237.93    0.      0.  ]
 [   0.    112.42    0.  ]
 [   0.      0.   -229.33]]

Matriz [qfi]
[-219.42  -90.79  210.21]

Matriz [Hi]
[79.79]

Matriz [Qi]
[ 219.42   90.79 -210.21]

Matriz [dq]
[-1.69e-06  2.77e-06 -1.08e-06]


-----Fin iteración:  10  Desbalance de caudales: 0.001691

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/P3Tanques.mgh.json
Titulo:      Problema de los 3 tanques
Autor:       Ing. Carlos Camacho Soto
Fecha:       08/02/2018
Versión:     1.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Swamee-Jain
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     132.00    32.00 
  1   130.00      90.00   -40.00 
  2   120.00     128.00     8.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  3    70.00     100.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  3    1000   250  0.0491  0.0015   5.0    TA   - 
  1    1  3    1000   250  0.0491  0.0015   5.0    TA   - 
  2    2  3    1000   250  0.0491  0.0015   5.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     132.00    32.00  -219.42
  1   130.00      90.00   -40.00   -90.79
  2   120.00     128.00     8.00   210.21
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  3    70.00     100.00    1.00   100.00      79.79     9.79
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  3     4.47  219.42   47.11    5.09   52.21   0.05221 
  1    1  3     1.85   90.79    9.33    0.87   10.21   0.01021 
  2    2  3    -4.28  -210.21   43.53    4.67   48.21   0.04821 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 10 : ./input/pruebaJSON.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, -40.0, 6.0, 7.0, 4.0, 6.0]

Matriz [Ho]
[110.]

Matriz [qi]
[-40.   6.   7.   4.   6.]

Matriz [B]
[[-1.  0.  0.  0.  0.]
 [ 0.  1.  0.  0.  0.]
 [ 0. -1.  1.  0.  0.]
 [ 0. -1.  0.  1.  0.]
 [ 0.  0. -1.  0.  1.]
 [ 0.  0.  0. -1.  1.]]

Matriz [C]
[[ 1.]
 [-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  32.90  2.58   3548.32
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   3.18  632194 0.01274  32.90  1.55   3445.03
  2   2  3   750  150 0.0015  2.0  TA  0.0177   5.66  842926 0.01219  99.52  3.26  10278.35
  3   2  4   500  150 0.0015  2.0  TA  0.0177   5.66  842926 0.01219  66.35  3.26   6961.04
  4   3  5   750  150 0.0015 10.0  TA  0.0177   5.66  842926 0.01219  99.52 16.32  11584.06
  5   4  5   500  100 0.0015  2.0  TA  0.0079  12.73 1264389 0.01157 478.14 16.53  49466.56
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 354.83    0.      0.      0.      0.      0.  ]
 [   0.    344.5     0.      0.      0.      0.  ]
 [   0.      0.   1027.84    0.      0.      0.  ]
 [   0.      0.      0.    696.1     0.      0.  ]
 [   0.      0.      0.      0.   1158.41    0.  ]
 [   0.      0.      0.      0.      0.   4946.66]]

Matriz [A1]
[[ 354.83    0.      0.      0.      0.      0.  ]
 [   0.    344.5     0.      0.      0.      0.  ]
 [   0.      0.   1027.84    0.      0.      0.  ]
 [   0.      0.      0.    696.1     0.      0.  ]
 [   0.      0.      0.      0.   1158.41    0.  ]
 [   0.      0.      0.      0.      0.   4946.66]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177  -0.64   95368 0.01822   1.90  0.04  15196.50
  3   2  4   500  150 0.0015  2.0  TA  0.0177   1.60  238665 0.01520   6.63  0.26   8596.12
  4   3  5   750  150 0.0015 10.0  TA  0.0177  -1.04  154373 0.01653   4.52  0.55  15122.42
  5   4  5   500  100 0.0015  2.0  TA  0.0079   3.10  307423 0.01456  35.55  0.98  61787.61
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 165.39    0.      0.      0.      0.      0.  ]
 [   0.    102.81    0.      0.      0.      0.  ]
 [   0.      0.   -171.93    0.      0.      0.  ]
 [   0.      0.      0.    243.39    0.      0.  ]
 [   0.      0.      0.      0.   -276.95    0.  ]
 [   0.      0.      0.      0.      0.   1502.3 ]]

Matriz [A1]
[[ 165.39    0.      0.      0.      0.      0.  ]
 [   0.    102.81    0.      0.      0.      0.  ]
 [   0.      0.   -171.93    0.      0.      0.  ]
 [   0.      0.      0.    243.39    0.      0.  ]
 [   0.      0.      0.      0.   -276.95    0.  ]
 [   0.      0.      0.      0.      0.   1502.3 ]]

Matriz [qfi]
[17.]

Matriz [Hi]
[102.9  128.6  254.64 158.79 412.91]

Matriz [Qi]
[ 40.    23.   -11.31  28.31 -18.31  24.31]

Matriz [dq]
[-0.06 -0.08 -0.11 -0.07 -0.12 -0.08]


-----Fin iteración:   1  Desbalance de caudales: 118.313932


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.15   22935 0.02506   0.15  0.00  20775.62
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.81  120362 0.01737   1.93  0.07   9778.27
  4   3  5   750  150 0.0015 10.0  TA  0.0177  -0.24   36070 0.02253   0.34  0.03  20015.98
  5   4  5   500  100 0.0015  2.0  TA  0.0079   1.31  129968 0.01714   7.48  0.17  72454.91
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.    56.53   0.     0.     0.  ]
 [  0.     0.     0.   139.63   0.     0.  ]
 [  0.     0.     0.     0.   -85.65   0.  ]
 [  0.     0.     0.     0.     0.   744.77]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.    56.53   0.     0.     0.  ]
 [  0.     0.     0.   139.63   0.     0.  ]
 [  0.     0.     0.     0.   -85.65   0.  ]
 [  0.     0.     0.     0.     0.   744.77]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 110.52 107.58 113.22]

Matriz [Qi]
[40.   23.    2.72 14.28 -4.28 10.28]

Matriz [dq]
[ 0.00e+00 -6.94e-18  1.40e-02 -1.40e-02  1.40e-02 -1.40e-02]


-----Fin iteración:   2  Desbalance de caudales: 14.034803


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.46   67921 0.01957   1.04  0.02  16300.51
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.51   75376 0.01914   0.83  0.03  10741.53
  4   3  5   750  150 0.0015 10.0  TA  0.0177   0.06    8916 0.03186   0.03  0.00  27629.46
  5   4  5   500  100 0.0015  2.0  TA  0.0079   0.63   62489 0.01995   2.01  0.04  84072.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   131.35   0.     0.     0.  ]
 [  0.     0.     0.    96.05   0.     0.  ]
 [  0.     0.     0.     0.    29.23   0.  ]
 [  0.     0.     0.     0.     0.   415.51]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   131.35   0.     0.     0.  ]
 [  0.     0.     0.    96.05   0.     0.  ]
 [  0.     0.     0.     0.    29.23   0.  ]
 [  0.     0.     0.     0.     0.   415.51]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 106.88 107.13 107.43]

Matriz [Qi]
[40.   23.    8.06  8.94  1.06  4.94]

Matriz [dq]
[ 0.00e+00 -2.78e-16  5.34e-03 -5.34e-03  5.34e-03 -5.34e-03]


-----Fin iteración:   3  Desbalance de caudales: 5.336895


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.53   79353 0.01894   1.37  0.03  15779.81
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.43   63944 0.01983   0.62  0.02  11115.14
  4   3  5   750  150 0.0015 10.0  TA  0.0177   0.14   20349 0.02580   0.12  0.01  22683.36
  5   4  5   500  100 0.0015  2.0  TA  0.0079   0.46   45340 0.02141   1.14  0.02  90087.79
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   148.55   0.     0.     0.  ]
 [  0.     0.     0.    84.32   0.     0.  ]
 [  0.     0.     0.     0.    54.76   0.  ]
 [  0.     0.     0.     0.     0.   323.05]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   148.55   0.     0.     0.  ]
 [  0.     0.     0.    84.32   0.     0.  ]
 [  0.     0.     0.     0.    54.76   0.  ]
 [  0.     0.     0.     0.     0.   323.05]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 106.22 107.04 106.11]

Matriz [Qi]
[40.   23.    9.41  7.59  2.41  3.59]

Matriz [dq]
[ 0.00e+00  2.46e-16  1.36e-03 -1.36e-03  1.36e-03 -1.36e-03]


-----Fin iteración:   4  Desbalance de caudales: 1.356281


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.55   81199 0.01884   1.43  0.03  15705.01
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.42   62098 0.01996   0.59  0.02  11183.75
  4   3  5   750  150 0.0015 10.0  TA  0.0177   0.15   22194 0.02526   0.14  0.01  22244.00
  5   4  5   500  100 0.0015  2.0  TA  0.0079   0.43   42572 0.02171   1.02  0.02  91345.44
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.29   0.     0.     0.  ]
 [  0.     0.     0.    82.39   0.     0.  ]
 [  0.     0.     0.     0.    58.57   0.  ]
 [  0.     0.     0.     0.     0.   307.56]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.29   0.     0.     0.  ]
 [  0.     0.     0.    82.39   0.     0.  ]
 [  0.     0.     0.     0.    58.57   0.  ]
 [  0.     0.     0.     0.     0.   307.56]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 106.17 107.03 106.02]

Matriz [Qi]
[40.   23.    9.63  7.37  2.63  3.37]

Matriz [dq]
[ 0.00e+00 -4.51e-17  2.19e-04 -2.19e-04  2.19e-04 -2.19e-04]


-----Fin iteración:   5  Desbalance de caudales: 0.218951


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.55   81417 0.01883   1.43  0.03  15696.33
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.42   61881 0.01997   0.59  0.02  11192.01
  4   3  5   750  150 0.0015 10.0  TA  0.0177   0.15   22412 0.02520   0.15  0.01  22195.45
  5   4  5   500  100 0.0015  2.0  TA  0.0079   0.43   42245 0.02175   1.00  0.02  91500.93
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.61   0.     0.     0.  ]
 [  0.     0.     0.    82.16   0.     0.  ]
 [  0.     0.     0.     0.    59.01   0.  ]
 [  0.     0.     0.     0.     0.   305.72]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.61   0.     0.     0.  ]
 [  0.     0.     0.    82.16   0.     0.  ]
 [  0.     0.     0.     0.    59.01   0.  ]
 [  0.     0.     0.     0.     0.   305.72]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 106.17 107.03 106.01]

Matriz [Qi]
[40.   23.    9.66  7.34  2.66  3.34]

Matriz [dq]
[ 0.00e+00  4.79e-16  2.58e-05 -2.58e-05  2.58e-05 -2.58e-05]


-----Fin iteración:   6  Desbalance de caudales: 0.025822


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   1  0  1000  200 0.0015  5.0  TA  0.0314   1.27  252878 0.01501   6.20  0.41   4134.68
  1   0  2  1000  200 0.0015  3.0  TA  0.0314   0.73  145405 0.01671   2.28  0.08   4469.81
  2   2  3   750  150 0.0015  2.0  TA  0.0177   0.55   81440 0.01883   1.43  0.03  15695.38
  3   2  4   500  150 0.0015  2.0  TA  0.0177   0.42   61857 0.01997   0.59  0.02  11192.92
  4   3  5   750  150 0.0015 10.0  TA  0.0177   0.15   22436 0.02519   0.15  0.01  22190.18
  5   4  5   500  100 0.0015  2.0  TA  0.0079   0.43   42210 0.02175   1.00  0.02  91518.02
-------------------------------------------------------------------------------------------
Matriz [A]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.64   0.     0.     0.  ]
 [  0.     0.     0.    82.14   0.     0.  ]
 [  0.     0.     0.     0.    59.06   0.  ]
 [  0.     0.     0.     0.     0.   305.52]]

Matriz [A1]
[[165.39   0.     0.     0.     0.     0.  ]
 [  0.   102.81   0.     0.     0.     0.  ]
 [  0.     0.   151.64   0.     0.     0.  ]
 [  0.     0.     0.    82.14   0.     0.  ]
 [  0.     0.     0.     0.    59.06   0.  ]
 [  0.     0.     0.     0.     0.   305.52]]

Matriz [qfi]
[17.]

Matriz [Hi]
[116.62 107.64 106.17 107.03 106.01]

Matriz [Qi]
[40.   23.    9.66  7.34  2.66  3.34]

Matriz [dq]
[ 0.00e+00 -2.29e-16  2.82e-06 -2.82e-06  2.82e-06 -2.82e-06]


-----Fin iteración:   7  Desbalance de caudales: 0.002821

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/pruebaJSON.mgh.json
Titulo:      Titulo
Autor:       Autor
Fecha:       8-set-2022
Versión:     8-set-2022
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  50
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    90.00     -40.00     1.00 
  2    87.00       6.00     1.00 
  3    85.00       7.00     1.00 
  4    80.00       4.00     1.00 
  5    88.00       6.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    1  0    1000   200  0.0314  0.0015   5.0    TA   - 
  1    0  2    1000   200  0.0314  0.0015   3.0    TA   - 
  2    2  3     750   150  0.0177  0.0015   2.0    TA   - 
  3    2  4     500   150  0.0177  0.0015   2.0    TA   - 
  4    3  5     750   150  0.0177  0.0015  10.0    TA   - 
  5    4  5     500   100  0.0079  0.0015   2.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00    17.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    90.00     -40.00    1.00   -40.00     116.62    26.62
  2    87.00       6.00    1.00     6.00     107.64    20.64
  3    85.00       7.00    1.00     7.00     106.17    21.17
  4    80.00       4.00    1.00     4.00     107.03    27.03
  5    88.00       6.00    1.00     6.00     106.01    18.01
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    1  0     1.27   40.00    6.20    0.41    6.62   0.00662 
  1    0  2     0.73   23.00    2.28    0.08    2.36   0.00236 
  2    2  3     0.55    9.66    1.43    0.03    1.47   0.00195 
  3    2  4     0.42    7.34    0.59    0.02    0.60   0.00121 
  4    3  5     0.15    2.66    0.15    0.01    0.16   0.00021 
  5    4  5     0.43    3.34    1.00    0.02    1.02   0.00204 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:01 2022
crcs-2022
...
 
Procesando archivo N° 11 : ./input/Qmax-VR.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 55.0, 10.0, 20.0]

Matriz [Ho]
[110.  55.]

Matriz [qi]
[10. 20.]

Matriz [B]
[[ 1.  0.]
 [-1.  1.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.18  632194 0.01274  16.45  0.00   1645.05
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.64  722344 0.01246  21.00  3.37   1866.77
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.32  659125 0.01265  17.76  0.00   1633.48
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.68  532686 0.01312  12.03  1.47   1900.64
-------------------------------------------------------------------------------------------
Matriz [A]
[[213.3    0.     0.  ]
 [  0.   378.07   0.  ]
 [  0.     0.   160.15]]

Matriz [A1]
[[213.3    0.     0.  ]
 [  0.   170.31   0.  ]
 [  0.     0.   160.15]]

Matriz [qfi]
[-114.26   84.26]

Matriz [Hi]
[85.54 67.69]

Matriz [Qi]
[114.26 104.26  84.26]

Matriz [dq]
[ 0.01  0.   -0.02]


-----Fin iteración:   1  Desbalance de caudales: 14.259853


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.98  592809 0.01288  14.62  2.27   1921.39
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.67  529590 0.01314  11.90  0.00   1695.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.03  403151 0.01378   7.24  0.84   1985.82
-------------------------------------------------------------------------------------------
Matriz [A]
[[180.17   0.     0.  ]
 [  0.   541.     0.  ]
 [  0.     0.   126.64]]

Matriz [A1]
[[180.17   0.     0.  ]
 [  0.   142.06   0.  ]
 [  0.     0.   126.64]]

Matriz [qfi]
[-93.77  63.77]

Matriz [Hi]
[94.37 61.93]

Matriz [Qi]
[93.77 83.77 63.77]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:   2  Desbalance de caudales: 20.489800


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.44  485137 0.01334  10.14  1.52   1980.10
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.12  421917 0.01367   7.86  0.00   1764.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.49  295478 0.01458   4.11  0.45   2089.31
-------------------------------------------------------------------------------------------
Matriz [A]
[[151.95   0.     0.  ]
 [  0.   721.82   0.  ]
 [  0.     0.    97.65]]

Matriz [A1]
[[151.95   0.     0.  ]
 [  0.   117.78   0.  ]
 [  0.     0.    97.65]]

Matriz [qfi]
[-76.74  46.74]

Matriz [Hi]
[99.24 58.76]

Matriz [Qi]
[76.74 66.74 46.74]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:   3  Desbalance de caudales: 17.031520


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.04  404281 0.01377   7.27  1.06   2036.57
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.72  341061 0.01420   5.34  0.00   1833.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.08  214622 0.01549   2.30  0.24   2206.08
-------------------------------------------------------------------------------------------
Matriz [A]
[[130.24   0.     0.  ]
 [  0.   924.86   0.  ]
 [  0.     0.    74.89]]

Matriz [A1]
[[130.24   0.     0.  ]
 [  0.    98.93   0.  ]
 [  0.     0.    74.89]]

Matriz [qfi]
[-63.95  33.95]

Matriz [Hi]
[102.23  57.07]

Matriz [Qi]
[63.95 53.95 33.95]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   4  Desbalance de caudales: 12.789758


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.73  344338 0.01418   5.43  0.77   2088.81
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.42  281119 0.01472   3.76  0.00   1900.22
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.78  154680 0.01651   1.28  0.12   2337.68
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 113.77    0.      0.  ]
 [   0.   1147.36    0.  ]
 [   0.      0.     57.2 ]]

Matriz [A1]
[[113.77   0.     0.  ]
 [  0.    84.5    0.  ]
 [  0.     0.    57.2 ]]

Matriz [qfi]
[-54.47  24.47]

Matriz [Hi]
[104.14  56.12]

Matriz [Qi]
[54.47 44.47 24.47]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   5  Desbalance de caudales: 9.481598


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.51  299594 0.01455   4.22  0.58   2136.14
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.19  236374 0.01521   2.74  0.00   1963.09
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.55  109936 0.01768   0.69  0.06   2489.40
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 101.23    0.      0.  ]
 [   0.   1385.04    0.  ]
 [   0.      0.     43.29]]

Matriz [A1]
[[101.23   0.     0.  ]
 [  0.    73.4    0.  ]
 [  0.     0.    43.29]]

Matriz [qfi]
[-47.39  17.39]

Matriz [Hi]
[105.41  55.59]

Matriz [Qi]
[47.39 37.39 17.39]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   6  Desbalance de caudales: 7.077653


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.34  265711 0.01487   3.39  0.46   2178.52
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.02  202492 0.01566   2.07  0.00   2021.95
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.38   76053 0.01910   0.36  0.03   2671.95
-------------------------------------------------------------------------------------------
Matriz [A]
[[  91.56    0.      0.  ]
 [   0.   1633.63    0.  ]
 [   0.      0.     32.14]]

Matriz [A1]
[[91.56  0.    0.  ]
 [ 0.   64.76  0.  ]
 [ 0.    0.   32.14]]

Matriz [qfi]
[-42.03  12.03]

Matriz [Hi]
[106.29  55.29]

Matriz [Qi]
[42.03 32.03 12.03]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:   7  Desbalance de caudales: 5.359539


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.21  239546 0.01517   2.81  0.37   2216.35
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.89  176326 0.01609   1.62  0.00   2076.94
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.25   49887 0.02093   0.17  0.01   2908.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[  83.98    0.      0.  ]
 [   0.   1890.11    0.  ]
 [   0.      0.     22.95]]

Matriz [A1]
[[83.98  0.    0.  ]
 [ 0.   57.93  0.  ]
 [ 0.    0.   22.95]]

Matriz [qfi]
[-37.89   7.89]

Matriz [Hi]
[106.91  55.12]

Matriz [Qi]
[37.89 27.89  7.89]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   8  Desbalance de caudales: 4.138853


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.10  218827 0.01543   2.39  0.31   2250.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.78  155607 0.01649   1.29  0.00   2128.60
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.15   29168 0.02366   0.07  0.00   3261.03
-------------------------------------------------------------------------------------------
Matriz [A]
[[  77.89    0.      0.  ]
 [   0.   2153.79    0.  ]
 [   0.      0.     15.05]]

Matriz [A1]
[[77.89  0.    0.  ]
 [ 0.   52.39  0.  ]
 [ 0.    0.   15.05]]

Matriz [qfi]
[-34.61   4.61]

Matriz [Hi]
[107.37  55.03]

Matriz [Qi]
[34.61 24.61  4.61]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   9  Desbalance de caudales: 3.277283


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.02  201890 0.01567   2.06  0.26   2281.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.70  138670 0.01687   1.05  0.00   2177.97
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.06   12231 0.02931   0.01  0.00   3990.53
-------------------------------------------------------------------------------------------
Matriz [A]
[[  72.85    0.      0.  ]
 [   0.   2427.44    0.  ]
 [   0.      0.      7.72]]

Matriz [A1]
[[72.85  0.    0.  ]
 [ 0.   47.77  0.  ]
 [ 0.    0.    7.72]]

Matriz [qfi]
[-31.93   1.93]

Matriz [Hi]
[107.72  54.99]

Matriz [Qi]
[31.93 21.93  1.93]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  10  Desbalance de caudales: 2.679108


-----Iteración número:  11 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.94  187441 0.01590   1.80  0.23   2310.58
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.63  124222 0.01725   0.86  0.00   2226.73
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.01    2217 0.04785   0.00  0.00   6383.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 6.85e+01  0.00e+00  0.00e+00]
 [ 0.00e+00  2.72e+03  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.24e+00]]

Matriz [A1]
[[68.51  0.    0.  ]
 [ 0.   43.75  0.  ]
 [ 0.    0.   -2.24]]

Matriz [qfi]
[-29.65  -0.35]

Matriz [Hi]
[108.01  54.98]

Matriz [Qi]
[29.65 19.65 -0.35]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  11  Desbalance de caudales: 2.285421


-----Iteración número:  12 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.88  173987 0.01613   1.58  0.20   2340.57
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.56  110768 0.01765   0.70  0.00   2279.31
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.08   15671 0.02751   0.02  0.00   3758.88
-------------------------------------------------------------------------------------------
Matriz [A]
[[  64.42    0.      0.  ]
 [   0.   3059.74    0.  ]
 [   0.      0.     -9.32]]

Matriz [A1]
[[64.42  0.    0.  ]
 [ 0.   39.94  0.  ]
 [ 0.    0.   -9.32]]

Matriz [qfi]
[-27.52  -2.48]

Matriz [Hi]
[108.26  55.01]

Matriz [Qi]
[27.52 17.52 -2.48]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  12  Desbalance de caudales: 2.128129


-----Iteración número:  13 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.81  160478 0.01639   1.36  0.17   2373.89
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.49   97259 0.01813   0.55  0.00   2341.24
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.15   29180 0.02366   0.07  0.00   3260.74
-------------------------------------------------------------------------------------------
Matriz [A]
[[  60.26    0.      0.  ]
 [   0.   3495.73    0.  ]
 [   0.      0.    -15.05]]

Matriz [A1]
[[ 60.26   0.     0.  ]
 [  0.    36.02   0.  ]
 [  0.     0.   -15.05]]

Matriz [qfi]
[-25.38  -4.62]

Matriz [Hi]
[108.5   55.06]

Matriz [Qi]
[25.38 15.38 -4.62]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  13  Desbalance de caudales: 2.136848


-----Iteración número:  14 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.73  145742 0.01670   1.15  0.14   2414.66
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.42   82523 0.01877   0.41  0.00   2423.11
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.22   43916 0.02153   0.13  0.01   2986.72
-------------------------------------------------------------------------------------------
Matriz [A]
[[  55.67    0.      0.  ]
 [   0.   4133.63    0.  ]
 [   0.      0.    -20.75]]

Matriz [A1]
[[ 55.67   0.     0.  ]
 [  0.    31.63   0.  ]
 [  0.     0.   -20.75]]

Matriz [qfi]
[-23.05  -6.95]

Matriz [Hi]
[108.75  55.14]

Matriz [Qi]
[23.05 13.05 -6.95]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  14  Desbalance de caudales: 2.330991


-----Iteración número:  15 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.64  127449 0.01716   0.90  0.10   2473.43
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.32   64229 0.01980   0.26  0.00   2556.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.31   62210 0.01994   0.25  0.02   2780.74
-------------------------------------------------------------------------------------------
Matriz [A]
[[  49.86    0.      0.  ]
 [   0.   5331.91    0.  ]
 [   0.      0.    -27.36]]

Matriz [A1]
[[ 49.86   0.     0.  ]
 [  0.    25.97   0.  ]
 [  0.     0.   -27.36]]

Matriz [qfi]
[-20.16  -9.84]

Matriz [Hi]
[109.04  55.26]

Matriz [Qi]
[20.16 10.16 -9.84]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  15  Desbalance de caudales: 2.893624


-----Iteración número:  16 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.50   98410 0.01809   0.57  0.06   2593.74
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.18   35190 0.02265   0.09  0.00   2923.96
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.46   91248 0.01838   0.49  0.04   2579.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[  40.38    0.      0.  ]
 [   0.   9790.55    0.  ]
 [   0.      0.    -37.23]]

Matriz [A1]
[[ 40.38   0.     0.  ]
 [  0.    16.28   0.  ]
 [  0.     0.   -37.23]]

Matriz [qfi]
[-15.57 -14.43]

Matriz [Hi]
[109.45  55.52]

Matriz [Qi]
[ 15.57   5.57 -14.43]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  16  Desbalance de caudales: 4.593325


-----Iteración número:  17 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.05    9628 0.03121   0.01  0.00   4287.17
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -0.37   72847 0.01927   0.33  0.00   2488.12
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.00  199286 0.01571   2.02  0.21   2234.75
-------------------------------------------------------------------------------------------
Matriz [A]
[[   -6.53     0.       0.  ]
 [    0.   -4852.65     0.  ]
 [    0.       0.     -70.45]]

Matriz [A1]
[[ -6.53   0.     0.  ]
 [  0.   -28.67   0.  ]
 [  0.     0.   -70.45]]

Matriz [qfi]
[  1.52 -31.52]

Matriz [Hi]
[110.75  56.81]

Matriz [Qi]
[ -1.52 -11.52 -31.52]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  17  Desbalance de caudales: 17.089311


-----Iteración número:  18 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.43   84540 0.01867   0.43  0.05   2669.02
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.11   21321 0.02550   0.04  0.00   3292.01
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.53  105118 0.01785   0.64  0.06   2510.51
-------------------------------------------------------------------------------------------
Matriz [A]
[[   35.69     0.       0.  ]
 [    0.   16368.69     0.  ]
 [    0.       0.     -41.74]]

Matriz [A1]
[[ 35.69   0.     0.  ]
 [  0.    11.1    0.  ]
 [  0.     0.   -41.74]]

Matriz [qfi]
[-13.37 -16.63]

Matriz [Hi]
[110.18  55.12]

Matriz [Qi]
[ 13.37   3.37 -16.63]

Matriz [dq]
[0.01 0.01 0.01]


-----Fin iteración:  18  Desbalance de caudales: 14.895401


-----Iteración número:  19 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -3.91  775852 0.01231  23.94  3.89   1847.79
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -4.22  839071 0.01215  27.64  0.00   1569.23
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -4.86  965510 0.01188  35.78  4.82   1740.50
-------------------------------------------------------------------------------------------
Matriz [A]
[[-226.77    0.      0.  ]
 [   0.   -588.13    0.  ]
 [   0.      0.   -265.82]]

Matriz [A1]
[[-226.77    0.      0.  ]
 [   0.   -208.27    0.  ]
 [   0.      0.   -265.82]]

Matriz [qfi]
[ 122.72 -152.72]

Matriz [Hi]
[119.24  67.06]

Matriz [Qi]
[-122.72 -132.72 -152.72]

Matriz [dq]
[-0.14 -0.14 -0.14]


-----Fin iteración:  19  Desbalance de caudales: 136.096087


-----Iteración número:  20 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -1.83  363240 0.01404   5.99  0.85   2071.14
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -2.15  426459 0.01364   8.02  0.00   1761.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -2.78  552898 0.01304  12.87  1.58   1889.77
-------------------------------------------------------------------------------------------
Matriz [A]
[[-119.      0.      0.  ]
 [   0.   -901.      0.  ]
 [   0.      0.   -165.27]]

Matriz [A1]
[[-119.      0.      0.  ]
 [   0.   -118.83    0.  ]
 [   0.      0.   -165.27]]

Matriz [qfi]
[ 57.46 -87.46]

Matriz [Hi]
[111.77  60.9 ]

Matriz [Qi]
[-57.46 -67.46 -87.46]

Matriz [dq]
[0.07 0.07 0.07]


-----Fin iteración:  20  Desbalance de caudales: 65.266600


-----Iteración número:  21 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.76  150962 0.01659   1.22  0.15   2399.62
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -1.08  214182 0.01549   2.30  0.00   2000.30
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.72  340620 0.01421   5.32  0.60   2040.79
-------------------------------------------------------------------------------------------
Matriz [A]
[[  -57.3      0.       0.  ]
 [    0.   -1691.37     0.  ]
 [    0.       0.    -109.96]]

Matriz [A1]
[[ -57.3     0.      0.  ]
 [   0.    -67.77    0.  ]
 [   0.      0.   -109.96]]

Matriz [qfi]
[ 23.88 -53.88]

Matriz [Hi]
[111.15  58.36]

Matriz [Qi]
[-23.88 -33.88 -53.88]

Matriz [dq]
[0.03 0.03 0.03]


-----Fin iteración:  21  Desbalance de caudales: 33.577928


-----Iteración número:  22 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  -0.11   21917 0.02533   0.04  0.00   3528.25
  1   2  3   500  200 0.0015  0.0  VR  0.0314  -0.43   85137 0.01865   0.44  0.00   2407.25
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -1.07  211576 0.01553   2.25  0.23   2211.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[  -12.23     0.       0.  ]
 [    0.   -4172.41     0.  ]
 [    0.       0.     -74.01]]

Matriz [A1]
[[-12.23   0.     0.  ]
 [  0.   -32.42   0.  ]
 [  0.     0.   -74.01]]

Matriz [qfi]
[  3.47 -33.47]

Matriz [Hi]
[110.97  56.44]

Matriz [Qi]
[ -3.47 -13.47 -33.47]

Matriz [dq]
[0.02 0.02 0.02]


-----Fin iteración:  22  Desbalance de caudales: 20.412200


-----Iteración número:  23 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.39   76875 0.01905   0.36  0.04   2717.97
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.07   13655 0.02849   0.02  0.00   3678.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.57  112784 0.01759   0.72  0.07   2477.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[   33.05     0.       0.  ]
 [    0.   25624.56     0.  ]
 [    0.       0.     -44.2 ]]

Matriz [A1]
[[ 33.05   0.     0.  ]
 [  0.     7.95   0.  ]
 [  0.     0.   -44.2 ]]

Matriz [qfi]
[-12.16 -17.84]

Matriz [Hi]
[110.34  55.16]

Matriz [Qi]
[ 12.16   2.16 -17.84]

Matriz [dq]
[0.02 0.02 0.02]


-----Fin iteración:  23  Desbalance de caudales: 15.626843


-----Iteración número:  24 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   8.03 1595713 0.01099  90.42 16.45   1677.47
  1   2  3   500  200 0.0015  0.0  VR  0.0314   7.72 1532494 0.01106  83.90  0.00   1427.83
  2   3  1   500  200 0.0015  4.0  TA  0.0314   7.08 1406055 0.01120  71.55 10.22   1653.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[423.41   0.     0.  ]
 [  0.   346.12   0.  ]
 [  0.     0.   367.65]]

Matriz [A1]
[[423.41   0.     0.  ]
 [  0.   346.12   0.  ]
 [  0.     0.   367.65]]

Matriz [qfi]
[-252.41  222.41]

Matriz [Hi]
[93.72 34.55]

Matriz [Qi]
[252.41 242.41 222.41]

Matriz [dq]
[0.24 0.24 0.24]


-----Fin iteración:  24  Desbalance de caudales: 240.248628


-----Iteración número:  25 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.99  991018 0.01183  37.54  6.35   1785.75
  1   2  3   500  200 0.0015  0.0  VR  0.0314   4.67  927798 0.01196  33.25  0.00   1543.80
  2   3  1   500  200 0.0015  4.0  TA  0.0314   4.03  801359 0.01225  25.40  3.32   1787.69
-------------------------------------------------------------------------------------------
Matriz [A]
[[279.93   0.     0.  ]
 [  0.   311.75   0.  ]
 [  0.     0.   226.6 ]]

Matriz [A1]
[[279.93   0.     0.  ]
 [  0.   226.57   0.  ]
 [  0.     0.   226.6 ]]

Matriz [qfi]
[-156.76  126.76]

Matriz [Hi]
[84.13 66.44]

Matriz [Qi]
[156.76 146.76 126.76]

Matriz [dq]
[-0.1 -0.1 -0.1]


-----Fin iteración:  25  Desbalance de caudales: 95.650243


-----Iteración número:  26 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.61  717835 0.01247  20.76  3.33   1868.45
  1   2  3   500  200 0.0015  0.0  VR  0.0314   3.30  654616 0.01267  17.53  0.00   1635.37
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.66  528177 0.01314  11.84  1.44   1903.14
-------------------------------------------------------------------------------------------
Matriz [A]
[[212.16   0.     0.  ]
 [  0.   425.68   0.  ]
 [  0.     0.   159.  ]]

Matriz [A1]
[[212.16   0.     0.  ]
 [  0.   169.34   0.  ]
 [  0.     0.   159.  ]]

Matriz [qfi]
[-113.55   83.55]

Matriz [Hi]
[90.31 64.14]

Matriz [Qi]
[113.55 103.55  83.55]

Matriz [dq]
[-0.04 -0.04 -0.04]


-----Fin iteración:  26  Desbalance de caudales: 43.211742


-----Iteración número:  27 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.84  563137 0.01300  13.31  2.05   1936.10
  1   2  3   500  200 0.0015  0.0  VR  0.0314   2.52  499918 0.01327  10.71  0.00   1712.88
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.88  373479 0.01397   6.30  0.72   2010.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[172.46   0.     0.  ]
 [  0.   589.92   0.  ]
 [  0.     0.   118.77]]

Matriz [A1]
[[172.46   0.     0.  ]
 [  0.   135.45   0.  ]
 [  0.     0.   118.77]]

Matriz [qfi]
[-89.08  59.08]

Matriz [Hi]
[96.29 60.5 ]

Matriz [Qi]
[89.08 79.08 59.08]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  27  Desbalance de caudales: 24.470064


-----Iteración número:  28 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   2.31  459217 0.01347   9.17  1.36   1996.79
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.99  395998 0.01383   7.00  0.00   1784.96
  2   3  1   500  200 0.0015  4.0  TA  0.0314   1.36  269559 0.01483   3.48  0.38   2121.73
-------------------------------------------------------------------------------------------
Matriz [A]
[[145.04   0.     0.  ]
 [  0.   779.22   0.  ]
 [  0.     0.    90.47]]

Matriz [A1]
[[145.04   0.     0.  ]
 [  0.   111.81   0.  ]
 [  0.     0.    90.47]]

Matriz [qfi]
[-72.64  42.64]

Matriz [Hi]
[100.31  58.11]

Matriz [Qi]
[72.64 62.64 42.64]

Matriz [dq]
[-0.02 -0.02 -0.02]


-----Fin iteración:  28  Desbalance de caudales: 16.437926


-----Iteración número:  29 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.94  384566 0.01390   6.64  0.96   2052.58
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.62  321346 0.01436   4.79  0.00   1853.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.98  194908 0.01578   1.94  0.20   2243.47
-------------------------------------------------------------------------------------------
Matriz [A]
[[124.86   0.     0.  ]
 [  0.   989.26   0.  ]
 [  0.     0.    69.17]]

Matriz [A1]
[[124.86   0.     0.  ]
 [  0.    94.23   0.  ]
 [  0.     0.    69.17]]

Matriz [qfi]
[-60.83  30.83]

Matriz [Hi]
[102.89  56.72]

Matriz [Qi]
[60.83 50.83 30.83]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  29  Desbalance de caudales: 11.808308


-----Iteración número:  30 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.66  329603 0.01429   5.02  0.70   2103.47
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.34  266384 0.01487   3.41  0.00   1919.41
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.70  139945 0.01684   1.07  0.10   2380.55
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 109.67    0.      0.  ]
 [   0.   1217.      0.  ]
 [   0.      0.     52.7 ]]

Matriz [A1]
[[109.67   0.     0.  ]
 [  0.    80.88   0.  ]
 [  0.     0.    52.7 ]]

Matriz [qfi]
[-52.14  22.14]

Matriz [Hi]
[104.58  55.93]

Matriz [Qi]
[52.14 42.14 22.14]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  30  Desbalance de caudales: 8.693977


-----Iteración número:  31 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.45  288487 0.01465   3.94  0.54   2149.32
  1   2  3   500  200 0.0015  0.0  VR  0.0314   1.13  225268 0.01535   2.52  0.00   1981.12
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.50   98829 0.01807   0.57  0.05   2540.04
-------------------------------------------------------------------------------------------
Matriz [A]
[[  98.08    0.      0.  ]
 [   0.   1458.4     0.  ]
 [   0.      0.     39.71]]

Matriz [A1]
[[98.08  0.    0.  ]
 [ 0.   70.59  0.  ]
 [ 0.    0.   39.71]]

Matriz [qfi]
[-45.63  15.63]

Matriz [Hi]
[105.71  55.48]

Matriz [Qi]
[45.63 35.63 15.63]

Matriz [dq]
[-0.01 -0.01 -0.01]


-----Fin iteración:  31  Desbalance de caudales: 6.503680


-----Iteración número:  32 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.29  257195 0.01497   3.20  0.43   2190.29
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.98  193975 0.01579   1.92  0.00   2038.79
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.34   67536 0.01959   0.29  0.02   2735.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[  89.11    0.      0.  ]
 [   0.   1709.59    0.  ]
 [   0.      0.     29.22]]

Matriz [A1]
[[89.11  0.    0.  ]
 [ 0.   62.56  0.  ]
 [ 0.    0.   29.22]]

Matriz [qfi]
[-40.68  10.68]

Matriz [Hi]
[106.5   55.23]

Matriz [Qi]
[40.68 30.68 10.68]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  32  Desbalance de caudales: 4.949814


-----Iteración número:  33 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.17  232864 0.01525   2.67  0.35   2226.88
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.85  169644 0.01621   1.51  0.00   2092.70
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.22   43205 0.02161   0.13  0.01   2996.96
-------------------------------------------------------------------------------------------
Matriz [A]
[[  82.03    0.      0.  ]
 [   0.   1968.17    0.  ]
 [   0.      0.     20.48]]

Matriz [A1]
[[82.03  0.    0.  ]
 [ 0.   56.16  0.  ]
 [ 0.    0.   20.48]]

Matriz [qfi]
[-36.83   6.83]

Matriz [Hi]
[107.06  55.09]

Matriz [Qi]
[36.83 26.83  6.83]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  33  Desbalance de caudales: 3.848670


-----Iteración número:  34 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   1.07  213429 0.01550   2.28  0.29   2259.86
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.76  150210 0.01660   1.21  0.00   2143.54
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.12   23771 0.02484   0.05  0.00   3413.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[  76.29    0.      0.  ]
 [   0.   2234.34    0.  ]
 [   0.      0.     12.83]]

Matriz [A1]
[[76.29  0.    0.  ]
 [ 0.   50.93  0.  ]
 [ 0.    0.   12.83]]

Matriz [qfi]
[-33.76   3.76]

Matriz [Hi]
[107.48  55.01]

Matriz [Qi]
[33.76 23.76  3.76]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  34  Desbalance de caudales: 3.074161


-----Iteración número:  35 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.99  197361 0.01574   1.98  0.25   2290.19
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.68  134142 0.01698   0.99  0.00   2192.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314   0.04    7703 0.03314   0.01  0.00   4484.93
-------------------------------------------------------------------------------------------
Matriz [A]
[[  71.5     0.      0.  ]
 [   0.   2512.24    0.  ]
 [   0.      0.      5.46]]

Matriz [A1]
[[71.5   0.    0.  ]
 [ 0.   46.52  0.  ]
 [ 0.    0.    5.46]]

Matriz [qfi]
[-31.22   1.22]

Matriz [Hi]
[107.81  54.98]

Matriz [Qi]
[31.22 21.22  1.22]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  35  Desbalance de caudales: 2.541616


-----Iteración número:  36 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.92  183426 0.01596   1.74  0.22   2319.23
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.61  120206 0.01736   0.81  0.00   2241.62
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.03    6233 0.03514   0.00  0.00   4742.71
-------------------------------------------------------------------------------------------
Matriz [A]
[[  67.29    0.      0.  ]
 [   0.   2813.09    0.  ]
 [   0.      0.     -4.68]]

Matriz [A1]
[[67.29  0.    0.  ]
 [ 0.   42.62  0.  ]
 [ 0.    0.   -4.68]]

Matriz [qfi]
[-29.01  -0.99]

Matriz [Hi]
[108.08  54.98]

Matriz [Qi]
[29.01 19.01 -0.99]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  36  Desbalance de caudales: 2.204279


-----Iteración número:  37 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.86  170047 0.01620   1.51  0.19   2349.93
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.54  106828 0.01779   0.66  0.00   2296.30
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.10   19611 0.02602   0.03  0.00   3566.46
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.21    0.      0.  ]
 [   0.   3175.54    0.  ]
 [   0.      0.    -11.06]]

Matriz [A1]
[[ 63.21   0.     0.  ]
 [  0.    38.8    0.  ]
 [  0.     0.   -11.06]]

Matriz [qfi]
[-26.9  -3.1]

Matriz [Hi]
[108.33  55.02]

Matriz [Qi]
[26.9 16.9 -3.1]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  37  Desbalance de caudales: 2.116152


-----Iteración número:  38 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.79  156327 0.01647   1.30  0.16   2384.86
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.47   93108 0.01830   0.51  0.00   2362.57
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.17   33331 0.02293   0.08  0.01   3167.43
-------------------------------------------------------------------------------------------
Matriz [A]
[[  58.97    0.      0.  ]
 [   0.   3655.04    0.  ]
 [   0.      0.    -16.7 ]]

Matriz [A1]
[[ 58.97   0.     0.  ]
 [  0.    34.8    0.  ]
 [  0.     0.   -16.7 ]]

Matriz [qfi]
[-24.73  -5.27]

Matriz [Hi]
[108.57  55.08]

Matriz [Qi]
[24.73 14.73 -5.27]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  38  Desbalance de caudales: 2.170269


-----Iteración número:  39 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.71  140877 0.01682   1.08  0.13   2429.31
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.39   77657 0.01901   0.37  0.00   2454.47
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.25   48782 0.02103   0.16  0.01   2922.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[  54.13    0.      0.  ]
 [   0.   4397.28    0.  ]
 [   0.      0.    -22.55]]

Matriz [A1]
[[ 54.13   0.     0.  ]
 [  0.    30.15   0.  ]
 [  0.     0.   -22.55]]

Matriz [qfi]
[-22.28  -7.72]

Matriz [Hi]
[108.83  55.17]

Matriz [Qi]
[22.28 12.28 -7.72]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  39  Desbalance de caudales: 2.443946


-----Iteración número:  40 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.61  120628 0.01735   0.82  0.09   2498.23
  1   2  3   500  200 0.0015  0.0  VR  0.0314   0.29   57408 0.02029   0.22  0.00   2619.65
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.35   69030 0.01950   0.30  0.02   2723.54
-------------------------------------------------------------------------------------------
Matriz [A]
[[  47.67    0.      0.  ]
 [   0.   5973.96    0.  ]
 [   0.      0.    -29.74]]

Matriz [A1]
[[ 47.67   0.     0.  ]
 [  0.    23.79   0.  ]
 [  0.     0.   -29.74]]

Matriz [qfi]
[-19.08 -10.92]

Matriz [Hi]
[109.14  55.32]

Matriz [Qi]
[ 19.08   9.08 -10.92]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  40  Desbalance de caudales: 3.202932

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Qmax-VR.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1    50.00      55.00     5.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    50.00      10.00     1.00 
  3    50.00      20.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  3     500   200  0.0314  0.0015   0.0    VR   5 
  2    3  1     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00   -19.08
  1    50.00      55.00     5.00   -10.92
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    50.00      10.00    1.00    10.00     109.14    59.14
  3    50.00      20.00    1.00    20.00      55.32     5.32
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     0.61   19.08    0.82    0.09    0.91   0.00182 
  1    2  3     0.29    9.08    0.22    0.00    0.22   0.00043 HVR=-54.03
  2    3  1    -0.35  -10.92    0.30    0.02    0.32   0.00065 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:02 2022
crcs-2022
...
 
Procesando archivo N° 12 : ./input/Qmax-VS.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[110.0, 55.0, 10.0, 20.0]

Matriz [Ho]
[110.  55.]

Matriz [qi]
[10. 20.]

Matriz [B]
[[ 1.  0.]
 [-1.  1.]
 [ 0. -1.]]

Matriz [C]
[[-1.  0.]
 [ 0.  0.]
 [ 0.  1.]]

Matriz [Q]
[100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.18  632194 0.01274  16.45  2.58   1903.26
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.18  632194 0.01274  16.45  0.00   1645.05
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.18  632194 0.01274  16.45  2.07   1851.62
-------------------------------------------------------------------------------------------

Matriz [A]
[[ 190.33    0.      0.  ]
 [   0.   1146.76    0.  ]
 [   0.      0.    185.16]]

Matriz [A1]
[[190.33   0.     0.  ]
 [  0.   164.51   0.  ]
 [  0.     0.   185.16]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   0.74  147361 0.01667   1.17  0.14   2409.92
  1   2  3   500  200 0.0015  0.0  VS  0.0314   0.42   84142 0.01869   0.43  0.00   2413.21
  2   3  1   500  200 0.0015  4.0  TA  0.0314  -0.21   42297 0.02172   0.13  0.01   3010.37
-------------------------------------------------------------------------------------------
Matriz [A]
[[ 56.17   0.     0.  ]
 [  0.    32.12   0.  ]
 [  0.     0.   -20.14]]

Matriz [A1]
[[ 56.17   0.     0.  ]
 [  0.    32.12   0.  ]
 [  0.     0.   -20.14]]

Matriz [qfi]
[-23.31  -6.69]

Matriz [Hi]
[120.16  34.01]

Matriz [Qi]
[23.31 13.31 -6.69]

Matriz [dq]
[-0.08 -0.09 -0.11]


-----Fin iteración:   1  Desbalance de caudales: 86.690530


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314  13.15 2611537 0.01025 225.83 44.06   1581.58
  1   2  3   500  200 0.0015  0.0  VS  0.0314  12.83 2548318 0.01028 215.74  0.00   1327.78
  2   3  1   500  200 0.0015  4.0  TA  0.0314  12.19 2421879 0.01036 196.22 30.32   1543.60
-------------------------------------------------------------------------------------------
Matriz [A]
[[653.34   0.     0.  ]
 [  0.   865.09   0.  ]
 [  0.     0.   591.34]]

Matriz [A1]
[[653.34   0.     0.  ]
 [  0.   535.21   0.  ]
 [  0.     0.   591.34]]

Matriz [qfi]
[-413.09  383.09]

Matriz [Hi]
[64.9  39.43]

Matriz [Qi]
[413.09 403.09 383.09]

Matriz [dq]
[0.39 0.39 0.39]


-----Fin iteración:   2  Desbalance de caudales: 389.781376


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   6.08 1208309 0.01147  54.08  9.43   1738.75
  1   2  3   500  200 0.0015  0.0  VS  0.0314   5.77 1145089 0.01156  48.98  0.00   1493.00
  2   3  1   500  200 0.0015  4.0  TA  0.0314   5.13 1018650 0.01178  39.49  5.36   1727.42
-------------------------------------------------------------------------------------------
Matriz [A]
[[332.33   0.     0.  ]
 [  0.   270.43   0.  ]
 [  0.     0.   278.34]]

Matriz [A1]
[[332.33   0.     0.  ]
 [  0.   270.43   0.  ]
 [  0.     0.   278.34]]

Matriz [qfi]
[-191.13  161.13]

Matriz [Hi]
[130.14  19.03]

Matriz [Qi]
[191.13 181.13 161.13]

Matriz [dq]
[-0.22 -0.22 -0.22]


-----Fin iteración:   3  Desbalance de caudales: 221.961567


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   4.24  841129 0.01215  27.77  4.57   1826.81
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.92  777910 0.01231  24.06  0.00   1588.89
  2   3  1   500  200 0.0015  4.0  TA  0.0314   3.28  651471 0.01268  17.38  2.19   1843.27
-------------------------------------------------------------------------------------------
Matriz [A]
[[243.06   0.     0.  ]
 [  0.   333.2    0.  ]
 [  0.     0.   189.95]]

Matriz [A1]
[[243.06   0.     0.  ]
 [  0.   195.51   0.  ]
 [  0.     0.   189.95]]

Matriz [qfi]
[-133.05  103.05]

Matriz [Hi]
[85.09 67.52]

Matriz [Qi]
[133.05 123.05 103.05]

Matriz [dq]
[-0.06 -0.06 -0.06]


-----Fin iteración:   4  Desbalance de caudales: 58.080106


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.28  650456 0.01268  17.33  2.73   1895.35
  1   2  3   500  200 0.0015  0.0  VS  0.0314   2.96  587237 0.01290  14.37  0.00   1665.87
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.32  460798 0.01346   9.23  1.10   1944.10
-------------------------------------------------------------------------------------------
Matriz [A]
[[195.01   0.     0.  ]
 [  0.   207.1    0.  ]
 [  0.     0.   141.7 ]]

Matriz [A1]
[[195.01   0.     0.  ]
 [  0.   154.74   0.  ]
 [  0.     0.   141.7 ]]

Matriz [qfi]
[-102.89   72.89]

Matriz [Hi]
[92.32 63.12]

Matriz [Qi]
[102.89  92.89  72.89]

Matriz [dq]
[-0.03 -0.03 -0.03]


-----Fin iteración:   5  Desbalance de caudales: 30.160537


-----Iteración número:   6 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.45  684994 0.01257  19.05  3.03   1881.13
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.13  621775 0.01278  15.96  0.00   1649.70
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.49  495336 0.01329  10.53  1.27   1922.20
-------------------------------------------------------------------------------------------
Matriz [A]
[[203.82   0.     0.  ]
 [  0.   265.7    0.  ]
 [  0.     0.   150.61]]

Matriz [A1]
[[203.82   0.     0.  ]
 [  0.   162.25   0.  ]
 [  0.     0.   150.61]]

Matriz [qfi]
[-108.35   78.35]

Matriz [Hi]
[87.8  66.88]

Matriz [Qi]
[108.35  98.35  78.35]

Matriz [dq]
[0.01 0.01 0.01]


-----Fin iteración:   6  Desbalance de caudales: 5.463183


-----Iteración número:   7 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.29  654303 0.01267  17.52  2.77   1893.72
  1   2  3   500  200 0.0015  0.0  VS  0.0314   2.98  591083 0.01289  14.55  0.00   1664.01
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.34  464644 0.01344   9.37  1.12   1941.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[195.99   0.     0.  ]
 [  0.   234.5    0.  ]
 [  0.     0.   142.7 ]]

Matriz [A1]
[[195.99   0.     0.  ]
 [  0.   155.58   0.  ]
 [  0.     0.   142.7 ]]

Matriz [qfi]
[-103.5   73.5]

Matriz [Hi]
[89.89 65.34]

Matriz [Qi]
[103.5  93.5  73.5]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   7  Desbalance de caudales: 4.854767


-----Iteración número:   8 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.37  669025 0.01262  18.25  2.89   1887.59
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.05  605806 0.01283  15.22  0.00   1657.03
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.41  479367 0.01337   9.92  1.19   1932.07
-------------------------------------------------------------------------------------------
Matriz [A]
[[199.76   0.     0.  ]
 [  0.   250.68   0.  ]
 [  0.     0.   146.5 ]]

Matriz [A1]
[[199.76   0.     0.  ]
 [  0.   158.79   0.  ]
 [  0.     0.   146.5 ]]

Matriz [qfi]
[-105.83   75.83]

Matriz [Hi]
[88.8  66.15]

Matriz [Qi]
[105.83  95.83  75.83]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:   8  Desbalance de caudales: 2.328854


-----Iteración número:   9 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.33  661081 0.01265  17.85  2.82   1890.87
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.01  597861 0.01286  14.85  0.00   1660.77
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.37  471422 0.01340   9.62  1.15   1937.14
-------------------------------------------------------------------------------------------
Matriz [A]
[[197.73   0.     0.  ]
 [  0.   242.32   0.  ]
 [  0.     0.   144.45]]

Matriz [A1]
[[197.73   0.     0.  ]
 [  0.   157.06   0.  ]
 [  0.     0.   144.45]]

Matriz [qfi]
[-104.57   74.57]

Matriz [Hi]
[89.36 65.74]

Matriz [Qi]
[104.57  94.57  74.57]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:   9  Desbalance de caudales: 1.256694


-----Iteración número:  10 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.35  665106 0.01263  18.05  2.86   1889.20
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.03  601887 0.01285  15.04  0.00   1658.87
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  475448 0.01338   9.77  1.17   1934.56
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.76   0.     0.  ]
 [  0.   246.65   0.  ]
 [  0.     0.   145.49]]

Matriz [A1]
[[198.76   0.     0.  ]
 [  0.   157.93   0.  ]
 [  0.     0.   145.49]]

Matriz [qfi]
[-105.21   75.21]

Matriz [Hi]
[89.07 65.96]

Matriz [Qi]
[105.21  95.21  75.21]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:  10  Desbalance de caudales: 0.636728


-----Iteración número:  11 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663002 0.01264  17.95  2.84   1890.07
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  599782 0.01286  14.94  0.00   1659.86
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.38  473343 0.01339   9.69  1.16   1935.91
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.22   0.     0.  ]
 [  0.   244.41   0.  ]
 [  0.     0.   144.95]]

Matriz [A1]
[[198.22   0.     0.  ]
 [  0.   157.48   0.  ]
 [  0.     0.   144.95]]

Matriz [qfi]
[-104.87   74.87]

Matriz [Hi]
[89.22 65.84]

Matriz [Qi]
[104.87  94.87  74.87]

Matriz [dq]
[-0. -0. -0.]


-----Fin iteración:  11  Desbalance de caudales: 0.332856


-----Iteración número:  12 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  664084 0.01264  18.00  2.85   1889.62
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.03  600864 0.01285  14.99  0.00   1659.35
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474426 0.01339   9.74  1.16   1935.21
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.49   0.     0.  ]
 [  0.   245.57   0.  ]
 [  0.     0.   145.23]]

Matriz [A1]
[[198.49   0.     0.  ]
 [  0.   157.71   0.  ]
 [  0.     0.   145.23]]

Matriz [qfi]
[-105.04   75.04]

Matriz [Hi]
[89.14 65.9 ]

Matriz [Qi]
[105.04  95.04  75.04]

Matriz [dq]
[0. 0. 0.]


-----Fin iteración:  12  Desbalance de caudales: 0.171158


-----Iteración número:  13 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663523 0.01264  17.97  2.84   1889.86
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600303 0.01285  14.96  0.00   1659.61
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  473864 0.01339   9.71  1.16   1935.57
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.35   0.     0.  ]
 [  0.   244.97   0.  ]
 [  0.     0.   145.08]]

Matriz [A1]
[[198.35   0.     0.  ]
 [  0.   157.59   0.  ]
 [  0.     0.   145.08]]

Matriz [qfi]
[-104.96   74.96]

Matriz [Hi]
[89.18 65.87]

Matriz [Qi]
[104.96  94.96  74.96]

Matriz [dq]
[-8.88e-05 -8.88e-05 -8.88e-05]


-----Fin iteración:  13  Desbalance de caudales: 0.088758


-----Iteración número:  14 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663812 0.01264  17.99  2.85   1889.74
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600593 0.01285  14.98  0.00   1659.48
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474154 0.01339   9.72  1.16   1935.39
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.42   0.     0.  ]
 [  0.   245.28   0.  ]
 [  0.     0.   145.16]]

Matriz [A1]
[[198.42   0.     0.  ]
 [  0.   157.65   0.  ]
 [  0.     0.   145.16]]

Matriz [qfi]
[-105.   75.]

Matriz [Hi]
[89.16 65.89]

Matriz [Qi]
[105.  95.  75.]

Matriz [dq]
[4.58e-05 4.58e-05 4.58e-05]


-----Fin iteración:  14  Desbalance de caudales: 0.045826


-----Iteración número:  15 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663663 0.01264  17.98  2.85   1889.80
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600443 0.01285  14.97  0.00   1659.55
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474004 0.01339   9.72  1.16   1935.48
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.39   0.     0.  ]
 [  0.   245.12   0.  ]
 [  0.     0.   145.12]]

Matriz [A1]
[[198.39   0.     0.  ]
 [  0.   157.62   0.  ]
 [  0.     0.   145.12]]

Matriz [qfi]
[-104.98   74.98]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.98  94.98  74.98]

Matriz [dq]
[-2.37e-05 -2.37e-05 -2.37e-05]


-----Fin iteración:  15  Desbalance de caudales: 0.023714


-----Iteración número:  16 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663740 0.01264  17.98  2.85   1889.77
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600521 0.01285  14.97  0.00   1659.51
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474082 0.01339   9.72  1.16   1935.43
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.41   0.     0.  ]
 [  0.   245.2    0.  ]
 [  0.     0.   145.14]]

Matriz [A1]
[[198.41   0.     0.  ]
 [  0.   157.64   0.  ]
 [  0.     0.   145.14]]

Matriz [qfi]
[-104.99   74.99]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.99  94.99  74.99]

Matriz [dq]
[1.23e-05 1.23e-05 1.23e-05]


-----Fin iteración:  16  Desbalance de caudales: 0.012257


-----Iteración número:  17 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  2   500  200 0.0015  5.0  TA  0.0314   3.34  663700 0.01264  17.98  2.85   1889.78
  1   2  3   500  200 0.0015  0.0  VS  0.0314   3.02  600480 0.01285  14.97  0.00   1659.53
  2   3  1   500  200 0.0015  4.0  TA  0.0314   2.39  474042 0.01339   9.72  1.16   1935.46
-------------------------------------------------------------------------------------------
Matriz [A]
[[198.4    0.     0.  ]
 [  0.   245.16   0.  ]
 [  0.     0.   145.13]]

Matriz [A1]
[[198.4    0.     0.  ]
 [  0.   157.63   0.  ]
 [  0.     0.   145.13]]

Matriz [qfi]
[-104.98   74.98]

Matriz [Hi]
[89.17 65.88]

Matriz [Qi]
[104.98  94.98  74.98]

Matriz [dq]
[-6.34e-06 -6.34e-06 -6.34e-06]


-----Fin iteración:  17  Desbalance de caudales: 0.006339

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Qmax-VS.mgh.json
Titulo:      Ejercicio caudal máximo con valvula de control
Autor:       Carlos Camacho Soto
Fecha:       6-set-2022
Versión:     v1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   100.00     110.00    10.00 
  1    50.00      55.00     5.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  2    50.00      10.00     1.00 
  3    50.00      20.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  2     500   200  0.0314  0.0015   5.0    TA   - 
  1    2  3     500   200  0.0314  0.0015   0.0    VS   40 
  2    3  1     500   200  0.0314  0.0015   4.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   100.00     110.00    10.00  -104.98
  1    50.00      55.00     5.00    74.98
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  2    50.00      10.00    1.00    10.00      89.17    39.17
  3    50.00      20.00    1.00    20.00      65.88    15.88
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  2     3.34  104.98   17.98    2.85   20.83   0.04166 
  1    2  3     3.02   94.98   14.97    0.00   14.97   0.02994 HVS=-8.31
  2    3  1     2.39   74.98    9.72    1.16   10.88   0.02176 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:02 2022
crcs-2022
...
 
Procesando archivo N° 13 : ./input/Red-mixta.mgh.json
-------------------------------------
MÉTODO DEL GRADIENTE HIDRÁULICO

Modo de ejecución: Impresión detallada
--
Topología de nudos OK

----- INICIO DEL CÁLCULO -----

----- Iteración inicial -----
Matriz [q]
[120.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 8.0, 7.0]

Matriz [Ho]
[120.]

Matriz [qi]
[10. 10. 10. 10. 10. 10.  8.  7.]

Matriz [B]
[[ 1.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  1.  0.  0.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.  0.]
 [ 0. -1.  1.  0.  0.  0.  0.  0.]
 [ 0.  0.  1. -1.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  1.  0.  0.  0.]
 [ 0.  0.  0.  0. -1.  1.  0.  0.]
 [ 0.  0.  0.  0.  0. -1.  0.  1.]
 [ 0.  0.  0.  0.  0. -1.  1.  0.]]

Matriz [C]
[[-1.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]
 [ 0.]]

Matriz [Q]
[100. 100. 100. 100. 100. 100. 100. 100. 100.]


Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   3.18  632194 0.01274   6.58  1.55    812.95
  1   1  2   500  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  66.35  4.90   7124.26
  2   1  4   300  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  39.81  4.90   4470.41
  3   2  3   300  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 286.88 24.79  31167.22
  4   4  3   500  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 478.14 24.79  50292.83
  5   2  5   200  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  26.54  4.90   3143.49
  6   5  6   250  150 0.0015  3.0  TA  0.0177   5.66  842926 0.01219  33.17  4.90   3806.95
  7   6  8   150  100 0.0015  3.0  TA  0.0079  12.73 1264389 0.01157 143.44 24.79  16823.01
  8   6  7   150   75 0.0015 10.0  TA  0.0044  22.64 1685852 0.01126 588.22 261.14  84936.36
-------------------------------------------------------------------------------------------

Matriz [A]
[[  81.29    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    712.43    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    447.04    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   3116.72    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   5029.28    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    314.35    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    380.69    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.   1682.3     0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.   8493.64]]

Matriz [A1]
[[  81.29    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    712.43    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    447.04    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   3116.72    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   5029.28    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    314.35    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    380.69    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.   1682.3     0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.   8493.64]]

----Inician las iteraciones----


-----Iteración número:   1 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.21  329329 0.01432  11.89  0.75   8281.79
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.47  218573 0.01546   3.39  0.33   5534.61
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.76   74982 0.01919   1.67  0.09  50041.89
  4   4  3   500  100 0.0015  3.0  TA  0.0079   2.03  201421 0.01574  16.50  0.63  67500.64
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    323.57    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    143.51    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -296.76    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1075.31    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    323.57    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    143.51    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -296.76    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.   1075.31    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.94 131.51 480.15 137.46 140.94 159.97 873.44 304.65]

Matriz [Qi]
[75.   39.07 25.93 -5.93 15.93 35.   25.    7.    8.  ]

Matriz [dq]
[-0.02 -0.06 -0.07 -0.11 -0.08 -0.06 -0.07 -0.09 -0.09]


-----Fin iteración:   1  Desbalance de caudales: 105.930309


-----Iteración número:   2 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.36  351152 0.01416  13.37  0.85   8191.98
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.32  196750 0.01577   2.80  0.27   5636.96
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.43   42248 0.02175   0.60  0.03  56387.26
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.70  168686 0.01628  11.97  0.44  69746.77
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    341.27    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    131.57    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -188.41    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    930.52    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    341.27    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    131.57    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -188.41    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    930.52    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.92 100.7  112.26  96.43  93.47  86.11  92.23]

Matriz [Qi]
[75.   41.66 23.34 -3.34 13.34 35.   25.    7.    8.  ]

Matriz [dq]
[-4.30e-16  2.59e-03 -2.59e-03  2.59e-03 -2.59e-03 -5.55e-17 -9.02e-17 -5.20e-18 -1.39e-17]


-----Fin iteración:   2  Desbalance de caudales: 2.588970


-----Iteración número:   3 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353369 0.01414  13.52  0.86   8183.26
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.31  194533 0.01580   2.75  0.26   5648.18
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38922 0.02215   0.52  0.02  57395.94
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.67  165360 0.01635  11.55  0.42  70006.77
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.06    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.35    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -176.68    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    915.57    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.06    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.35    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -176.68    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    915.57    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.4   86.03  92.15]

Matriz [Qi]
[75.   41.92 23.08 -3.08 13.08 35.   25.    7.    8.  ]

Matriz [dq]
[ 1.94e-16  2.63e-04 -2.63e-04  2.63e-04 -2.63e-04 -2.22e-16 -6.59e-17 -7.89e-17 -1.73e-18]


-----Fin iteración:   3  Desbalance de caudales: 0.263048


-----Iteración número:   4 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353567 0.01414  13.53  0.86   8182.48
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.30  194335 0.01581   2.74  0.26   5649.19
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38625 0.02219   0.51  0.02  57491.60
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.66  165063 0.01635  11.51  0.42  70030.32
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.22    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.24    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.63    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.23    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.22    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.24    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.63    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.23    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.39  86.03  92.15]

Matriz [Qi]
[75.   41.95 23.05 -3.05 13.05 35.   25.    7.    8.  ]

Matriz [dq]
[ 3.47e-16  2.35e-05 -2.35e-05  2.35e-05 -2.35e-05  2.50e-16  2.36e-16  1.12e-16  1.56e-17]


-----Fin iteración:   4  Desbalance de caudales: 0.023493


-----Iteración número:   5 -----

Variables hidráulicas de los tramos

  N  De->A    L    D    ks    kL    Es    A      v       Re     f       hf    hL      alfa
-------------------------------------------------------------------------------------------
  0   0  1   200  200 0.0015  3.0  TA  0.0314   2.39  474146 0.01339   3.89  0.87    846.46
  1   1  2   500  150 0.0015  3.0  TA  0.0177   2.37  353584 0.01414  13.54  0.86   8182.42
  2   1  4   300  150 0.0015  3.0  TA  0.0177   1.30  194317 0.01581   2.74  0.26   5649.28
  3   2  3   300  100 0.0015  3.0  TA  0.0079  -0.39   38598 0.02220   0.51  0.02  57500.09
  4   4  3   500  100 0.0015  3.0  TA  0.0079   1.66  165037 0.01635  11.51  0.42  70032.40
  5   2  5   200  150 0.0015  3.0  TA  0.0177   1.98  295024 0.01461   3.90  0.60   3669.71
  6   5  6   250  150 0.0015  3.0  TA  0.0177   1.41  210731 0.01556   2.65  0.31   4723.12
  7   6  8   150  100 0.0015  3.0  TA  0.0079   0.89   88507 0.01853   1.13  0.12  25447.41
  8   6  7   150   75 0.0015 10.0  TA  0.0044   1.81  134868 0.01704   5.70  1.67 115132.63
-------------------------------------------------------------------------------------------
Matriz [A]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.23    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.23    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.53    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.11    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [A1]
[[  63.48    0.      0.      0.      0.      0.      0.      0.      0.  ]
 [   0.    343.23    0.      0.      0.      0.      0.      0.      0.  ]
 [   0.      0.    130.23    0.      0.      0.      0.      0.      0.  ]
 [   0.      0.      0.   -175.53    0.      0.      0.      0.      0.  ]
 [   0.      0.      0.      0.    914.11    0.      0.      0.      0.  ]
 [   0.      0.      0.      0.      0.    128.44    0.      0.      0.  ]
 [   0.      0.      0.      0.      0.      0.    118.08    0.      0.  ]
 [   0.      0.      0.      0.      0.      0.      0.    178.13    0.  ]
 [   0.      0.      0.      0.      0.      0.      0.      0.    921.06]]

Matriz [qfi]
[-75.]

Matriz [Hi]
[115.24 100.84 100.31 112.24  96.35  93.39  86.03  92.15]

Matriz [Qi]
[75.   41.95 23.05 -3.05 13.05 35.   25.    7.    8.  ]

Matriz [dq]
[-2.08e-16  2.07e-06 -2.07e-06  2.07e-06 -2.07e-06 -1.39e-16 -4.16e-17 -2.95e-17 -1.39e-17]


-----Fin iteración:   5  Desbalance de caudales: 0.002074

----- FIN DEL CÁLCULO -----


MÉTODO DEL GRADIENTE HIDRÁULICO              v1.0.0-alpha

Archivo de entrada: ./input/Red-mixta.mgh.json
Titulo:      Red de pruebas mixta (cerrada y abierta)
Autor:       Carlos Camacho Soto
Fecha:       6 set 2022
Versión:     1.0.0
Viscosidad:  1.007e-06
Desbalance:  1e-05
Máximo iteraciones permitidas:  40
Ecuación de pérdidas de fricción: Colebrook-White
Factor global de demanda:  1.0

DATOS DE ENTRADA

Nudos de carga fija
  N  Elevación    Carga    Nivel
---------------------------------
  0   110.00     120.00    10.00 
---------------------------------

Nudos de demanda
  N  Elevación   Demanda    FVH
---------------------------------
  1    90.00      10.00     1.00 
  2    85.00      10.00     1.00 
  3    85.00      10.00     1.00 
  4    85.00      10.00     1.00 
  5    80.00      10.00     1.00 
  6    75.00      10.00     1.00 
  7    75.00       8.00     1.00 
  8    70.00       7.00     1.00 
---------------------------------

Tramos
  T   de->a      L     D     A       ks     kL   Estado   Op 
---------------------------------------------------------------
  0    0  1     200   200  0.0314  0.0015   3.0    TA   - 
  1    1  2     500   150  0.0177  0.0015   3.0    TA   - 
  2    1  4     300   150  0.0177  0.0015   3.0    TA   - 
  3    2  3     300   100  0.0079  0.0015   3.0    TA   - 
  4    4  3     500   100  0.0079  0.0015   3.0    TA   - 
  5    2  5     200   150  0.0177  0.0015   3.0    TA   - 
  6    5  6     250   150  0.0177  0.0015   3.0    TA   - 
  7    6  8     150   100  0.0079  0.0015   3.0    TA   - 
  8    6  7     150    75  0.0044  0.0015  10.0    TA   - 
---------------------------------------------------------------

RESULTADOS

Nudos de carga fija
  N  Elevación    Carga    Nivel   Caudal
------------------------------------------
  0   110.00     120.00    10.00   -75.00
------------------------------------------

Nudos de demanda
  N  Elevación   Q Base    FVH    Q Neto      Carga   Presión
-------------------------------------------------------------
  1    90.00      10.00    1.00    10.00     115.24    25.24
  2    85.00      10.00    1.00    10.00     100.84    15.84
  3    85.00      10.00    1.00    10.00     100.31    15.31
  4    85.00      10.00    1.00    10.00     112.24    27.24
  5    80.00      10.00    1.00    10.00      96.35    16.35
  6    75.00      10.00    1.00    10.00      93.39    18.39
  7    75.00       8.00    1.00     8.00      86.03    11.03
  8    70.00       7.00    1.00     7.00      92.15    22.15
-------------------------------------------------------------

Tramos
  T   de->a      V       Q       hf      hL      hT       S   
---------------------------------------------------------------
  0    0  1     2.39   75.00    3.89    0.87    4.76   0.02381 
  1    1  2     2.37   41.95   13.54    0.86   14.40   0.02880 
  2    1  4     1.30   23.05    2.74    0.26    3.00   0.01001 
  3    2  3    -0.39   -3.05    0.51    0.02    0.54   0.00179 
  4    4  3     1.66   13.05   11.51    0.42   11.93   0.02386 
  5    2  5     1.98   35.00    3.90    0.60    4.50   0.02248 
  6    5  6     1.41   25.00    2.65    0.31    2.95   0.01181 
  7    6  8     0.89    7.00    1.13    0.12    1.25   0.00831 
  8    6  7     1.81    8.00    5.70    1.67    7.37   0.04912 
---------------------------------------------------------------

Fecha y hora de esta corrida:  Mon Sep 12 10:16:02 2022
crcs-2022
...
 
